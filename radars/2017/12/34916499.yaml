apiVersion: openapi/v1alpha1
kind: Radar
metadata:
    name: "34916499"
    labels:
        datastore_id: "4937213536108544"
data:
    classification: ""
    created: "2017-12-21T23:02:17.13497Z"
    description: "When importing a JWK OEAP private key using crypto.subtle.importKey the import will fail if p < q\r\n\r\nSteps to Reproduce:\r\n\r\nIn JavaScript Console\r\n\r\nlet key = {\r\n    \"alg\": \"RSA-OAEP\",\r\n    \"d\": \"AEhCO0ZRRbsKTbTOzgW8_q2pET2vLQOyaLBwhWw6fK6Zz4GkKhNzcd15HpjQ5_HsqancBl6NT0h0RZ-NATzo4nTW-UL7HS3KfX4MBeun8s09LUQGFiteBbodONlnImL298JOeQnJiCtTyOPp7BokFvH5Tx0p5iSaMHQ9t6mo3CQ5EqM5tCOOAAIhIKfaTYACIA3z1ofKr45tHaqtdFNtGmEzlXjFGc_7AwK_TfaXJfcqyLaLqp7llc0c7Pktj-eSV4FI_Oysb0LXDK-L5ehJPafz6p9pLXCaQTOULMfwbvv3xKlY6Q2a9-AoBDWPPTgNzMS7DojCDguLA98-4ehjQQ\",\r\n    \"dp\": \"YRLeNGJByvFv4Jpv2Ef-mmknlNmZdg2MCk7xsQh3-nufKxEssdN_jTF1lTR5mnYKJyaGfsuADRy-xzIuili91xx2631VXIpzO4EApt-_droErdjzwJiOVqbMQmEU9ithLWWbpa0IPm5HZCa7PD-2ctt79aMFualsmwQ2Auc2ET0\",\r\n    \"dq\": \"KbWh0933yZ1ndCe5KW_QF0RlF57QsLL3Lc6bfOB2uY9AitUv5s4Q0BrHwdlS-0v1S0s3T_XJKjN5XRd-TEGOX0xZMRGuA99QyGm_arw4Rkrm27u3zBBUaN5Hm1rHMYugrbb4Ch1BQioCdlR1yfJwVR5w8cpp6J68jWl1ST0Oj7k\",\r\n    \"e\": \"AQAB\",\r\n    \"ext\": true,\r\n    \"key_ops\": [\r\n        \"decrypt\"\r\n    ],\r\n    \"kty\": \"RSA\",\r\n    \"n\": \"zYn-rDpx6iI7AylGoNVh5WtdlgyQNa63JIv562B0Xh3Ye5ip3MW_ehPeEOIkTFFfigTNc2stCrTHVNRGgpny0bRsYJT6w_8PBzeCwIJ4xMy9Kzy8SGbyC8QfL0nopUJuJcIU5EuTyY4XX9p9M2FBqtjmplKGj6XsP81JrpVl1ZN5CNFW1mmpEIjdc7egzlH0CaJGum-Opr8rSw_-SQQNEDWsftAPwZktrJlk_mL068o6wuPuSgrzhhesbxBC532SsWtVkIgbJy-UlcsTI6KCSxZHQiAJ0q37bf1535IF8okrVd6iJqUjZ2XltbZpxDkAtoTKBEpH3tBiMUhiUzkOTQ\",\r\n    \"p\": \"1blRZM5aXP7CkdOTWidcnkZQiBk8Rnpl12p2AsDgCqBWeLtGOoi8lux5zPwK07cB5Mcf0r7_uLHQt0tPHfuDKMacktLUsoCsVDbnkOPJL9aK0nWLCMzy9sgmZq4LMOChNRzPkQegq-vJxXON_Ol_3O2YGlePnpIIT79V_CzDbuU\",\r\n    \"q\": \"9jI1BOgJNo6P3U21dgEYiMjJhF38n1xiyxRjl_dp5otzN4mkpg32sGAZAhO1rdjc9Zz2OlvuMyef6YQrtcDuVcm8Sq2YyYwhqB6dlN6dKswr9gGyBEqfcUtKoGRm7uNA1_z_N83n9h1ji06958uq3S3QvSS4_FlNlvQMsoOOw0k\",\r\n    \"qi\": \"x9wUQzvMTSkzPKgvMnGxhltqX6Q3ruv2O5M98Vg-f_-c4O3p-bFSO94768OV7859QD_LY7J0eqjaUtvXXMcHpOH0J8xa7vgVU37vEjqEwI_zloDkyRihumwFKH6SCRTZTnIlJNgNFR_m1fFhatHdQj6VFf0HYREnTqlWd25yYRE\",\r\n    \"kid\": \"h7bbt47gymfxtb3amihkvgu6zi\"\r\n};\r\nlet alg = {\r\n\tname: \"RSA-OAEP\",\r\n\tmodulusLength: 2048,\r\n\tpublicExponent: new Uint8Array([0x01, 0x00, 0x01]), // 24-bit representation of 65537\r\n\thash: {name: \"SHA-1\"}\r\n};\r\ncrypto.subtle.importKey(\"jwk\", key, alg, true, [\"decrypt\"]);\r\n\r\nExpected Results:\r\n\r\nA successful cryptoky\r\n\r\nActual Results:\r\n\r\nError stating\r\n\r\n\"Unhandled Promise Rejection: DataError (DOM Exception 30): Data provided to an operation does not meet requirements\""
    email: jeff@agilebits.com
    modified: "2017-12-21T23:02:17.13527Z"
    number: "34916499"
    number_intvalue: 34916499
    originated: "2017-10-10"
    parent_number: '&{NULL_VALUE}'
    product: Safari
    product_version: 11.0 (13604.1.38.1.6)
    reproducible: Yes
    resolved: ""
    status: ""
    title: JWK OEAP importKey fails if p < q
