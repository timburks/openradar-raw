apiVersion: openapi/v1alpha1
kind: Radar
metadata:
    name: "33842609"
    labels:
        datastore_id: "4930290082381824"
data:
    classification: Error
    created: "2017-08-11T04:18:15.37846Z"
    description: "Summary:\r\nI am using XCode 9 beta 5 to setup a XCTest. For my app, the app pops up a system alert for Notifications when the app is opened first time after installation.\r\nBefore Xcode 9, if i tried to tap button on the screen present, XCTest would tap 'Don't Allow' button by default and proceed.\r\n\r\nNow, I am trying to tap 'Allow' using this code:\r\n\r\nXCUIApplication().alerts[\"“AppName” Would Like to Send You Notifications\"].buttons[\"Allow\"].tap()\r\n\r\nThe above line was generated by UI Recorder and does not work in the test. It fails with this error:\r\n \r\nAssertion Failure: xyz.swift:38: No matches found for Find: Descendants matching type Alert from input {(\r\n    Application, 0x174186f50, pid: 3772, label: 'AppName'\r\n)}\r\n\r\nI have referred this StackOverflow answer until now, and the UIInterruption Monitor did not work in Xcode 9, or I could not get it working fully.\r\nhttps://stackoverflow.com/a/32228033/2181419\r\n\r\nRead this:\r\nhttps://developer.apple.com/documentation/xctest/xctestcase/1496273-adduiinterruptionmonitor#parameters\r\n\r\nbut could not write a functioning handler in Swift.\r\n\r\nWhat I tried until now:\r\n        addUIInterruptionMonitor(withDescription: \"Notifications Dialog\") { (alert) -> Bool in\r\n                alert.buttons[\"Allow\"].tap()\r\n                return true\r\n        }\r\n\r\n            app.buttons[\"Allow\"].tap()\r\n            app.tap()\r\n\r\nAny help is appreciated, even if I can dismiss the notifications alert by tapping \"Don't Allow\" instead of \"Allow\"\r\n\r\nSteps to Reproduce:\r\n1. Install an app that requires Push Notification permissions\r\n2. Write an XCTest which tries to tap \"Allow\" on the Notifications system alert view\r\n3. Record tapping \"Allow\" using UIRecorder\r\n4. Run the above test in Xcode\r\n\r\nExpected Results:\r\nSystem Alert for Notifications is dismissed by tapping 'Allow' and rest of the test continues.\r\n\r\nObserved Results:\r\nTest fails with error similar to:\r\nNo matches found for Find: Descendants matching type Alert from input {(\r\n    Application, 0x174186f50, pid: 3772, label: 'AppName'\r\n)}\r\n\r\nVersion:\r\nXCode Version 9.0 beta 5 (9M202q)\r\nmacOS 10.12.6 (16G29)"
    email: nagarkarchetan@gmail.com
    modified: "2017-08-11T04:18:15.37872Z"
    number: "33842609"
    number_intvalue: 33842609
    originated: 08/10/2017
    parent_number: '&{NULL_VALUE}'
    product: Xcode
    product_version: 9.0 beta 5
    reproducible: Always
    resolved: No
    status: Open
    title: 'XCTest / Xcode 9 beta 5: Unable to tap "Allow" on System Alert'
