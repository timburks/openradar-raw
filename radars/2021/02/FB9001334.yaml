apiVersion: openapi/v1alpha1
kind: Radar
metadata:
    name: FB9001334
    labels:
        datastore_id: "5047380122533888"
data:
    classification: Incorrect/Unexpected Behavior
    created: "2021-02-25T23:46:38.251664Z"
    description: "Radar as formatted text and with pictures at:\r\nhttps://forums.macrumors.com/threads/rendering-glitches-only-in-specific-apps-photos-and-safari-on-mbp-15-mid-2014-when-dgpu-active-in-macos-11-big-sur.2284320/\r\n\r\nBelow, at least the plaintext representation, as good as possible.\r\n\r\n\r\n\r\nTL;DR:​\r\n\r\nIn the recent weeks I experience graphical glitches in specific apps only (Photos + Safari)\r\non my MacBook Pro (Mid 2014) and only when running on its dGPU which is a NVIDIA GeForce GT 750M.\r\n\r\nFor a number of reasons (see inline) I do not think that this is thermal, aging issue,\r\nbut rather a software issue having to do with recent updates:\r\nNVIDIA driver, MetalAPI, possibly recent Firmware/BootROM upgrade.\r\nGlitch I in Photos.app and Glitch II in Safari are both 100% reproducible!\r\n\r\n\r\nWITHIN THIS BUG REPORT:​\r\n- Roman numerals refer to the separate observed glitches.\r\n- Arabic numerals refer to the provided screenshots / screen recordings.\r\n\r\n\r\nGLITCH I in Photos.app​\r\n\r\nAlways correct behavior on iGPU (100% reproducible)​\r\n\r\n- Disconnect power adapter to run on battery\r\n- Launch Photos.app, it runs on the iGPU\r\n- Switch from \"Months\" to \"Days\" view and later back again\r\n- Perfect animation, always\r\n\r\nAlways faulty behavior on dGPU (100% reproducible)​\r\n\r\n- Connect power adapter\r\n\r\n- Launch Photos.app, it enforces dGPU\r\n- 1a) Switch from \"Months\" to \"Days\" view and back again\r\n-- During the transition within the content canvas of the single-window-app:\r\n--- The upper ca. 30% and lower ca. 30% off the canvas show the faulty behavior:\r\n--- Random white/grey lines, triangles or rects overlaying some of the photos.\r\n-- Sometimes this does not happen at the first transition, but just scroll up or down a bit, and then transist, and latest at the 3rd-5th repetition you get the glitch.\r\n--- And if you then transist back and forth, without scrolling inbetween, you always reproduce the glitch\r\n\r\n- 1b) If you are already in the bug and then scroll within the \"Months\" view, then the gap surfaces between the photos flashes in full white or with white zig-zag lines.\r\n\r\n\r\nGLITCH II in Safari​\r\n\r\nNot reproducible. But when occurring certain environment commonalities are observable:\r\n- Experienced this twice within 8 days while using my computer ca. 6 days a week for 6-10 hours a day.\r\n- Both times happened on GitHub.com, though on different project pages.\r\n-- Not on other domains, and I sure visit 100 different domains/websites per day.\r\n- Always occurred while on dGPU:\r\n-- On 2020-02-03 I ran on an external display which enforced the dGPU.\r\n-- On 2020-02-11 I ran on the internal display, had Photos.app running in the background (I explicitly mean the GUI, not the daemons like photoanalysisd), which enforced dGPU.\r\n\r\n2) Visible glitches​\r\n- Black squares and triangles (assumingely polygons of accelerated graphics)\r\n- Font rendering shows broken glyphs\r\n\r\n3) Workaround:​\r\n- 3a) When Safari suffers the glitch\r\n- 3b) Switch from dGPU to iGPU\r\n-- I did this while running on power adapter effectively by quitting the only dGPU dependent app Photos.app\r\n- 3c) Thermals were unsuspicious while that time. Fans very relaxed.\r\n- 4) Also other people on the Internet report the same symptoms​\r\nAll of late 2020 or early 2021, so very likely all related to recent Safari and macOS Catalina / Big Sur. And in many cases mentioning NVIDIA GPUs.\r\n\r\n4a) Weird black triangular graphics disruption\r\nhttps://forums.macrumors.com/threads/weird-black-triangular-graphics-disruption-ad-related.2222160/?post=28191230#post-28191230\r\n\r\n4b) Safari graphics glitch with MacRumors\r\nhttps://forums.macrumors.com/threads/safari-graphics-glitch-with-macrumors.2257989/?post=28975745#post-28975745\r\n\r\n4c) Safari graphics glitch with MacRumors nr2\r\nhttps://forums.macrumors.com/threads/safari-graphics-glitch-with-macrumors.2257989/?post=29441279#post-29441279\r\n​\r\n\r\nGLITCH III in Safari​\r\n\r\nAlways reproducible!\r\n- 5a) I now have a stable reproduction:\r\n-- With your external display connected, hence the dGPU on, open Safari\r\n-- Open wxcharts.com (a weather website)\r\n-- The satellite/weather image sequence shows a rendering glitch: Green rectangles (ca 90x50px) along a diagonal axis are shown above that satellite/weather image sequence. Regardless where the playback/slider is.\r\n-- 4d) exactly as user @Benblob688 reported on https://discussions.apple.com/thread/252176898\r\n-- 5b) For comparison, while still on dGPU the same website renders flawlessly on Brave Browser (Chromium web engine)\r\n-- In Safari: As soon as you switch to iGPU by disconnecting the external display, the window re-renders instantly, and all is fine!\r\n\r\nISOLATION BY TIMELINE:​\r\n\r\n- These were the things which I recently changed:\r\n-- 2021-01-18 Upgraded macOS 10.15.7 with 2020-001 Supplemental (had postponed this for long)\r\n--- macOS: 10.15.7 19H15 -> 19H114\r\n--- Boot-ROM: 162.0.0.0.0 -> 429.0.0.0.0\r\n-- 2021-01-21 Upgraded macOS 10.15.7 Catalina to 10.11.1 Big Sur\r\n\r\nGlitch II in Safari definitely only experienced first on 2020-02-03. Never before.\r\n\r\nGlitch I in Photos I only deliberately noticed on 2021-01-29 in Big Sur and thereafter.\r\n- But I may have already noticed it in Catalina somewhen 2020 and ignored it, rarely used it then.\r\n- Luckily I still had bootable backups of Catalina and Mojave and booted them on the same machine with the meanwhile newer BootROM 429.0.0.0 and ran:\r\n-- Photos in Catalina: Exactly the same glitch happens!\r\n-- Photos in Mojave: Different navigation paradigm \"Photos | Moments | Collections | Years\". But I scrolled around wildly and zoomed in and out wildly, and no glitches at all!\r\n\r\nISOLATION BY SCOPE:​\r\n\r\n- My thermals are overally very ok. The fans are mostly silent, also when the incidents happened.\r\n- I never have rendering artefacts on the screen in general or in other apps.\r\n-- Only in the forementioned specific apps Photos and Safari.\r\n- Other 3D apps work without glitches:\r\n-- Apple Maps in 3D mode in cities which have the 3D buildings\r\n-- Brave Browser running Google Maps in 3D mode\r\n-- Google Earth Pro (seems to use Qt/OpenGL)\r\n- I don't think (or hope) that it's first signs of dGPU death as it was on my MacBook Pro (Late 2006) with the widely spread contact-pin issues of this series back then. The difference there was that heat indeed noticable and the glitches were general and not app-specific.\r\n- So I assume it's indeed a software issue (NVIDIA drivers, Metal API, maybe recent BootROM upgrade v162 -> v429) and hope that it will be solved."
    email: p.org@gmx.at
    modified: "2021-02-25T23:46:38.251816Z"
    number: FB9001334
    number_intvalue: 9001334
    originated: "2021-02-11"
    parent_number: '&{NULL_VALUE}'
    product: Graphics
    product_version: macOS 11.2.1
    reproducible: Yes
    resolved: ""
    status: Open
    title: Rendering glitches when dGPU NVIDIA GeForce GT 750M active in specific apps Photos and Safari
