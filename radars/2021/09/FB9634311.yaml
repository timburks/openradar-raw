apiVersion: openapi/v1alpha1
kind: Radar
metadata:
    name: FB9634311
    labels:
        datastore_id: "4980733101735936"
data:
    classification: Swift Compiler
    created: "2021-09-17T17:27:06.6998Z"
    description: "Please describe the issue:\r\nSwiftUI previews of WatchKit Extension never show up, attempts to refresh the preview fail with “Command CompileSwiftSources failed with a nonzero exit code” even though the product builds and runs on Apple Watch without any error.\r\n\r\nThis is a regression for latest Xcode 12.5.1 where a same preview works OK.\r\n\r\nPlease list the steps you took to reproduce the issue:\r\n1. Create a SwiftUI component for WatchKit Extension with a Preview\r\n2. Try to view the preview\r\n\r\nWhat did you expect to happen?\r\nPreview shows up\r\n\r\nWhat actually happened?\r\nError “Command CompileSwiftSources failed with a nonzero exit code”, preview never shows up\r\n\r\nThe command from “Build target WatchKit Extension - Log”:\r\n\r\nCompileSwiftSources normal arm64 com.apple.xcode.tools.swift.compiler (in target 'WeathergraphWatchKitExtension' from project 'Weathergraph Independent')\r\n    cd /Users/kafkat/Dev/weathergraph/weathergraph-ios\r\n    export DEVELOPER_DIR\\=/Applications/Xcode.app/Contents/Developer\r\n    export SDKROOT\\=/Applications/Xcode.app/Contents/Developer/Platforms/WatchSimulator.platform/Developer/SDKs/WatchSimulator8.0.sdk\r\n    /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/swiftc -incremental -module-name WeathergraphWatchKitExtension -Onone -enable-batch-mode -enforce-exclusivity\\=checked @/Users/kafkat/Library/Developer/Xcode/DerivedData/Weathergraph_Independent-apgbjjwodocdpiaehfrqnhmyfmsi/Build/Intermediates.noindex/Previews/Weathergraph\\ WatchKit\\ App\\ -\\ Debug/Intermediates.noindex/Weathergraph\\ Independent.build/Debug-watchsimulator/WeathergraphWatchKitExtension.build/Objects-normal/arm64/WeathergraphWatchKitExtension.SwiftFileList -DDEBUG -sdk /Applications/Xcode.app/Contents/Developer/Platforms/WatchSimulator.platform/Developer/SDKs/WatchSimulator8.0.sdk -target arm64-apple-watchos7.0-simulator -g -module-cache-path /Users/kafkat/Library/Developer/Xcode/DerivedData/ModuleCache.noindex -Xfrontend -serialize-debugging-options -application-extension -enable-testing -index-store-path /Users/kafkat/Library/Developer/Xcode/DerivedData/Weathergraph_Independent-apgbjjwodocdpiaehfrqnhmyfmsi/Index/DataStore -swift-version 5 -I /Users/kafkat/Library/Developer/Xcode/DerivedData/Weathergraph_Independent-apgbjjwodocdpiaehfrqnhmyfmsi/Build/Intermediates.noindex/Previews/Weathergraph\\ WatchKit\\ App\\ -\\ Debug/Products/Debug-watchsimulator -F /Users/kafkat/Library/Developer/Xcode/DerivedData/Weathergraph_Independent-apgbjjwodocdpiaehfrqnhmyfmsi/Build/Intermediates.noindex/Previews/Weathergraph\\ WatchKit\\ App\\ -\\ Debug/Products/Debug-watchsimulator/PackageFrameworks -F /Users/kafkat/Library/Developer/Xcode/DerivedData/Weathergraph_Independent-apgbjjwodocdpiaehfrqnhmyfmsi/Build/Intermediates.noindex/Previews/Weathergraph\\ WatchKit\\ App\\ -\\ Debug/Products/Debug-watchsimulator/PackageFrameworks -F /Users/kafkat/Library/Developer/Xcode/DerivedData/Weathergraph_Independent-apgbjjwodocdpiaehfrqnhmyfmsi/Build/Intermediates.noindex/Previews/Weathergraph\\ WatchKit\\ App\\ -\\ Debug/Products/Debug-watchsimulator/PackageFrameworks -F /Users/kafkat/Library/Developer/Xcode/DerivedData/Weathergraph_Independent-apgbjjwodocdpiaehfrqnhmyfmsi/Build/Intermediates.noindex/Previews/Weathergraph\\ WatchKit\\ App\\ -\\ Debug/Products/Debug-watchsimulator -c -j8 -output-file-map /Users/kafkat/Library/Developer/Xcode/DerivedData/Weathergraph_Independent-apgbjjwodocdpiaehfrqnhmyfmsi/Build/Intermediates.noindex/Previews/Weathergraph\\ WatchKit\\ App\\ -\\ Debug/Intermediates.noindex/Weathergraph\\ Independent.build/Debug-watchsimulator/WeathergraphWatchKitExtension.build/Objects-normal/arm64/WeathergraphWatchKitExtension-OutputFileMap.json -parseable-output -serialize-diagnostics -emit-dependencies -emit-module -emit-module-path /Users/kafkat/Library/Developer/Xcode/DerivedData/Weathergraph_Independent-apgbjjwodocdpiaehfrqnhmyfmsi/Build/Intermediates.noindex/Previews/Weathergraph\\ WatchKit\\ App\\ -\\ Debug/Intermediates.noindex/Weathergraph\\ Independent.build/Debug-watchsimulator/WeathergraphWatchKitExtension.build/Objects-normal/arm64/WeathergraphWatchKitExtension.swiftmodule -Xcc -I/Users/kafkat/Library/Developer/Xcode/DerivedData/Weathergraph_Independent-apgbjjwodocdpiaehfrqnhmyfmsi/Build/Intermediates.noindex/Previews/Weathergraph\\ WatchKit\\ App\\ -\\ Debug/Intermediates.noindex/Weathergraph\\ Independent.build/Debug-watchsimulator/WeathergraphWatchKitExtension.build/swift-overrides.hmap -Xcc -iquote -Xcc /Users/kafkat/Library/Developer/Xcode/DerivedData/Weathergraph_Independent-apgbjjwodocdpiaehfrqnhmyfmsi/Build/Intermediates.noindex/Previews/Weathergraph\\ WatchKit\\ App\\ -\\ Debug/Intermediates.noindex/Weathergraph\\ Independent.build/Debug-watchsimulator/WeathergraphWatchKitExtension.build/WeathergraphWatchKitExtension-generated-files.hmap -Xcc -I/Users/kafkat/Library/Developer/Xcode/DerivedData/Weathergraph_Independent-apgbjjwodocdpiaehfrqnhmyfmsi/Build/Intermediates.noindex/Previews/Weathergraph\\ WatchKit\\ App\\ -\\ Debug/Intermediates.noindex/Weathergraph\\ Independent.build/Debug-watchsimulator/WeathergraphWatchKitExtension.build/WeathergraphWatchKitExtension-own-target-headers.hmap -Xcc -I/Users/kafkat/Library/Developer/Xcode/DerivedData/Weathergraph_Independent-apgbjjwodocdpiaehfrqnhmyfmsi/Build/Intermediates.noindex/Previews/Weathergraph\\ WatchKit\\ App\\ -\\ Debug/Intermediates.noindex/Weathergraph\\ Independent.build/Debug-watchsimulator/WeathergraphWatchKitExtension.build/WeathergraphWatchKitExtension-all-non-framework-target-headers.hmap -Xcc -ivfsoverlay -Xcc /Users/kafkat/Library/Developer/Xcode/DerivedData/Weathergraph_Independent-apgbjjwodocdpiaehfrqnhmyfmsi/Build/Intermediates.noindex/Previews/Weathergraph\\ WatchKit\\ App\\ -\\ Debug/Intermediates.noindex/Weathergraph\\ Independent.build/Debug-watchsimulator/WeathergraphWatchKitExtension.build/all-product-headers.yaml -Xcc -iquote -Xcc /Users/kafkat/Library/Developer/Xcode/DerivedData/Weathergraph_Independent-apgbjjwodocdpiaehfrqnhmyfmsi/Build/Intermediates.noindex/Previews/Weathergraph\\ WatchKit\\ App\\ -\\ Debug/Intermediates.noindex/Weathergraph\\ Independent.build/Debug-watchsimulator/WeathergraphWatchKitExtension.build/WeathergraphWatchKitExtension-project-headers.hmap -Xcc -I/Users/kafkat/Library/Developer/Xcode/DerivedData/Weathergraph_Independent-apgbjjwodocdpiaehfrqnhmyfmsi/SourcePackages/checkouts/promises/Sources/FBLPromises/include -Xcc -I/Users/kafkat/Library/Developer/Xcode/DerivedData/Weathergraph_Independent-apgbjjwodocdpiaehfrqnhmyfmsi/Build/Intermediates.noindex/Previews/Weathergraph\\ WatchKit\\ App\\ -\\ Debug/Products/Debug-watchsimulator/include -Xcc -I/Users/kafkat/Library/Developer/Xcode/DerivedData/Weathergraph_Independent-apgbjjwodocdpiaehfrqnhmyfmsi/Build/Intermediates.noindex/Previews/Weathergraph\\ WatchKit\\ App\\ -\\ Debug/Intermediates.noindex/Weathergraph\\ Independent.build/Debug-watchsimulator/WeathergraphWatchKitExtension.build/DerivedSources-normal/arm64 -Xcc -I/Users/kafkat/Library/Developer/Xcode/DerivedData/Weathergraph_Independent-apgbjjwodocdpiaehfrqnhmyfmsi/Build/Intermediates.noindex/Previews/Weathergraph\\ WatchKit\\ App\\ -\\ Debug/Intermediates.noindex/Weathergraph\\ Independent.build/Debug-watchsimulator/WeathergraphWatchKitExtension.build/DerivedSources/arm64 -Xcc -I/Users/kafkat/Library/Developer/Xcode/DerivedData/Weathergraph_Independent-apgbjjwodocdpiaehfrqnhmyfmsi/Build/Intermediates.noindex/Previews/Weathergraph\\ WatchKit\\ App\\ -\\ Debug/Intermediates.noindex/Weathergraph\\ Independent.build/Debug-watchsimulator/WeathergraphWatchKitExtension.build/DerivedSources -Xcc -DDEBUG\\=1 -emit-objc-header -emit-objc-header-path /Users/kafkat/Library/Developer/Xcode/DerivedData/Weathergraph_Independent-apgbjjwodocdpiaehfrqnhmyfmsi/Build/Intermediates.noindex/Previews/Weathergraph\\ WatchKit\\ App\\ -\\ Debug/Intermediates.noindex/Weathergraph\\ Independent.build/Debug-watchsimulator/WeathergraphWatchKitExtension.build/Objects-normal/arm64/WeathergraphWatchKitExtension-Swift.h -import-objc-header /Users/kafkat/Dev/weathergraph/weathergraph-ios/Shared/Weathergraph-Bridging-Header.h -pch-output-dir /Users/kafkat/Library/Developer/Xcode/DerivedData/Weathergraph_Independent-apgbjjwodocdpiaehfrqnhmyfmsi/Build/Intermediates.noindex/PrecompiledHeaders -working-directory /Users/kafkat/Dev/weathergraph/weathergraph-ios -Xfrontend -enable-implicit-dynamic -Xfrontend -enable-private-imports -Xfrontend -enable-dynamic-replacement-chaining -Xfrontend -disable-previous-implementation-calls-in-dynamic-replacements"
    email: tk@tomaskafka.com
    modified: "2021-09-17T17:27:06.699954Z"
    number: FB9634311
    number_intvalue: 9634311
    originated: 17.9.2011
    parent_number: '&{NULL_VALUE}'
    product: Xcode
    product_version: "13.0"
    reproducible: Yes
    resolved: ""
    status: ""
    title: SwiftUI previews for WatchKit Extension always fail on "Command CompileSwiftSources failed with a nonzero exit code" even when the project builds OK
