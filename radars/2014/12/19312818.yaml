apiVersion: openapi/v1alpha1
kind: Radar
metadata:
    name: "19312818"
    labels:
        datastore_id: "5900240917889024"
data:
    classification: ""
    created: "2014-12-19T22:12:32.465357Z"
    description: "Attachments: https://jeffvautin.com/wp-content/uploads/openradar/radar19312818OSXChoosesSBCOverAAC.zip\r\n\r\nSummary:\r\nI was observing bluetooth connections from an iPhone and a MacBook Pro to a 2015 Corvette (Premium Audio). The Corvette advertises both SBC and AAC capabilities:\r\n\r\n[Dec 17 16:06:29.175]  [AVDTP RECEIVE]  Get Cap.: Accept-Response (0x02)\r\n               Get Cap.: Accept-Response (0x02)\r\n               Msg Type: Accept-Response (0x02)\r\n               Transaction Label: 0x00\r\n               Packet Type: Single (0x0)\r\n               Size: 12 (0x0C)\r\n               Media Transport\r\n               SBC Encoding:\r\n               \tSample Frequency: 44.1kHz 48kHz\r\n               \tChannel Mode: Mono Dual Stereo Joint\r\n               \tBlocks: 4 8 12 16\r\n               \tSubbands: 4 8\r\n               \tAllocation: SNR Loudness\r\n               \tMin Bitpool: 2 (0x02)\r\n               \tMax Bitpool: 81 (0x51)\r\n\r\n[Dec 17 16:06:29.440]  [AVDTP RECEIVE]  Get Cap.: Accept-Response (0x02)\r\n               Get Cap.: Accept-Response (0x02)\r\n               Msg Type: Accept-Response (0x02)\r\n               Transaction Label: 0x03\r\n               Packet Type: Single (0x0)\r\n               Size: 14 (0x0E)\r\n               Media Transport\r\n               MPEG24Codec (AAC)\r\n               \tObject Type: MPEG-2 LC MPEG-4 LC\r\n               \tSampling Frequency: 44.1kHz 48kHz\r\n               \tChannels: Mono Stereo\r\n               \tVariable Bit Rate: YES\r\n               \tBit Rate: 128\r\n\r\nThe iPhone chooses to use the AAC codec:\r\n\r\n2014-12-17T16:29:40.896 A2DPClient.cpp:626        MediaConfig          Info       A2DP       MTU for device E0:75:0A:CE:DE:F2 \"Chevrolet MyLink\" has been changed to 660\r\n2014-12-17T16:29:40.896 A2dpStreamConfig.cpp:636  SetAacDataRate       Info       A2DP       AAC frame len: 645 bytes, num frames: 1, bitrate: 256 kb/s, rtp intr: 23219, rtpFrameLen 645, latency 92879\r\n\r\nWhile the MacBook Pro chooses to use the SBC codec:\r\n\r\n[Dec 17 16:06:29.446]  [AVDTP SEND]  Set Config.: Signal (0x03)\r\n               Set Config.: Signal (0x03)\r\n               Msg Type: Signal (0x00)\r\n               Transaction Label: 0x03\r\n               Packet Type: Single (0x0)\r\n               Size: 14 (0x0E)\r\n               Endpoint: 1\r\n               Media Transport\r\n               SBC Encoding:\r\n               \tSample Frequency: 44.1kHz\r\n               \tChannel Mode: Stereo\r\n               \tBlocks: 16\r\n               \tSubbands: 8\r\n               \tAllocation: Loudness\r\n               \tMin Bitpool: 2 (0x02)\r\n               \tMax Bitpool: 64 (0x40)\r\n\r\nSince the AAC codec provides higher fidelity, the MacBook Pro should also be choosing to use the AAC codec to provide audio to the Corvette.\r\n\r\nSteps to Reproduce:\r\n1. Pair a MacBook Pro with a 2015 Corvette (or any other Bluetooth A2DP sink capable of using AAC codec).\r\n2. Observe codec selected by OS X (option-click Bluetooth Menubar icon and Create Diagnostics Report on Desktopâ€¦).\r\n\r\nExpected Results:\r\nOS X should select the AAC codec for the Bluetooth A2DP connection.\r\n\r\nActual Results:\r\nOS X selects the inferior SBC codec.\r\n\r\nVersion:\r\nOS X 10.10.1 (14B25)\r\n\r\nNotes:\r\nI would be happy to provide more information about this over the phone. I've attached both the Mac and iOS Bluetooth Diagnostics logs the above excerpts came from so that you can see the communications in context:\r\nBluetoothReporter_2014-12-17_16.08.18.zip - Mac diagnostic logs\r\nLogs-2014.12.17-16.29.56.zip - iPhone 6 diagnostic logs\r\n\r\nConfiguration:\r\nHardware Overview:\r\n\r\n  Model Name:\tMacBook Pro\r\n  Model Identifier:\tMacBookPro8,2\r\n  Processor Name:\tIntel Core i7\r\n  Processor Speed:\t2.5 GHz\r\n  Number of Processors:\t1\r\n  Total Number of Cores:\t4\r\n  L2 Cache (per Core):\t256 KB\r\n  L3 Cache:\t8 MB\r\n  Memory:\t16 GB\r\n  Boot ROM Version:\tMBP81.0047.B27\r\n  SMC Version (system):\t1.69f3\r\n  Serial Number (system):\tC02H7074DV7P\r\n  Hardware UUID:\t100164E7-D5FA-5D4D-9AC3-9A6415C7E715\r\n  Sudden Motion Sensor:\r\n  State:\tEnabled\r\n\r\nSystem Software Overview:\r\n\r\n  System Version:\tOS X 10.10.1 (14B25)\r\n  Kernel Version:\tDarwin 14.0.0\r\n  Boot Volume:\tMacintosh HD\r\n  Boot Mode:\tNormal\r\n  Computer Name:\tusma-m158-asd\r\n  User Name:\tJeff Vautin (jeffvautin)\r\n  Secure Virtual Memory:\tEnabled\r\n  Time since boot:\t1 day5:21\r\n\r\n\r\nMacBook Pro.spx - configuration file has been successfully uploaded.\r\n\r\nAttachments:\r\n'BluetoothReporter_2014-12-17_16.08.18.zip', 'Logs-2014.12.17-16.29.56.zip' and 'MacBook Pro.spx' were successfully uploaded."
    email: jeff@jeffvautin.com
    modified: "2017-02-15T03:09:07.6285Z"
    number: "19312818"
    number_intvalue: 19312818
    originated: "2014-12-19"
    parent_number: '&{NULL_VALUE}'
    product: OS X
    product_version: OS X 10.10.1 (14B25)
    reproducible: ""
    resolved: ""
    status: Closed as Duplicate of 18202172 (Open)
    title: OS X Chooses SBC audio Codec over AAC for Bluetooth A2DP Connection
