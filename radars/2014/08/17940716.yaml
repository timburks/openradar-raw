apiVersion: openapi/v1alpha1
kind: Radar
metadata:
    name: "17940716"
    labels:
        datastore_id: "5776261116854272"
data:
    classification: Serious Bug
    created: "2014-08-07T02:06:39.970387Z"
    description: "Description:\r\n\r\n\tAttempting a purchase on the iOS App Store fails on an a new device with an Apple ID that has two factor authentication enabled. I.e. 2FA was set up with a prior device, that device was replaced, 2FA fails.\r\n\r\n\tAn opportunity that deserves testing is restoring the original and other devices and attempting transactions. This has not been tested. \r\n\r\n\tFor the reason of not having tested the above of scenario of multiple restores of various devices I have chosen the “I didn’t try” reproducibility. \r\n\r\n\tAs for reproducing this exact set of actual results for transactions, that is always reproducible. No attempts have been made for reproducing this by device restoration as originally.\r\n\r\n\tThis has not been tested for OS X App Store purchases.\r\n\r\n\tThe device receives Apple ID 2FA verification code numbers correctly when initiated from the Apple ID website. (Phone number set up for authentication, same as device)\r\n\r\nSteps to Reproduce:\r\n\r\n\t1. Set up 2 Factor Authentication at https://appleid.apple.com\r\n\t2. Register a device (in my case iPhone 4S) and phone number that that device uses.\r\n\t3. Make purchases on the iOS App Store including in-app purchases.\r\n\t4. Replace that device with an iPhone 5S by iTunes restoration and completely move everything over.\r\n\t4a. Note: this is the same telephone number/account. Different SIM card as standard.\r\n\t5. Reset the old iOS device to factory state.\r\n\t5a. Exclusively use the new device.\r\n\t6. Initiate a transaction (In-app purchase and also upfront app purchase) on the iOS App Store.\r\n\t7. Authenticate w/ Apple ID (password or touch ID)\r\n\t8. Confirm purchase\r\n\r\n\r\nExpected Results:\r\n\r\n\t1. Authentication succeeds.\r\n\t2. The purchase is confirmed\r\n\t3. The transaction is completed.\r\n\r\n\tor \r\n\r\n\t1. Authentication fails.\r\n\t2. The transaction is cancelled or.\r\n\t2a. Retries are offered, yielding expected success and continuing as described above or failure.\r\n\r\nActual Results:\r\n\r\n\t1. Authentication (touch ID or password) succeeds.\r\n\t2. Purchase is confirmed (or denied).\r\n\t3. A wild dialog appears. Title: “Security Information Required” Message: “To help ensure the security of your Apple ID we require additional information.” Options: “Cancel”, “Continue”.\r\n\t4. Choosing continue: Safari opens to https://appleid.apple.com/?localang=en_us\r\n\t4a. This URL has one L shared between local and lang. \r\n\t5. Logging in yields the standard Apple ID website with no options to provide verification or additional information for this transaction. It is exactly the same as in any other session.\r\n\t5a. No additional security information is permitted to be entered.\r\n\t5b. The transaction cannot be successfully completed. \r\n\r\n\tor\r\n\r\n\t1. Authentication fails.\r\n\t2. A retry is offered.\r\n\t3. Authentication succeeds and continues as described above (ending in failure) or the transaction is cancelled/abandoned.\r\n\r\nConfiguration:\r\n\r\n\tDevice initially set up with 2FA: iPhone 4S, iOS 7.1.x at time of replacement. \r\n\r\n\tReplacement device that fails authentication: iPhone 5S, 7.1.2 (11D257), Trust Store 2014060300.\r\n\r\n\r\niTunes Version/Build & Platform (incl. Version/Build):\r\n\r\n\tOS X 10.9.3 at time of upgrade.\r\n\r\n\tiTunes at time of upgrade: unsure exactly, Spring 2014 timeframe, either latest or second latest release.\r\n\r\n\tiTunes presently (not used to restore this device lately): 11.3 (54) 64-bit.\r\n\r\n\r\nAdditional Notes:\r\n\r\n\tThis error presents an obstacle to widespread adoption of two factor authentication.\r\n\r\nAttached: \r\n\r\n\t[Non-cropped versions of the following 2 screenshots along with a screenshot of the IAP confirmation dialog.]\r\n\thttps://twitter.com/jpasqualetti/status/496403101537275904/photo/1\r\n\thttps://twitter.com/jpasqualetti/status/496397962843783171/photo/1"
    email: jpasq03@gmail.com
    modified: "2014-08-07T02:06:39.970593Z"
    number: "17940716"
    number_intvalue: 17940716
    originated: 06-Aug-2014 09:53 PM EST
    parent_number: '&{NULL_VALUE}'
    product: App Store [iOS]
    product_version: 'N/A, Client: iOS 7.1.2'
    reproducible: I Didn’t Try
    resolved: ""
    status: Open
    title: 2-Factor-Auth. fails/prevents purchases after moving to new iOS device.
