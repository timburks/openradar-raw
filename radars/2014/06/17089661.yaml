apiVersion: openapi/v1alpha1
kind: Radar
metadata:
    name: "17089661"
    labels:
        datastore_id: "5792733792829440"
data:
    classification: Serious Bug
    created: "2014-06-01T10:28:34.127778Z"
    description: "Summary:\r\nMapKit is crashing.\r\n\r\nThis happens if the MKMapView is deallocated, before the TileOverlay has had a chance to respond from the URL.\r\n\r\nSteps to Reproduce:\r\n1. Add an MKTileOverlay which was initialized with a URL template to a MKMapView.\r\n2. return the default renderer [[MKTileOverlayRenderer alloc] initWithTileOverlay:overlay] in the mapView's delegate method -[mapView:rendererForOverlay:] \r\n3. Navigate away from this ViewController in a way that will not keep it in memory (go back instead of to a next page)\r\n4. Wait for the network request to finish\r\n5. Inspect why it's crashing....\r\n\r\nExpected Results:\r\nMapKit to stop attempting to download information when it's no longer needed, as well as not returning that information to deallocated instances\r\n\r\nActual Results:\r\niPhone 5:\r\n2014-06-01 05:17:39.934 Rex[2253:60b] *** -[VKRasterOverlayTileSource invalidateRect:level:]: message sent to deallocated instance 0x15823300\r\n(lldb) po [NSThread callStackSymbols]\r\n<_NSCallStackArray 0x1b8152c0>(\r\n0   ???                                 0x01c62654 0x0 + 29763156,\r\n1   MyApp                                 0x0013c2a9 main + 0,\r\n2   CoreFoundation                      0x2ed38098 _CF_forwarding_prep_0 + 24,\r\n3   VectorKit                           0x36ce915f <redacted> + 134,\r\n4   MapKit                              0x2ffff403 <redacted> + 90,\r\n5   MapKit                              0x30007699 <redacted> + 152,\r\n6   MapKit                              0x30004b89 <redacted> + 112,\r\n7   GeoServices                         0x33b0ae27 <redacted> + 54,\r\n8   libdispatch.dylib                   0x39a66d53 <redacted> + 10,\r\n9   libdispatch.dylib                   0x39a66d3f <redacted> + 22,\r\n10  libdispatch.dylib                   0x39a696c3 _dispatch_main_queue_callback_4CF + 278,\r\n11  CoreFoundation                      0x2edb1681 <redacted> + 8,\r\n12  CoreFoundation                      0x2edaff4d <redacted> + 1308,\r\n13  CoreFoundation                      0x2ed1a769 CFRunLoopRunSpecific + 524,\r\n14  CoreFoundation                      0x2ed1a54b CFRunLoopRunInMode + 106,\r\n15  GraphicsServices                    0x33c876d3 GSEventRunModal + 138,\r\n16  UIKit                               0x31679891 UIApplicationMain + 1136,\r\n17  MyApp                                 0x0013c31d main + 116,\r\n18  libdyld.dylib                       0x39a7bab7 <redacted> + 2\r\n)\r\n\r\nVersion:\r\niOS 7.1.1 (11D201)\r\n\r\nNotes:\r\nSimulator:\r\n2014-06-01 04:44:10.209 Rex[14364:60b] *** -[VKRasterOverlayTileSource invalidateRect:level:]: message sent to deallocated instance 0xc7ea930\r\n(lldb) po [NSThread callStackSymbols]\r\n<_NSCallStackArray 0x14fad1a0>(\r\n0   ???                                 0x144f74ed 0x0 + 340751597,\r\n1   MyApp                                 0x00073ea0 main + 0,\r\n2   CoreFoundation                      0x027250ee _CF_forwarding_prep_0 + 14,\r\n3   VectorKit                           0x04aaedbd -[VKRasterOverlay setNeedsDisplayInRect:level:] + 157,\r\n4   MapKit                              0x00999a8f -[MKOverlayRenderer setNeedsDisplayInMapRect:zoomScale:] + 111,\r\n5   MapKit                              0x009a6b15 __50-[MKTileOverlayRenderer canDrawMapRect:zoomScale:]_block_invoke + 182,\r\n6   MapKit                              0x009a3d70 __34-[MKTileOverlay _loadTile:result:]_block_invoke + 57,\r\n7   GeoServices                         0x04e481d6 ___ZNK49-[GEOTileLoaderInternal _loadedTile:forKey:info:]66__49-[GEOTileLoaderInternal _loadedTile:forKey:info:]_block_invoke3$_1clERKN8LoadItem9RequesterE_block_invoke_2 + 85,\r\n8   libdispatch.dylib                   0x02a7c7b8 _dispatch_call_block_and_release + 15,\r\n9   libdispatch.dylib                   0x02a914d0 _dispatch_client_callout + 14,\r\n10  libdispatch.dylib                   0x02a7f726 _dispatch_main_queue_callback_4CF + 340,\r\n11  CoreFoundation                      0x0279a43e __CFRUNLOOP_IS_SERVICING_THE_MAIN_DISPATCH_QUEUE__ + 14,\r\n12  CoreFoundation                      0x026db5cb __CFRunLoopRun + 1963,\r\n13  CoreFoundation                      0x026da9d3 CFRunLoopRunSpecific + 467,\r\n14  CoreFoundation                      0x026da7eb CFRunLoopRunInMode + 123,\r\n15  GraphicsServices                    0x0389f5ee GSEventRunModal + 192,\r\n16  GraphicsServices                    0x0389f42b GSEventRun + 104,\r\n17  UIKit                               0x015b9f9b UIApplicationMain + 1225,\r\n18  MyApp                                 0x00073f2d main + 141,\r\n19  libdyld.dylib                       0x02cc6701 start + 1\r\n)\r\n\r\nConfiguration:\r\niPhone 5 using Network Link Conditioner with Edge profile"
    email: kent@kentmccullough.com
    modified: "2014-07-10T20:10:21.838551Z"
    number: "17089661"
    number_intvalue: 17089661
    originated: June 1, 2014
    parent_number: '&{NULL_VALUE}'
    product: iOS SDK
    product_version: 7.0+
    reproducible: Always
    resolved: ""
    status: Duplicate of 15549095 (Closed)
    title: MKTileOverlay crash when MKMapViewDelegate is dereferenced
