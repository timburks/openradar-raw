apiVersion: openapi/v1alpha1
kind: Radar
metadata:
    name: "13024643"
    labels:
        datastore_id: "2569401"
data:
    classification: Serious bug
    created: "2013-01-16T17:13:38.991398Z"
    description: "NSDateFormatter fails to provide a non-nil result parsing some strings with more that three fraction digits.\r\n\r\nSteps to Reproduce:\r\n1. Setup a NSDateFormatter with a dateFormat that has more than three (3) “S” symbols.\r\n2. Parse a string with a fractional part like \".9994\".\r\n3. Parse a string with a fractional part like \".9995\".\r\n\r\nExpected Results:\r\nBoth 2 and 3 should result in a valid NSDate (even if we lose precision).\r\n\r\nActual Results:\r\nCase 2 works without problem, while case 3 returns nil.\r\n\r\nRegression:\r\nI have been able to reproduce this in both 10.7 and 10.8 machines, and also in iOS 5.0 and iOS 6.0 devices.\r\n\r\nNotes:\r\nI attach a little test program that shows the problem. The program does the parsing of 10 test strings for a formatter that works as expected and other 10 test strings with a formatter that fails for the last 5 strings.\r\n\r\nAttachments:\r\n\r\n--- test-date-formatter.m ---\r\n// clang -Wall -framework Foundation -o test-date-formatter test-date-formatter.m\r\n#import <Foundation/Foundation.h>\r\n\r\nint main(int argc, char *argv[]) {\r\n  @autoreleasepool {\r\n    NSString *problem0 = @\"2013-01-15T17:34:26.9990Z\";\r\n    NSString *problem1 = @\"2013-01-15T17:34:26.9991Z\";\r\n    NSString *problem2 = @\"2013-01-15T17:34:26.9992Z\";\r\n    NSString *problem3 = @\"2013-01-15T17:34:26.9993Z\";\r\n    NSString *problem4 = @\"2013-01-15T17:34:26.9994Z\";\r\n    NSString *problem5 = @\"2013-01-15T17:34:26.9995Z\";\r\n    NSString *problem6 = @\"2013-01-15T17:34:26.9996Z\";\r\n    NSString *problem7 = @\"2013-01-15T17:34:26.9997Z\";\r\n    NSString *problem8 = @\"2013-01-15T17:34:26.9998Z\";\r\n    NSString *problem9 = @\"2013-01-15T17:34:26.9999Z\";\r\n\r\n    NSString *noProblem0 = @\"2013-01-15T17:34:26.990Z\";\r\n    NSString *noProblem1 = @\"2013-01-15T17:34:26.991Z\";\r\n    NSString *noProblem2 = @\"2013-01-15T17:34:26.992Z\";\r\n    NSString *noProblem3 = @\"2013-01-15T17:34:26.993Z\";\r\n    NSString *noProblem4 = @\"2013-01-15T17:34:26.994Z\";\r\n    NSString *noProblem5 = @\"2013-01-15T17:34:26.995Z\";\r\n    NSString *noProblem6 = @\"2013-01-15T17:34:26.996Z\";\r\n    NSString *noProblem7 = @\"2013-01-15T17:34:26.997Z\";\r\n    NSString *noProblem8 = @\"2013-01-15T17:34:26.998Z\";\r\n    NSString *noProblem9 = @\"2013-01-15T17:34:26.999Z\";\r\n\r\n    NSDateFormatter *problemFormatter = [[NSDateFormatter alloc] init];\r\n    problemFormatter.dateFormat = @\"yyyy-MM-dd'T'HH:mm:ss.SSSS'Z\";\r\n\r\n    NSDateFormatter *noProblemFormatter = [[NSDateFormatter alloc] init];\r\n    noProblemFormatter.dateFormat = @\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z\";\r\n\r\n    NSLog(@\"%@ -> %@\", problem0, [problemFormatter dateFromString:problem0]);\r\n    NSLog(@\"%@ -> %@\", problem1, [problemFormatter dateFromString:problem1]);\r\n    NSLog(@\"%@ -> %@\", problem2, [problemFormatter dateFromString:problem2]);\r\n    NSLog(@\"%@ -> %@\", problem3, [problemFormatter dateFromString:problem3]);\r\n    NSLog(@\"%@ -> %@\", problem4, [problemFormatter dateFromString:problem4]);\r\n    NSLog(@\"%@ -> %@\", problem5, [problemFormatter dateFromString:problem5]);\r\n    NSLog(@\"%@ -> %@\", problem6, [problemFormatter dateFromString:problem6]);\r\n    NSLog(@\"%@ -> %@\", problem7, [problemFormatter dateFromString:problem7]);\r\n    NSLog(@\"%@ -> %@\", problem8, [problemFormatter dateFromString:problem8]);\r\n    NSLog(@\"%@ -> %@\", problem9, [problemFormatter dateFromString:problem9]);\r\n\r\n    NSLog(@\"%@ -> %@\", noProblem0, [noProblemFormatter dateFromString:noProblem0]);\r\n    NSLog(@\"%@ -> %@\", noProblem1, [noProblemFormatter dateFromString:noProblem1]);\r\n    NSLog(@\"%@ -> %@\", noProblem2, [noProblemFormatter dateFromString:noProblem2]);\r\n    NSLog(@\"%@ -> %@\", noProblem3, [noProblemFormatter dateFromString:noProblem3]);\r\n    NSLog(@\"%@ -> %@\", noProblem4, [noProblemFormatter dateFromString:noProblem4]);\r\n    NSLog(@\"%@ -> %@\", noProblem5, [noProblemFormatter dateFromString:noProblem5]);\r\n    NSLog(@\"%@ -> %@\", noProblem6, [noProblemFormatter dateFromString:noProblem6]);\r\n    NSLog(@\"%@ -> %@\", noProblem7, [noProblemFormatter dateFromString:noProblem7]);\r\n    NSLog(@\"%@ -> %@\", noProblem8, [noProblemFormatter dateFromString:noProblem8]);\r\n    NSLog(@\"%@ -> %@\", noProblem9, [noProblemFormatter dateFromString:noProblem9]);\r\n  }\r\n}\r\n--- EOF ---"
    email: drodrigueztroitino@gmail.com
    modified: "2013-02-06T00:50:29.050068Z"
    number: "13024643"
    number_intvalue: 13024643
    originated: 16-Jan-2013 06:10 PM
    parent_number: '&{NULL_VALUE}'
    product: Mac OS X
    product_version: 10.7.5
    reproducible: Always
    resolved: ""
    status: Duplicate/#11357077
    title: NSDateFormatter fails for some input strings
