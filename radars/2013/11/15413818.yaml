apiVersion: openapi/v1alpha1
kind: Radar
metadata:
    name: "15413818"
    labels:
        datastore_id: "5880034640265216"
data:
    classification: Crash
    created: "2013-11-07T14:31:18.255012Z"
    description: "Summary:\r\nIf you build an app with only 32 bit support and then run on a 64 bit device like a 5s and use MFMessageComposeViewController together with a UIEdgeInsets appearance setting the MessagesViewService will crash.\r\n\r\nSteps to Reproduce:\r\n1. Build included test app\r\n2. Run on 64 bit device\r\n\r\nExpected Results:\r\nShould show MFMessageComposeViewController\r\n\r\nActual Results:\r\nDoes not MFMessageComposeViewController and MessagesViewService crashes.\r\n\r\nVersion:\r\niOS 7.0.3\r\n\r\nSample app:\r\n\r\nAppDelegate.h:\r\n#import <UIKit/UIKit.h>\r\n\r\n@interface AppDelegate : UIResponder <UIApplicationDelegate>\r\n@property (strong, nonatomic) UIWindow *window;\r\n@end\r\n\r\n\r\nAppDelegate.m:\r\n// Compile with armv7, arm7s etc but exclude arm64. Then run on 64 bit device like 5s.\r\n\r\n// MFMessageComposeViewController seems to be a remote view controller handled by\r\n// MessagesViewService. The UIApperenace settings are replicated over to MessagesViewService\r\n// but there is some kind of mismatch for UIEdgeInsets apperance proprties.\r\n// MessagesViewService runs as 64 bit i guess.\r\n\r\n// app log:\r\n// init Error Domain=NSCocoaErrorDomain Code=4097 \"The operation couldn’t be completed. (Cocoa error 4097.)\"\r\n// Remote compose controller timed out (NO)!\r\n\r\n// console log:\r\n/*\r\nMessagesViewService[185] <Warning>: *** Assertion failure in -[_UIAppearanceRecorder _applyCustomizations](), /SourceCache/UIKit/UIKit-2903.2/UIAppearance.m:1877\r\nMessagesViewService[185] <Error>: *** Terminating app due to uncaught exception 'NSInternalInconsistencyException', reason: 'Illegal property type, {UIEdgeInsets=ffff}'\r\n*** First throw call stack:\r\n(0x182b7709c 0x18ea91d78 0x182b76f5c 0x1836a3420 0x185f5e938 0x186063a6c 0x185ff24f8 0x182b7b810 0x182a94dfc 0x182a99654 0x186047e64 0x182b7988c 0x182a994ec 0x182b7b810 0x182a94dfc 0x182a99654 0x18600f144 0x182b7988c 0x182a994ec 0x182b7b810 0x182a94dfc 0x182a99654 0x182b7988c 0x182a994ec 0x182b7b810 0x182a94dfc 0x18f06043c 0x18f0603fc 0x18f063578 0x182b36d64 0x182b350a4 0x182a75b78 0x188497830 0x185ab305c 0x100073d80 0x18f07baa0)\r\nReportCrash[186] <Notice>: ReportCrash acting against PID 185\r\nReportCrash[186] <Notice>: Formulating crash report for process MessagesViewService[185]\r\ncom.apple.launchd[1] (UIKitApplication:com.apple.mobilesms.compose[0x5c33][185]) <Warning>: (UIKitApplication:com.apple.mobilesms.compose[0x5c33]) Job appears to have crashed: Abort trap: 6\r\nApp[181] <Warning>: init Error Domain=NSCocoaErrorDomain Code=4097 \"The operation couldn’t be completed. (Cocoa error 4097.)\"\r\nApp[181] <Warning>: Remote compose controller timed out (NO)!\r\nbackboardd[31] <Warning>: Application 'UIKitApplication:com.apple.mobilesms.compose[0x5c33]' exited abnormally with signal 6: Abort trap: 6\r\nReportCrash[186] <Notice>: Saved crashreport to /var/mobile/Library/Logs/CrashReporter/MessagesViewService_2013-11-06-175025_iPhone.plist using uid: 0 gid: 0, synthetic_euid: 501 egid: 0\r\n*/\r\n\r\n// MessageViewService crash backtrace:\r\n/*\r\n Last Exception Backtrace:\r\n 0   CoreFoundation                \t0x188b7b09c __exceptionPreprocess + 132\r\n 1   libobjc.A.dylib               \t0x194a95d78 objc_exception_throw + 60\r\n 2   CoreFoundation                \t0x188b7af5c +[NSException raise:format:arguments:] + 116\r\n 3   Foundation                    \t0x1896a7420 -[NSAssertionHandler handleFailureInFunction:file:lineNumber:description:] + 88\r\n 4   UIKit                         \t0x18bf62938 -[_UIAppearanceRecorder _applyCustomizations] + 2088\r\n 5   UIKit                         \t0x18c067a6c UIViewServiceUpdateAppearanceWithSerializedRepresentations + 404\r\n 6   UIKit                         \t0x18bff64f8 -[_UIViewServiceViewControllerOperator __createViewController:withAppearanceSerializedRepresentations:legacyAppearance:hostAccessibilityServerPort:canShowTextServices:replyHandler:] + 848\r\n 7   CoreFoundation                \t0x188b7f810 __invoking___ + 144\r\n 8   CoreFoundation                \t0x188a98dfc -[NSInvocation invoke] + 308\r\n 9   CoreFoundation                \t0x188a9d654 -[NSInvocation invokeWithTarget:] + 72\r\n 10  UIKit                         \t0x18c04be64 -[_UIViewServiceImplicitAnimationDecodingProxy forwardInvocation:] + 252\r\n 11  CoreFoundation                \t0x188b7d88c ___forwarding___ + 416\r\n 12  CoreFoundation                \t0x188a9d4ec __forwarding_prep_0___ + 92\r\n 13  CoreFoundation                \t0x188b7f810 __invoking___ + 144\r\n 14  CoreFoundation                \t0x188a98dfc -[NSInvocation invoke] + 308\r\n 15  CoreFoundation                \t0x188a9d654 -[NSInvocation invokeWithTarget:] + 72\r\n 16  UIKit                         \t0x18c013144 -[_UIQueueingProxy forwardInvocation:] + 344\r\n 17  CoreFoundation                \t0x188b7d88c ___forwarding___ + 416\r\n 18  CoreFoundation                \t0x188a9d4ec __forwarding_prep_0___ + 92\r\n 19  CoreFoundation                \t0x188b7f810 __invoking___ + 144\r\n 20  CoreFoundation                \t0x188a98dfc -[NSInvocation invoke] + 308\r\n 21  CoreFoundation                \t0x188a9d654 -[NSInvocation invokeWithTarget:] + 72\r\n 22  CoreFoundation                \t0x188b7d88c ___forwarding___ + 416\r\n 23  CoreFoundation                \t0x188a9d4ec __forwarding_prep_0___ + 92\r\n 24  CoreFoundation                \t0x188b7f810 __invoking___ + 144\r\n 25  CoreFoundation                \t0x188a98dfc -[NSInvocation invoke] + 308\r\n 26  libdispatch.dylib             \t0x19506443c _dispatch_call_block_and_release + 24\r\n 27  libdispatch.dylib             \t0x1950643fc _dispatch_client_callout + 16\r\n 28  libdispatch.dylib             \t0x195067578 _dispatch_main_queue_callback_4CF + 344\r\n 29  CoreFoundation                \t0x188b3ad64 __CFRUNLOOP_IS_SERVICING_THE_MAIN_DISPATCH_QUEUE__ + 12\r\n 30  CoreFoundation                \t0x188b390a4 __CFRunLoopRun + 1452\r\n 31  CoreFoundation                \t0x188a79b78 CFRunLoopRunSpecific + 452\r\n 32  GraphicsServices              \t0x18e49b830 GSEventRunModal + 168\r\n 33  UIKit                         \t0x18bab705c UIApplicationMain + 1156\r\n 34  MessagesViewService           \t0x1000d3d80 0x1000d0000 + 15744\r\n 35  libdyld.dylib                 \t0x19507faa0 start + 4\r\n*/\r\n\r\n#import \"AppDelegate.h\"\r\n#import <MessageUI/MessageUI.h>\r\n\r\n@interface AppDelegate () <MFMessageComposeViewControllerDelegate>\r\n@end\r\n\r\n@implementation AppDelegate\r\n\r\n- (void)messageComposeViewController:(MFMessageComposeViewController *)controller\r\n                 didFinishWithResult:(MessageComposeResult)result\r\n{    \r\n    [controller dismissViewControllerAnimated:YES completion:NULL];\r\n}\r\n\r\n- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions\r\n{\r\n    id appearance = [UIButton appearance];\r\n    [appearance setContentEdgeInsets:UIEdgeInsetsMake(0, 0, 0, 0)];\r\n    \r\n    self.window = [[UIWindow alloc] initWithFrame:[UIScreen mainScreen].bounds];\r\n    [self.window  makeKeyAndVisible];\r\n    self.window.rootViewController = [[UINavigationController alloc]\r\n                                      initWithRootViewController:[[UIViewController alloc] init]];\r\n    \r\n    MFMessageComposeViewController *composerViewController = [[MFMessageComposeViewController alloc] init];\r\n    composerViewController.messageComposeDelegate = self;\r\n    [self.window.rootViewController presentViewController:composerViewController\r\n                                                 animated:YES\r\n                                               completion:NULL];\r\n\r\n    return YES;\r\n}\r\n\r\n@end"
    email: mattias.wadman@gmail.com
    modified: "2013-11-07T14:31:18.255178Z"
    number: "15413818"
    number_intvalue: 15413818
    originated: "2013-11-07"
    parent_number: '&{NULL_VALUE}'
    product: iOS
    product_version: 7.0.3
    reproducible: Yes
    resolved: ""
    status: Open
    title: MFMessageComposeViewController crashes MessagesViewService when using UIEdgeInsets appearance
