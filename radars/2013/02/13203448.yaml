apiVersion: openapi/v1alpha1
kind: Radar
metadata:
    name: "13203448"
    labels:
        datastore_id: "2710402"
data:
    classification: Crash/Hang/Data Loss
    created: "2013-02-13T00:16:37.905912Z"
    description: "12-Feb-2013 04:12 PM Jonathon Mah:\r\nWe have an app with a window that can go full-screen; when it does, the fullScreenAccessoryView contains a search field (NSSearchField subclass). This search field can have a popover shown relative to it.\r\n\r\nIn full-screen mode with the popover visible and with the search field as the first responder (well, the field editor is the actual first responder), pressing Cmd-Ctrl-F to exit full-screen hangs the app with the following stack trace:\r\n\r\n\r\n#0\t0x00007fff5fc01660 in dyld::findMappedRange(unsigned long) ()\r\n#1\t0x00007fff5fc0b1df in client_dyld_find_unwind_sections(void*, dyld_unwind_sections*) ()\r\n#2\t0x00007fff98760f56 in _dyld_find_unwind_sections ()\r\n#3\t0x00007fff9a1c6daa in libunwind::UnwindCursor<libunwind::LocalAddressSpace, libunwind::Registers_x86_64>::setInfoBasedOnIPRegister(bool) ()\r\n#4\t0x00007fff9a1c7555 in libunwind::UnwindCursor<libunwind::LocalAddressSpace, libunwind::Registers_x86_64>::step() ()\r\n#5\t0x00007fff90af57af in objc_addExceptionHandler ()\r\n#6\t0x00007fff9736020c in _CFDoExceptionOperation ()\r\n#7\t0x00007fff90f25b62 in -[NSViewHierarchyLock lockForReadingWithExceptionHandler:] ()\r\n#8\t0x00007fff9106ef1a in -[NSConcreteTextStorage _lockForReading] ()\r\n#9\t0x00007fff90fc0bf9 in _NSFastFillAllGlyphHolesForGlyphRange ()\r\n#10\t0x00007fff910053f6 in _NSFastFillAllLayoutHolesForGlyphRange ()\r\n#11\t0x00007fff91036862 in -[NSLayoutManager(NSPrivate) _firstPassGlyphRangeForBoundingRect:inTextContainer:okToFillHoles:] ()\r\n#12\t0x00007fff91035a02 in -[NSLayoutManager(NSPrivate) _glyphRangeForBoundingRect:inTextContainer:fast:okToFillHoles:] ()\r\n#13\t0x00007fff90feea51 in -[NSTextView setNeedsDisplayInRect:avoidAdditionalLayout:] ()\r\n#14\t0x00007fff90f18672 in -[NSView setNeedsDisplay:] ()\r\n#15\t0x00007fff90ff715c in -[NSTextView(NSSharing) setSelectable:] ()\r\n#16\t0x00007fff90ff0860 in _NSEditTextCellWithOptions ()\r\n#17\t0x00007fff90ff011d in -[NSTextFieldCell _selectOrEdit:inView:target:editor:event:start:end:] ()\r\n#18\t0x00007fff90feff39 in -[NSSearchFieldCell _selectOrEdit:inView:target:editor:event:start:end:] ()\r\n#19\t0x00007fff90fefe90 in -[NSCell selectWithFrame:inView:editor:delegate:start:length:] ()\r\n#20\t0x00007fff90fe7d8b in -[NSTextField selectText:] ()\r\n#21\t0x00007fff90fe7b56 in -[NSTextField becomeFirstResponder] ()\r\n#22\t0x00007fff90fe78e8 in -[NSWindow makeFirstResponder:] ()\r\n#23\t0x000000010026fe4f in -[LIThickTitleBarWindow makeFirstResponder:] at /Users/jonathon/Documents/Streams/Delicious Monster/UberLibrary/Library/LIThickTitleBarWindow.m:136\r\n#24\t0x00007fff90e4a8e6 in _NSWindowRecursiveFindFirstResponder ()\r\n#25\t0x00007fff910e14bc in -[NSWindow removeChildWindow:] ()\r\n#26\t0x00007fff916693de in -[NSToolbarFullScreenWindowManager updateWindowVisibility] ()\r\n#27\t0x00007fff91667bd2 in -[NSToolbarFullScreenWindowManager animateWindowToCorrectPositionIfNecessary] ()\r\n#28\t0x00007fff91669027 in -[NSToolbarFullScreenWindowManager _disableFullScreenForceVisibleForToolbar:] ()\r\n#29\t0x00007fff91661f4a in -[NSToolbarFullScreenWindow _setFirstResponder:] ()\r\n#30\t0x00007fff90e4fc65 in -[NSWindow(NSWindowSharedFirstResponder) _changeFirstResponderToParentsFirstResponder] ()\r\n#31\t0x00007fff90ffd66c in _NSWindowRecursiveChangeAllAttachmentsFirstResponder ()\r\n#32\t0x00007fff90fe79f7 in -[NSWindow makeFirstResponder:] ()\r\n#33\t0x000000010026fe4f in -[LIThickTitleBarWindow makeFirstResponder:] at /Users/jonathon/Documents/Streams/Delicious Monster/UberLibrary/Library/LIThickTitleBarWindow.m:136\r\n#34\t0x00007fff9151a0a2 in -[NSWindow _makeParentWindowHaveFirstResponder:] ()\r\n#35\t0x00007fff90fe767a in -[NSWindow makeFirstResponder:] ()\r\n#36\t0x00007fff90fe7f23 in -[NSWindow endEditingFor:] ()\r\n#37\t0x00007fff90fe7d15 in -[NSTextField selectText:] ()\r\n#38\t0x00007fff90fe7b56 in -[NSTextField becomeFirstResponder] ()\r\n#39\t0x00007fff90fe78e8 in -[NSWindow makeFirstResponder:] ()\r\n#40\t0x000000010026fe4f in -[LIThickTitleBarWindow makeFirstResponder:] at /Users/jonathon/Documents/Streams/Delicious Monster/UberLibrary/Library/LIThickTitleBarWindow.m:136\r\n#41\t0x00007fff90e4a8e6 in _NSWindowRecursiveFindFirstResponder ()\r\n#42\t0x00007fff910e14bc in -[NSWindow removeChildWindow:] ()\r\n#43\t0x00007fff916693de in -[NSToolbarFullScreenWindowManager updateWindowVisibility] ()\r\n#44\t0x00007fff91667bd2 in -[NSToolbarFullScreenWindowManager animateWindowToCorrectPositionIfNecessary] ()\r\n#45\t0x00007fff9166908d in -[NSToolbarFullScreenWindowManager _enableFullScreenForceVisibleForToolbar:] ()\r\n#46\t0x00007fff91661f4a in -[NSToolbarFullScreenWindow _setFirstResponder:] ()\r\n#47\t0x00007fff90e4fc65 in -[NSWindow(NSWindowSharedFirstResponder) _changeFirstResponderToParentsFirstResponder] ()\r\n#48\t0x00007fff90ffd66c in _NSWindowRecursiveChangeAllAttachmentsFirstResponder ()\r\n#49\t0x00007fff90fe79f7 in -[NSWindow makeFirstResponder:] ()\r\n#50\t0x000000010026fe4f in -[LIThickTitleBarWindow makeFirstResponder:] at /Users/jonathon/Documents/Streams/Delicious Monster/UberLibrary/Library/LIThickTitleBarWindow.m:136\r\n#51\t0x00007fff9151a0a2 in -[NSWindow _makeParentWindowHaveFirstResponder:] ()\r\n#52\t0x00007fff90fe767a in -[NSWindow makeFirstResponder:] ()\r\n#53\t0x00007fff90ff0d67 in _NSEditTextCellWithOptions ()\r\n#54\t0x00007fff90ff011d in -[NSTextFieldCell _selectOrEdit:inView:target:editor:event:start:end:] ()\r\n#55\t0x00007fff90feff39 in -[NSSearchFieldCell _selectOrEdit:inView:target:editor:event:start:end:] ()\r\n#56\t0x00007fff90fefe90 in -[NSCell selectWithFrame:inView:editor:delegate:start:length:] ()\r\n#57\t0x00007fff90fe7d8b in -[NSTextField selectText:] ()\r\n#58\t0x00007fff90fe7b56 in -[NSTextField becomeFirstResponder] ()\r\n#59\t0x00007fff90fe78e8 in -[NSWindow makeFirstResponder:] ()\r\n#60\t0x000000010026fe4f in -[LIThickTitleBarWindow makeFirstResponder:] at /Users/jonathon/Documents/Streams/Delicious Monster/UberLibrary/Library/LIThickTitleBarWindow.m:136\r\n#61\t0x00007fff90e4a8e6 in _NSWindowRecursiveFindFirstResponder ()\r\n#62\t0x00007fff910e14bc in -[NSWindow removeChildWindow:] ()\r\n#63\t0x00007fff916693de in -[NSToolbarFullScreenWindowManager updateWindowVisibility] ()\r\n#64\t0x00007fff91667bd2 in -[NSToolbarFullScreenWindowManager animateWindowToCorrectPositionIfNecessary] ()\r\n#65\t0x00007fff91669027 in -[NSToolbarFullScreenWindowManager _disableFullScreenForceVisibleForToolbar:] ()\r\n#66\t0x00007fff91661f4a in -[NSToolbarFullScreenWindow _setFirstResponder:] ()\r\n#67\t0x00007fff90e4fc65 in -[NSWindow(NSWindowSharedFirstResponder) _changeFirstResponderToParentsFirstResponder] ()\r\n--------------------------     frames elided\r\n#12463\t0x00007fff90ffd66c in _NSWindowRecursiveChangeAllAttachmentsFirstResponder ()\r\n#12464\t0x00007fff90fe79f7 in -[NSWindow makeFirstResponder:] ()\r\n#12465\t0x000000010026fe4f in -[LIThickTitleBarWindow makeFirstResponder:] at /Users/jonathon/Documents/Streams/Delicious Monster/UberLibrary/Library/LIThickTitleBarWindow.m:136\r\n#12466\t0x00007fff9151a0a2 in -[NSWindow _makeParentWindowHaveFirstResponder:] ()\r\n#12467\t0x00007fff90fe767a in -[NSWindow makeFirstResponder:] ()\r\n#12468\t0x00007fff90fe7f23 in -[NSWindow endEditingFor:] ()\r\n#12469\t0x00007fff90fe7d15 in -[NSTextField selectText:] ()\r\n#12470\t0x00007fff90fe7b56 in -[NSTextField becomeFirstResponder] ()\r\n#12471\t0x00007fff90fe78e8 in -[NSWindow makeFirstResponder:] ()\r\n#12472\t0x000000010026fe4f in -[LIThickTitleBarWindow makeFirstResponder:] at /Users/jonathon/Documents/Streams/Delicious Monster/UberLibrary/Library/LIThickTitleBarWindow.m:136\r\n#12473\t0x00007fff90e4a8e6 in _NSWindowRecursiveFindFirstResponder ()\r\n#12474\t0x00007fff910e14bc in -[NSWindow removeChildWindow:] ()\r\n#12475\t0x00007fff916693de in -[NSToolbarFullScreenWindowManager updateWindowVisibility] ()\r\n#12476\t0x00007fff91667bd2 in -[NSToolbarFullScreenWindowManager animateWindowToCorrectPositionIfNecessary] ()\r\n#12477\t0x00007fff9166908d in -[NSToolbarFullScreenWindowManager _enableFullScreenForceVisibleForToolbar:] ()\r\n#12478\t0x00007fff91661f4a in -[NSToolbarFullScreenWindow _setFirstResponder:] ()\r\n#12479\t0x00007fff90e4fc65 in -[NSWindow(NSWindowSharedFirstResponder) _changeFirstResponderToParentsFirstResponder] ()\r\n#12480\t0x00007fff90ffd66c in _NSWindowRecursiveChangeAllAttachmentsFirstResponder ()\r\n#12481\t0x00007fff90fe79f7 in -[NSWindow makeFirstResponder:] ()\r\n#12482\t0x000000010026fe4f in -[LIThickTitleBarWindow makeFirstResponder:] at /Users/jonathon/Documents/Streams/Delicious Monster/UberLibrary/Library/LIThickTitleBarWindow.m:136\r\n#12483\t0x00007fff9151a0a2 in -[NSWindow _makeParentWindowHaveFirstResponder:] ()\r\n#12484\t0x00007fff90fe767a in -[NSWindow makeFirstResponder:] ()\r\n#12485\t0x00007fff90ff0d67 in _NSEditTextCellWithOptions ()\r\n#12486\t0x00007fff90ff011d in -[NSTextFieldCell _selectOrEdit:inView:target:editor:event:start:end:] ()\r\n#12487\t0x00007fff90feff39 in -[NSSearchFieldCell _selectOrEdit:inView:target:editor:event:start:end:] ()\r\n#12488\t0x00007fff90fefe90 in -[NSCell selectWithFrame:inView:editor:delegate:start:length:] ()\r\n#12489\t0x00007fff90fe7d8b in -[NSTextField selectText:] ()\r\n#12490\t0x00007fff90fe7b56 in -[NSTextField becomeFirstResponder] ()\r\n#12491\t0x00007fff90fe78e8 in -[NSWindow makeFirstResponder:] ()\r\n#12492\t0x000000010026fe4f in -[LIThickTitleBarWindow makeFirstResponder:] at /Users/jonathon/Documents/Streams/Delicious Monster/UberLibrary/Library/LIThickTitleBarWindow.m:136\r\n#12493\t0x00007fff90e4a8e6 in _NSWindowRecursiveFindFirstResponder ()\r\n#12494\t0x00007fff910e14bc in -[NSWindow removeChildWindow:] ()\r\n#12495\t0x00007fff916693de in -[NSToolbarFullScreenWindowManager updateWindowVisibility] ()\r\n#12496\t0x00007fff91667bd2 in -[NSToolbarFullScreenWindowManager animateWindowToCorrectPositionIfNecessary] ()\r\n#12497\t0x00007fff91669027 in -[NSToolbarFullScreenWindowManager _disableFullScreenForceVisibleForToolbar:] ()\r\n#12498\t0x00007fff91661f4a in -[NSToolbarFullScreenWindow _setFirstResponder:] ()\r\n#12499\t0x00007fff90e4fc65 in -[NSWindow(NSWindowSharedFirstResponder) _changeFirstResponderToParentsFirstResponder] ()\r\n#12500\t0x00007fff90ffd66c in _NSWindowRecursiveChangeAllAttachmentsFirstResponder ()\r\n#12501\t0x00007fff90fe79f7 in -[NSWindow makeFirstResponder:] ()\r\n#12502\t0x000000010026fe4f in -[LIThickTitleBarWindow makeFirstResponder:] at /Users/jonathon/Documents/Streams/Delicious Monster/UberLibrary/Library/LIThickTitleBarWindow.m:136\r\n#12503\t0x00007fff9151a0a2 in -[NSWindow _makeParentWindowHaveFirstResponder:] ()\r\n#12504\t0x00007fff90fe767a in -[NSWindow makeFirstResponder:] ()\r\n#12505\t0x00007fff90fe7f23 in -[NSWindow endEditingFor:] ()\r\n#12506\t0x00007fff90f2225e in -[NSView removeFromSuperview] ()\r\n#12507\t0x00007fff9111e8b6 in -[_NSKeyboardFocusClipView removeFromSuperview] ()\r\n#12508\t0x00007fff9111e55b in -[NSCell endEditing:] ()\r\n#12509\t0x00007fff9111e364 in -[NSSearchFieldCell endEditing:] ()\r\n#12510\t0x00007fff9111ded0 in -[NSTextField textDidEndEditing:] ()\r\n#12511\t0x00007fff9732147a in _CFXNotificationPost ()\r\n#12512\t0x00007fff99d31846 in -[NSNotificationCenter postNotificationName:object:userInfo:] ()\r\n#12513\t0x00007fff9111db7a in -[NSTextView(NSSharing) resignFirstResponder] ()\r\n#12514\t0x00007fff90fe77d8 in -[NSWindow makeFirstResponder:] ()\r\n#12515\t0x000000010026fe4f in -[LIThickTitleBarWindow makeFirstResponder:] at /Users/jonathon/Documents/Streams/Delicious Monster/UberLibrary/Library/LIThickTitleBarWindow.m:136\r\n#12516\t0x00007fff90e4a8e6 in _NSWindowRecursiveFindFirstResponder ()\r\n#12517\t0x00007fff910e14bc in -[NSWindow removeChildWindow:] ()\r\n#12518\t0x00007fff916693de in -[NSToolbarFullScreenWindowManager updateWindowVisibility] ()\r\n#12519\t0x00007fff91667f43 in -[NSToolbarFullScreenWindowManager windowDidChangeFullScreenStatus:] ()\r\n#12520\t0x00007fff9732147a in _CFXNotificationPost ()\r\n#12521\t0x00007fff99d31846 in -[NSNotificationCenter postNotificationName:object:userInfo:] ()\r\n#12522\t0x00007fff916732bb in -[_NSWindowFullScreenTransition exitFullScreenTransitionForWindow:animated:] ()\r\n#12523\t0x00007fff9151e5d6 in -[NSWindow _resignFullScreenWindowAndExitFullScreen:] ()\r\n#12524\t0x00007fff9103ba59 in -[NSApplication sendAction:to:from:] ()\r\n#12525\t0x00007fff9117144c in -[NSMenuItem _corePerformAction] ()\r\n#12526\t0x00007fff9117113a in -[NSCarbonMenuImpl performActionWithHighlightingForItemAtIndex:] ()\r\n#12527\t0x00007fff9116fdc0 in -[NSMenu performKeyEquivalent:] ()\r\n#12528\t0x00007fff9116f283 in -[NSApplication _handleKeyEquivalent:] ()\r\n#12529\t0x00007fff9102c243 in -[NSApplication sendEvent:] ()\r\n#12530\t0x00007fff90f422fa in -[NSApplication run] ()\r\n#12531\t0x00007fff90ee6cb6 in NSApplicationMain ()\r\n#12532\t0x00000001000026b3 in main at /Users/jonathon/Documents/Streams/Delicious Monster/UberLibrary/Library/main.m:59\r\n#12533\t0x00007fff987617e1 in start ()\r\n\r\n\r\n12-Feb-2013 04:15 PM Jonathon Mah:\r\nOh, I should add that the -[LIThickTitleBarWindow makeFirstResponder:] method simply calls super, and the hang still occurs if that override is removed entirely."
    email: me@JonathonMah.com
    modified: "2013-07-23T23:41:20.321337Z"
    number: "13203448"
    number_intvalue: 13203448
    originated: 12-Feb-2013 04:12 PM
    parent_number: '&{NULL_VALUE}'
    product: Mac OS X
    product_version: 10.8.2 (12C3006)
    reproducible: Always
    resolved: ""
    status: Duplicate/14250137/Open
    title: Hang exiting full-screen mode with popover in accessory view
