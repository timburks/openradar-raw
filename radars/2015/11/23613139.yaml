apiVersion: openapi/v1alpha1
kind: Radar
metadata:
    name: "23613139"
    labels:
        datastore_id: "5054868645478400"
data:
    classification: ""
    created: "2015-11-19T18:25:10.5223Z"
    description: "Summary:\r\nAfter upgrading to OS X El Capitan, Photos fails to migrate the iPhoto archive, located on an AFP share, with the error panel (translated from German):\r\n\r\n\"Repairing media rights.\r\nArchive is protected or you have no  access rights for modifications.\r\nPhotos can repair permissions.\"\r\n\r\nTrying to repair permissions fails after a while with an error message, which does not allow to continue migration.\r\n\r\nSteps to Reproduce:\r\n1.Setup a network account (ajr) and configure a OSX client to login into that account.\r\n2. On the server prepare a volume for an iPhoto library and create acls like so:\r\nchmod -R +a \"ajr allow list,add_file,search,delete,add_subdirectory,delete_child,readattr,writeattr,readextattr,writeextattr,readsecurity,writesecurity,chown,file_inherit,directory_inherit\" iPhotoLib\r\n3. Mount that volume at the client (user ajr) and create the iphoto library on it.\r\n4. Note: iPhoto runs perfectly on that volume. Different Network users (if acls added for them) have write access to the library, if not connected simultaneously.\r\n5. Try to migrate the library to Photos.\r\n\r\n\r\nExpected Results:\r\nAs the acl does allow everything for the user ajr, Photos should be able to create all changes/locks to the iPhoto library as needed.\r\n\r\nActual Results:\r\nInstead Photos comes up with the above error message.\r\nNo hint in the logs about what went wrong.\r\n\r\nVersion:\r\n10.11.1 (15B42)\r\n\r\nAttachment shows ACL:\r\n\r\n[zeus:Raus/Bild_Archiv/B] root# ls -le iPhotoLib\r\ntotal 51216\r\n-rw-rw-rw-@  1 ajr   raus       151 Nov 18 11:36 .Projects.db-conch\r\n-rw-rw-rw-   1 ajr   raus       148 Sep 24  2011 .SharingActivity.db-conch\r\n-rw-rw-rw-   1 ajr   raus      4096 Apr 12  2013 ._.Projects.db-conch\r\n-rw-rw-rw-   1 ajr   raus      4096 Jan 29  2014 ._AlbumData.xml\r\n-rw-rw-rw-   1 ajr   raus      4096 Apr 12  2013 ._Info.plist\r\n-rw-rw-rw-   1 ajr   raus      4096 Apr 12  2013 ._ProjectDBVersion.plist\r\n-rw-rw-rw-   1 ajr   raus      4096 Apr 12  2013 ._Projects.db\r\n-rw-rw-rw-   1 ajr   raus      4096 Apr 12  2013 ._iPhoto.ipspot\r\n-rw-rw-rw-   1 ajr   raus      4096 Apr 12  2013 ._iPhotoLock.data\r\n-rw-rw-rw-   1 ajr   raus      4096 Jan 25  2014 ._iPod Photo Cache\r\n-rw-rw-rw-@  1 ajr   raus        16 Jul  9  2011 .ipspot_update\r\n-rw-r--r--@  1 ajr   raus  24041886 Nov 19 12:32 AlbumData.xml\r\ndrwxrwxrwx   2 ajr   raus        68 Mar  8  2011 Attachments\r\ndrwxrwxrwx   2 ajr   raus        68 Feb 18  2009 Auto Import\r\ndrwxrwxrwx   8 ajr   raus       272 Mar  9  2011 Backup\r\ndrwxrwxrwx+  4 ajr   raus       136 Dec 11  2013 Caches\r\n 0: user:_spotlight allow list,search,file_inherit,directory_inherit\r\n 1: user:wlr allow list,add_file,search,delete,add_subdirectory,delete_child,file_inherit,directory_inherit\r\n 2: user:ajr allow list,add_file,search,delete,add_subdirectory,delete_child,file_inherit,directory_inherit\r\ndrwxrwxrwx+  4 ajr   raus       136 Jan 29  2014 Contents\r\n 0: user:_spotlight allow list,search,file_inherit,directory_inherit\r\n 1: user:wlr allow list,add_file,search,delete,add_subdirectory,delete_child,file_inherit,directory_inherit\r\n 2: user:ajr allow list,add_file,search,delete,add_subdirectory,delete_child,file_inherit,directory_inherit\r\nlrwxr-xr-x@  1 axel  raus        14 Jun  8  2009 Data -> ./Data.noindex\r\nlrwxr-xr-x@  1 axel  raus        12 Mar  8  2011 Data.noindex -> ./Thumbnails\r\ndrwxrwxrwx+ 32 ajr   raus      1088 Nov 19 15:04 Database\r\n 0: user:_spotlight allow list,search,file_inherit,directory_inherit\r\n 1: user:wlr allow list,add_file,search,delete,add_subdirectory,delete_child,file_inherit,directory_inherit\r\n 2: user:ajr allow list,add_file,search,delete,add_subdirectory,delete_child,file_inherit,directory_inherit\r\n-rw-rw-rw-@  1 ajr   raus       326 Nov 19 12:29 Info.plist\r\n 0: user:_spotlight allow read,execute\r\n 1: user:wlr allow read,write,execute,delete,append\r\n 2: user:ajr allow read,write,execute,delete,append\r\n-rw-rw-rw-+  1 ajr   raus        22 Mar  9  2011 Library.data\r\n 0: user:_spotlight allow read,execute\r\n 1: user:wlr allow read,write,execute,delete,append\r\n 2: user:ajr allow read,write,execute,delete,append\r\n-rw-rw-rw-+  1 ajr   raus        22 Mar  9  2011 Library.iPhoto\r\n 0: user:_spotlight allow read,execute\r\n 1: user:wlr allow read,write,execute,delete,append\r\n 2: user:ajr allow read,write,execute,delete,append\r\n-rw-rw-rw-+  1 ajr   raus        12 Mar  9  2011 Library6.iPhoto\r\n 0: user:_spotlight allow read,execute\r\n 1: user:wlr allow read,write,execute,delete,append\r\n 2: user:ajr allow read,write,execute,delete,append\r\ndrwxrwxrwx+ 18 ajr   raus       612 Jan  1  2015 Masters\r\n 0: user:_spotlight allow list,search,file_inherit,directory_inherit\r\n 1: user:wlr allow list,add_file,search,delete,add_subdirectory,delete_child,file_inherit,directory_inherit\r\n 2: user:ajr allow list,add_file,search,delete,add_subdirectory,delete_child,file_inherit,directory_inherit\r\nlrwxr-xr-x@  1 axel  raus        10 Mar  8  2011 Modified -> ./Previews\r\nlrwxr-xr-x@  1 axel  raus         9 Mar  8  2011 Originals -> ./Masters\r\ndrwxrwxrwx+ 18 ajr   raus       612 Jan  1  2015 Previews\r\n 0: user:_spotlight allow list,search,file_inherit,directory_inherit\r\n 1: user:wlr allow list,add_file,search,delete,add_subdirectory,delete_child,file_inherit,directory_inherit\r\n 2: user:ajr allow list,add_file,search,delete,add_subdirectory,delete_child,file_inherit,directory_inherit\r\ndrwxrwxrwx+  7 ajr   raus       238 Jul  7  2013 ProjectCache\r\n 0: user:_spotlight allow list,search,file_inherit,directory_inherit\r\n 1: user:wlr allow list,add_file,search,delete,add_subdirectory,delete_child,file_inherit,directory_inherit\r\n 2: user:ajr allow list,add_file,search,delete,add_subdirectory,delete_child,file_inherit,directory_inherit\r\n-rw-rw-rw-@  1 ajr   raus       341 Feb  1  2014 ProjectDBVersion.plist\r\n 0: user:_spotlight allow read,execute\r\n 1: user:wlr allow read,write,execute,delete,append\r\n 2: user:ajr allow read,write,execute,delete,append\r\n-rw-rw-rw-@  1 ajr   raus   1835008 Nov 19 15:04 Projects.db\r\n 0: user:_spotlight allow read,execute\r\n 1: user:wlr allow read,write,execute,delete,append\r\n 2: user:ajr allow read,write,execute,delete,append\r\n-rw-rw-rw-@  1 ajr   raus    176193 Apr 27  2011 ThemeCache\r\n 0: user:_spotlight allow read,execute\r\n 1: user:wlr allow read,write,execute,delete,append\r\n 2: user:ajr allow read,write,execute,delete,append\r\ndrwxrwxrwx+ 22 ajr   raus       748 Jan  1  2015 Thumbnails\r\n 0: user:_spotlight allow list,search,file_inherit,directory_inherit\r\n 1: user:wlr allow list,add_file,search,delete,add_subdirectory,delete_child,file_inherit,directory_inherit\r\n 2: user:ajr allow list,add_file,search,delete,add_subdirectory,delete_child,file_inherit,directory_inherit\r\n-rw-rw-rw-+  1 ajr   raus     59532 Dec 23  2013 com.apple.iPhoto.plist\r\n 0: user:_spotlight allow read,execute\r\n 1: user:wlr allow read,write,execute,delete,append\r\n 2: user:ajr allow read,write,execute,delete,append\r\ndrwxrwxrwx+  7 ajr   raus       238 Nov 19 12:32 iLifeShared\r\n 0: user:_spotlight allow list,search,file_inherit,directory_inherit\r\n 1: user:wlr allow list,add_file,search,delete,add_subdirectory,delete_child,file_inherit,directory_inherit\r\n 2: user:ajr allow list,add_file,search,delete,add_subdirectory,delete_child,file_inherit,directory_inherit\r\n-rw-rw-rw-+  1 ajr   raus        91 Apr 12  2013 iPhoto.ipspot"
    email: rabaxabel@gmail.com
    modified: "2015-11-19T18:25:10.52267Z"
    number: "23613139"
    number_intvalue: 23613139
    originated: "2015-11-19"
    parent_number: '&{NULL_VALUE}'
    product: Mac OS X / Photos
    product_version: 10.11.1  /  1.2 (340.4.0)
    reproducible: always
    resolved: ""
    status: Open
    title: Photos 1.2 (340.4.0) can't migrate an iPhoto archive from AFP share
