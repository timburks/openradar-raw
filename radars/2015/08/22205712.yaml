apiVersion: openapi/v1alpha1
kind: Radar
metadata:
    name: "22205712"
    labels:
        datastore_id: "6148971567251456"
data:
    classification: Crash/Hang/Data Loss
    created: "2015-08-09T19:36:38.3874Z"
    description: "Summary:\nI was astonished that this compiles, but subsequently bemused that it crashes while merging the module.\n\n\nSteps to Reproduce:\n1. A module compiled from code:\nprotocol P {\n\ttypealias T\n}\n\nenum E<F : P where F.T == E<F>> {\n\tindirect case Roll(F.T)\n}\n\n\nExpected Results:\nshould not crash swiftc\n\n\nActual Results:\nbut totally does:\n\nrob@Resonance ~/Desktop> swiftc -emit-module boom.swift; and ./boom\n0  swift                    0x0000000111967bbb llvm::sys::PrintStackTrace(__sFILE*) + 43\n1  swift                    0x00000001119682fb SignalHandler(int) + 379\n2  libsystem_platform.dylib 0x00007fff992d8eaa _sigtramp + 26\n3  libsystem_platform.dylib 000000000000000000 _sigtramp + 1725067632\n4  swift                    0x00000001100d539e swift::GenericParamList::addNestedArchetypes(swift::ArchetypeType*, llvm::SmallPtrSetImpl<swift::ArchetypeType*>&, llvm::SmallVectorImpl<swift::ArchetypeType*>&) + 30\n5  swift                    0x00000001100d5663 swift::GenericParamList::deriveAllArchetypes(llvm::ArrayRef<swift::GenericTypeParamDecl*>, llvm::SmallVectorImpl<swift::ArchetypeType*>&) + 355\n6  swift                    0x000000010fd11a21 swift::ModuleFile::maybeReadGenericParams(swift::DeclContext*, llvm::BitstreamCursor&, swift::GenericParamList*) + 561\n7  swift                    0x000000010fd0b86d swift::ModuleFile::getDecl(llvm::Fixnum<31u, unsigned int>, llvm::Optional<swift::DeclContext*>) + 14605\n8  swift                    0x000000010fd05d72 swift::ModuleFile::getType(llvm::Fixnum<31u, unsigned int>) + 3026\n9  swift                    0x000000010fd0795b swift::ModuleFile::getType(llvm::Fixnum<31u, unsigned int>) + 10171\n10 swift                    0x000000010fd0c70f swift::ModuleFile::getDecl(llvm::Fixnum<31u, unsigned int>, llvm::Optional<swift::DeclContext*>) + 18351\n11 swift                    0x000000010fd11ddd swift::ModuleFile::maybeReadGenericParams(swift::DeclContext*, llvm::BitstreamCursor&, swift::GenericParamList*) + 1517\n12 swift                    0x000000010fd0b86d swift::ModuleFile::getDecl(llvm::Fixnum<31u, unsigned int>, llvm::Optional<swift::DeclContext*>) + 14605\n13 swift                    0x000000010fd3771a swift::ModuleFile::getTopLevelDecls(llvm::SmallVectorImpl<swift::Decl*>&) + 666\n14 swift                    0x000000010fd4d7f8 swift::serialization::Serializer::writeAST(llvm::PointerUnion<swift::ModuleDecl*, swift::SourceFile*>) + 648\n15 swift                    0x000000010fd507a7 swift::serialization::Serializer::writeToStream(llvm::raw_ostream&, llvm::PointerUnion<swift::ModuleDecl*, swift::SourceFile*>, swift::SILModule const*, swift::SerializationOptions const&) + 135\n16 swift                    0x000000010fd51282 withOutputFile(swift::ASTContext&, llvm::StringRef, llvm::function_ref<void (llvm::raw_ostream&)>) + 226\n17 swift                    0x000000010fd510b5 swift::serialize(llvm::PointerUnion<swift::ModuleDecl*, swift::SourceFile*>, swift::SerializationOptions const&, swift::SILModule const*) + 149\n18 swift                    0x000000010f92b899 performCompile(swift::CompilerInstance&, swift::CompilerInvocation&, llvm::ArrayRef<char const*>, int&) + 13945\n19 swift                    0x000000010f927fc8 frontend_main(llvm::ArrayRef<char const*>, char const*, void*) + 2728\n20 swift                    0x000000010f92402f main + 2015\n21 libdyld.dylib            0x00007fff97a025ad start + 1\nStack dump:\n0.\tProgram arguments: /Applications/Xcode-beta.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/swift -frontend -emit-module /var/folders/9y/f7n4rvx901nctm_5d16c1wm40000gn/T/boom-b39a27.swiftmodule -parse-as-library -target x86_64-apple-darwin15.0.0 -enable-objc-interop -sdk /Applications/Xcode-beta.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.11.sdk -emit-module-doc-path boom.swiftdoc -color-diagnostics -module-name boom -o boom.swiftmodule \n1.\tWhile reading from /var/folders/9y/f7n4rvx901nctm_5d16c1wm40000gn/T/boom-b39a27.swiftmodule\n2.\tWhile deserializing decl #4 (ENUM_DECL)\n3.\tWhile deserializing 'F' (GenericTypeParamDecl #10) \n4.\tWhile deserializing decl #4 (ENUM_DECL)\n<unknown>:0: error: unable to execute command: Segmentation fault: 11\n<unknown>:0: error: merge-module command failed due to signal (use -v to see invocation)\n\n\nRegression:\nThis apparently compiles just fine if you donâ€™t put it in a module, i.e. if you omit the `-emit-modules` flag to swiftc.\n\n\nNotes:\nN/A"
    email: rix.rob@gmail.com
    modified: "2015-08-09T19:36:38.3877Z"
    number: "22205712"
    number_intvalue: 22205712
    originated: 09-Aug-2015 03:36 PM
    parent_number: '&{NULL_VALUE}'
    product: Developer Tools
    product_version: Xcode-beta (7A176x)
    reproducible: Always
    resolved: ""
    status: Open
    title: 'Swift 2b5: swiftc crash merging module using (apparently valid) recursive type constraint'
