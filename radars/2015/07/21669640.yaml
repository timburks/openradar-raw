apiVersion: openapi/v1alpha1
kind: Radar
metadata:
    name: "21669640"
    labels:
        datastore_id: "5092640634699776"
data:
    classification: Crash/Hang/Data Loss
    created: "2015-07-03T13:41:11.01397Z"
    description: "Summary:\r\nIn the attached example calling \"test()\" dynamically on the base class causes an EXC_BAD_ACCESS at runtime.\r\n\r\nIt worked fine in Swift 1.\r\n\r\nSteps to Reproduce:\r\n1. Copy the attached code into a Playground.\r\n2. Run the code in the playground.\r\n\r\n\r\nExpected Results:\r\nProgram should complete without any problems.\r\n\r\nActual Results:\r\nPlayground execution failed: Execution was interrupted, reason: EXC_BAD_ACCESS (code=1, address=0xfffffffffffffff8).\r\n* thread #1: tid = 0xb8cd, 0x0000000109cd5750 libswiftCore.dylib`swift_initEnumValueWitnessTableSinglePayload + 16, queue = 'com.apple.main-thread', stop reason = EXC_BAD_ACCESS (code=1, address=0xfffffffffffffff8)\r\n  * frame #0: 0x0000000109cd5750 libswiftCore.dylib`swift_initEnumValueWitnessTableSinglePayload + 16\r\n    frame #1: 0x0000000109c4c2fb libswiftCore.dylib`___lldb_unnamed_function447$$libswiftCore.dylib + 43\r\n    frame #2: 0x0000000109ccefa8 libswiftCore.dylib`(anonymous namespace)::GenericCacheEntry* llvm::function_ref<(anonymous namespace)::GenericCacheEntry* ()>::callback_fn<swift::swift_getGenericMetadata::$_0>(long) + 24\r\n    frame #3: 0x0000000109cceeb0 libswiftCore.dylib`MetadataCache<(anonymous namespace)::GenericCacheEntry>::addMetadataEntry(EntryRef<(anonymous namespace)::GenericCacheEntry>, ConcurrentList<MetadataCache<(anonymous namespace)::GenericCacheEntry>::EntryPair>&, llvm::function_ref<(anonymous namespace)::GenericCacheEntry* ()>) + 128\r\n    frame #4: 0x0000000109ccb698 libswiftCore.dylib`swift_getGenericMetadata + 504\r\n    frame #5: 0x0000000109ccb6e5 libswiftCore.dylib`swift_getGenericMetadata1 + 21\r\n    frame #6: 0x00000001123e67cb $__lldb_expr93`__lldb_expr_93.ChildClass.test <A where A: __lldb_expr_93.OtherBaseClass> (self=0x00000001123f2040)() -> Swift.Optional<A> + 187 at MyPlayground.playground:18\r\n    frame #7: 0x00000001123e61ff $__lldb_expr93`main + 511 at MyPlayground.playground:24\r\n    frame #8: 0x000000010789cc00 MyPlayground\r\n    frame #9: 0x00000001078a0301 MyPlayground`reabstraction thunk helper from @callee_owned () -> (@unowned ()) to @callee_owned (@in ()) -> (@out ()) + 17\r\n    frame #10: 0x000000010789f631 MyPlayground`partial apply forwarder for reabstraction thunk helper from @callee_owned () -> (@unowned ()) to @callee_owned (@in ()) -> (@out ()) + 81\r\n    frame #11: 0x00000001078a0330 MyPlayground`reabstraction thunk helper from @callee_owned (@in ()) -> (@out ()) to @callee_owned () -> (@unowned ()) + 32\r\n    frame #12: 0x00000001078a0367 MyPlayground`reabstraction thunk helper from @callee_owned () -> (@unowned ()) to @callee_unowned @convention(block) () -> (@unowned ()) + 39\r\n    frame #13: 0x0000000107eb976c CoreFoundation`__CFRUNLOOP_IS_CALLING_OUT_TO_A_BLOCK__ + 12\r\n    frame #14: 0x0000000107eaf2d5 CoreFoundation`__CFRunLoopDoBlocks + 341\r\n    frame #15: 0x0000000107eaea32 CoreFoundation`__CFRunLoopRun + 850\r\n    frame #16: 0x0000000107eae458 CoreFoundation`CFRunLoopRunSpecific + 488\r\n    frame #17: 0x000000010ea7cbca GraphicsServices`GSEventRunModal + 161\r\n    frame #18: 0x000000010833a1c2 UIKit`UIApplicationMain + 171\r\n    frame #19: 0x000000010789d049 MyPlayground`main + 1097\r\n    frame #20: 0x000000010ae1992d libdyld.dylib`start + 1\r\n\r\n\r\nAttached file:\r\n\r\nimport Foundation\r\n\r\npublic class OtherBaseClass {}\r\npublic class OtherChildClass: OtherBaseClass {}\r\n\r\n\r\nclass BaseClass {\r\n\r\n\tfunc test<T: OtherBaseClass>() -> T? {\r\n\t\tfatalError()\r\n\t}\r\n}\r\n\r\n\r\nfinal class ChildClass<T: OtherBaseClass> : BaseClass {\r\n\r\n\toverride func test() -> T? {\r\n\t\treturn nil\r\n\t}\r\n}\r\n\r\n\r\nlet instance: BaseClass = ChildClass<OtherChildClass>()\r\ninstance.test()"
    email: fluidsonic@gmail.com
    modified: "2015-07-03T13:41:52.9947Z"
    number: "21669640"
    number_intvalue: 21669640
    originated: "2015-07-03"
    parent_number: '&{NULL_VALUE}'
    product: Developer Tools
    product_version: Xcode 7 Beta 2
    reproducible: Always
    resolved: ""
    status: Open
    title: EXC_BAD_ACCESS at runtime when overriding a generic func with a non-generic func in a generic subclass
