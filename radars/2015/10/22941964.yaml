apiVersion: openapi/v1alpha1
kind: Radar
metadata:
    name: "22941964"
    labels:
        datastore_id: "5129432364744704"
data:
    classification: Enhancement
    created: "2015-10-01T22:25:15.79905Z"
    description: "Summary:\nN/A\n\nSteps to Reproduce:\nThis code:\nstruct A<B> {}\nprotocol C {\n\ttypealias D\n}\nenum E<F: C where F.D == E<F>.G> {\n\ttypealias G = A<F>\n}\n\n\nExpected Results:\nshouldn’t crash swiftc when using -emit-module\n\n\nActual Results:\nbut totally does:\n\nrob@Resonance ~/Desktop> swiftc -emit-module boom.swift\n0  swift                    0x000000010fba337b llvm::sys::PrintStackTrace(__sFILE*) + 43\n1  swift                    0x000000010fba3abb SignalHandler(int) + 379\n2  libsystem_platform.dylib 0x00007fff83cf752a _sigtramp + 26\n3  libsystem_platform.dylib 000000000000000000 _sigtramp + 2083556080\n4  swift                    0x000000010e323e9e swift::GenericParamList::addNestedArchetypes(swift::ArchetypeType*, llvm::SmallPtrSetImpl<swift::ArchetypeType*>&, llvm::SmallVectorImpl<swift::ArchetypeType*>&) + 30\n5  swift                    0x000000010e3240c3 swift::GenericParamList::deriveAllArchetypes(llvm::ArrayRef<swift::GenericTypeParamDecl*>, llvm::SmallVectorImpl<swift::ArchetypeType*>&) + 339\n6  swift                    0x000000010dfb8c21 swift::ModuleFile::maybeReadGenericParams(swift::DeclContext*, llvm::BitstreamCursor&, swift::GenericParamList*) + 513\n7  swift                    0x000000010dfb4306 swift::ModuleFile::getDecl(llvm::Fixnum<31u, unsigned int>, llvm::Optional<swift::DeclContext*>) + 11238\n8  swift                    0x000000010dfb888c swift::ModuleFile::getDeclContext(llvm::Fixnum<31u, unsigned int>) + 316\n9  swift                    0x000000010dfb48e8 swift::ModuleFile::getDecl(llvm::Fixnum<31u, unsigned int>, llvm::Optional<swift::DeclContext*>) + 12744\n10 swift                    0x000000010dfafd70 swift::ModuleFile::getType(llvm::Fixnum<31u, unsigned int>) + 416\n11 swift                    0x000000010dfb02a3 swift::ModuleFile::getType(llvm::Fixnum<31u, unsigned int>) + 1747\n12 swift                    0x000000010dfb141e swift::ModuleFile::getType(llvm::Fixnum<31u, unsigned int>) + 6222\n13 swift                    0x000000010dfb5329 swift::ModuleFile::getDecl(llvm::Fixnum<31u, unsigned int>, llvm::Optional<swift::DeclContext*>) + 15369\n14 swift                    0x000000010dfb8f19 swift::ModuleFile::maybeReadGenericParams(swift::DeclContext*, llvm::BitstreamCursor&, swift::GenericParamList*) + 1273\n15 swift                    0x000000010dfb4306 swift::ModuleFile::getDecl(llvm::Fixnum<31u, unsigned int>, llvm::Optional<swift::DeclContext*>) + 11238\n16 swift                    0x000000010dfd198b swift::ModuleFile::getTopLevelDecls(llvm::SmallVectorImpl<swift::Decl*>&) + 955\n17 swift                    0x000000010dffb246 swift::serialization::Serializer::writeAST(llvm::PointerUnion<swift::ModuleDecl*, swift::SourceFile*>) + 646\n18 swift                    0x000000010dffdf87 swift::serialization::Serializer::writeToStream(llvm::raw_ostream&, llvm::PointerUnion<swift::ModuleDecl*, swift::SourceFile*>, swift::SILModule const*, swift::SerializationOptions const&) + 135\n19 swift                    0x000000010dffebb2 withOutputFile(swift::ASTContext&, llvm::StringRef, llvm::function_ref<void (llvm::raw_ostream&)>) + 226\n20 swift                    0x000000010dffea36 swift::serialize(llvm::PointerUnion<swift::ModuleDecl*, swift::SourceFile*>, swift::SerializationOptions const&, swift::SILModule const*) + 214\n21 swift                    0x000000010dc97828 performCompile(swift::CompilerInstance&, swift::CompilerInvocation&, llvm::ArrayRef<char const*>, int&) + 12840\n22 swift                    0x000000010dc943f3 frontend_main(llvm::ArrayRef<char const*>, char const*, void*) + 2691\n23 swift                    0x000000010dc90a74 main + 2324\n24 libdyld.dylib            0x00007fff937c85ad start + 1\nStack dump:\n0.\tProgram arguments: /Applications/Xcode-beta.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/swift -frontend -emit-module /var/folders/9y/f7n4rvx901nctm_5d16c1wm40000gn/T/boom-94824a.swiftmodule -parse-as-library -target x86_64-apple-darwin15.0.0 -enable-objc-interop -sdk /Applications/Xcode-beta.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.11.sdk -emit-module-doc-path boom.swiftdoc -color-diagnostics -module-name boom -o boom.swiftmodule \n1.\tWhile reading from /var/folders/9y/f7n4rvx901nctm_5d16c1wm40000gn/T/boom-94824a.swiftmodule\n2.\tWhile deserializing decl #5 (ENUM_DECL)\n3.\tWhile deserializing 'F' (GenericTypeParamDecl #13) \n4.\tWhile deserializing decl #14 (TYPE_ALIAS_DECL)\n5.\tWhile deserializing decl #5 (ENUM_DECL)\n<unknown>:0: error: unable to execute command: Segmentation fault: 11\n<unknown>:0: error: merge-module command failed due to signal (use -v to see invocation)\n\n\nRegression:\nswiftc doesn’t crash if you omit -emit-module.\n\n\nNotes:\nN/A"
    email: rix.rob@gmail.com
    modified: "2015-10-01T22:25:15.79921Z"
    number: "22941964"
    number_intvalue: 22941964
    originated: 01-Oct-2015 06:24 PM
    parent_number: '&{NULL_VALUE}'
    product: Developer Tools
    product_version: Xcode 7.0 (7A1001)
    reproducible: Always
    resolved: ""
    status: Open
    title: 'Swift: swiftc crash emitting module with type constraint using typealias in constrained type'
