apiVersion: openapi/v1alpha1
kind: Radar
metadata:
    name: "23344942"
    labels:
        datastore_id: "6747068848668672"
data:
    classification: Crash/Hang/Data Loss
    created: "2015-10-31T12:58:31.28028Z"
    description: "Summary:\nWe’re getting a ton of crashes on cloudkit, which disrupts our Jenkins setup. It seems that the sql file can’t be opened and the cloud daemon logic is unable to deal with that. Seems like an easy fix, please correct that in 10.11.2.\n\nCRASH REPORT: cloudd_2015-10-31-040733_macmini01.crash\n\nProcess:               cloudd [25513]\nPath:                  /System/Library/PrivateFrameworks/CloudKitDaemon.framework/Support/cloudd\nIdentifier:            cloudd\nVersion:               480 (480)\nCode Type:             X86-64 (Native)\nParent Process:        ??? [1]\nResponsible:           cloudd [25513]\nUser ID:               501\n\nDate/Time:             2015-10-31 04:07:33.554 -0700\nOS Version:            Mac OS X 10.11.1 (15B42)\nReport Version:        11\nAnonymous UUID:        5085A387-71DD-7652-9499-4824A206623C\n\n\nTime Awake Since Boot: 770000 seconds\n\nSystem Integrity Protection: enabled\n\nCrashed Thread:        0  Dispatch queue: com.apple.cloudkit.systemAvailabilityQueue\n\nException Type:        EXC_CRASH (SIGABRT)\nException Codes:       0x0000000000000000, 0x0000000000000000\nException Note:        EXC_CORPSE_NOTIFY\n\nApplication Specific Information:\n*** Terminating app due to uncaught exception 'NSGenericException', reason: 'Error executing SQL: \"VACUUM\" (14) - errcode:000e, msg:\"unable to open database file\", size: 57344, path:/Users/USER/Library/Caches/*/CloudKitMetadata, fs:232690003968/248822890496'\nabort() called\nterminating with uncaught exception of type NSException\n\nApplication Specific Backtrace 1:\n0   CoreFoundation                      0x00007fff9b172e32 __exceptionPreprocess + 178\n1   libobjc.A.dylib                     0x00007fff9475ddd4 objc_exception_throw + 48\n2   CoreFoundation                      0x00007fff9b1d965d +[NSException raise:format:] + 205\n3   CloudKit                            0x00007fff9bbe5668 +[CKSQLiteError raise:code:extended:] + 1618\n4   CloudKit                            0x00007fff9bbe1c47 -[CKSQLite raise:] + 1055\n5   CloudKit                            0x00007fff9bbe1efd -[CKSQLite executeSQL:arguments:] + 285\n6   CloudKit                            0x00007fff9bbe1dcb -[CKSQLite executeSQL:] + 142\n7   CloudKit                            0x00007fff9bbe08b9 -[CKSQLite _periodicVacuum] + 304\n8   CloudKit                            0x00007fff9bbe1192 -[CKSQLite openWithError:] + 2127\n9   CloudKit                            0x00007fff9bbe12c3 -[CKSQLite open] + 42\n10  CloudKitDaemon                      0x00007fff9361fcb5 -[CKDMetadataCache init] + 262\n11  CloudKitDaemon                      0x00007fff9361fb76 __31+[CKDMetadataCache sharedCache]_block_invoke + 41\n12  libdispatch.dylib                   0x00007fff9db913c3 _dispatch_client_callout + 8\n13  libdispatch.dylib                   0x00007fff9db912bb dispatch_once_f + 67\n14  CloudKitDaemon                      0x00007fff9361fb4b +[CKDMetadataCache sharedCache] + 46\n15  cloudd                              0x000000010744a658 cloudd + 9816\n16  CloudKitDaemon                      0x00007fff934d390c __52-[CKDSystemAvailabilityMonitor _systemMayNowBeReady]_block_invoke + 213\n17  libdispatch.dylib                   0x00007fff9db913c3 _dispatch_client_callout + 8\n18  libdispatch.dylib                   0x00007fff9db929aa _dispatch_barrier_sync_f_invoke + 74\n19  CloudKitDaemon                      0x00007fff934d3786 -[CKDSystemAvailabilityMonitor _systemMayNowBeReady] + 276\n20  CloudKitDaemon                      0x00007fff934d3294 -[CKDSystemAvailabilityMonitor _init] + 161\n21  CloudKitDaemon                      0x00007fff934d3192 __45+[CKDSystemAvailabilityMonitor sharedMonitor]_block_invoke + 41\n22  libdispatch.dylib                   0x00007fff9db913c3 _dispatch_client_callout + 8\n23  libdispatch.dylib                   0x00007fff9db912bb dispatch_once_f + 67\n24  CloudKitDaemon                      0x00007fff934d3167 +[CKDSystemAvailabilityMonitor sharedMonitor] + 46\n25  cloudd                              0x00000001074498fa cloudd + 6394\n26  cloudd                              0x000000010744a39e cloudd + 9118\n27  libdyld.dylib                       0x00007fff93ec15ad start + 1\n\nGlobal Trace Buffer (reverse chronological seconds):\n18446744032.830784 libsystem_trace.dylib     \t0x00007fff92d9b102 dyld_image_header_containing_address(0x7ffcda001540) failed\n18446744032.830917 libsystem_trace.dylib     \t0x00007fff92d9b102 dyld_image_header_containing_address(0x7ffcd8605770) failed\n18446744032.831055 libsystem_trace.dylib     \t0x00007fff92d9b102 dyld_image_header_containing_address(0x7ffcd8703d70) failed\n18446744032.831127 libsystem_trace.dylib     \t0x00007fff92d9b102 dyld_image_header_containing_address(0x7ffcda100230) failed\n18446744032.831184 libsystem_trace.dylib     \t0x00007fff92d9b102 dyld_image_header_containing_address(0x7ffcda200290) failed\n18446744032.831268 libsystem_trace.dylib     \t0x00007fff92d9b102 dyld_image_header_containing_address(0x7ffcd8523e20) failed\n18446744032.831322 libsystem_trace.dylib     \t0x00007fff92d9b102 dyld_image_header_containing_address(0x7ffcd86050a0) failed\n18446744032.831409 libsystem_trace.dylib     \t0x00007fff92d9b102 dyld_image_header_containing_address(0x7ffcda100230) failed\n18446744032.831505 libsystem_trace.dylib     \t0x00007fff92d9b102 dyld_image_header_containing_address(0x7ffcd8605720) failed\n18446744032.831573 libsystem_trace.dylib     \t0x00007fff92d9b102 dyld_image_header_containing_address(0x7ffcd8605720) failed\n18446744032.831638 libsystem_trace.dylib     \t0x00007fff92d9b102 dyld_image_header_containing_address(0x7ffcd8605620) failed\n18446744032.831680 libsystem_trace.dylib     \t0x00007fff92d9b102 dyld_image_header_containing_address(0x7ffcd8605620) failed\n18446744032.831711 libsystem_trace.dylib     \t0x00007fff92d9b102 dyld_image_header_containing_address(0x7ffcd86055e0) failed\n18446744032.831768 libsystem_trace.dylib     \t0x00007fff92d9b102 dyld_image_header_containing_address(0x7ffcd86055e0) failed\n18446744032.831829 libsystem_trace.dylib     \t0x00007fff92d9b102 dyld_image_header_containing_address(0x7ffcd8604ee0) failed\n18446744032.834061 libsystem_trace.dylib     \t0x00007fff92d9b102 dyld_image_header_containing_address(0x7ffcd86049f0) failed\n18446744032.834377 libsystem_trace.dylib     \t0x00007fff92d9b102 dyld_image_header_containing_address(0x7ffcd8604390) failed\n18446744032.834431 libsystem_trace.dylib     \t0x00007fff92d9b102 dyld_image_header_containing_address(0x7ffcd8523bd0) failed\n18446744032.834751 libsystem_trace.dylib     \t0x00007fff92d9b102 dyld_image_header_containing_address(0x7ffcd85233e0) failed\n18446744032.834919 libsystem_trace.dylib     \t0x00007fff92d9b102 dyld_image_header_containing_address(0x7ffcd86040a0) failed\n\nThread 0 Crashed:: Dispatch queue: com.apple.cloudkit.systemAvailabilityQueue\n0   libsystem_kernel.dylib        \t0x00007fff931fb0ae __pthread_kill + 10\n1   libsystem_pthread.dylib       \t0x00007fff92869500 pthread_kill + 90\n2   libsystem_c.dylib             \t0x00007fff97cf337b abort + 129\n3   libc++abi.dylib               \t0x00007fff9c980f81 abort_message + 257\n4   libc++abi.dylib               \t0x00007fff9c9a6a47 default_terminate_handler() + 267\n5   libobjc.A.dylib               \t0x00007fff9476108d _objc_terminate() + 103\n6   libc++abi.dylib               \t0x00007fff9c9a419e std::__terminate(void (*)()) + 8\n7   libc++abi.dylib               \t0x00007fff9c9a4213 std::terminate() + 51\n8   libdispatch.dylib             \t0x00007fff9db913d7 _dispatch_client_callout + 28\n9   libdispatch.dylib             \t0x00007fff9db912bb dispatch_once_f + 67\n10  com.apple.cloudkit.CloudKitDaemon\t0x00007fff9361fb4b +[CKDMetadataCache sharedCache] + 46\n11  cloudd                        \t0x000000010744a658 0x107448000 + 9816\n12  com.apple.cloudkit.CloudKitDaemon\t0x00007fff934d390c __52-[CKDSystemAvailabilityMonitor _systemMayNowBeReady]_block_invoke + 213\n13  libdispatch.dylib             \t0x00007fff9db913c3 _dispatch_client_callout + 8\n14  libdispatch.dylib             \t0x00007fff9db929aa _dispatch_barrier_sync_f_invoke + 74\n15  com.apple.cloudkit.CloudKitDaemon\t0x00007fff934d3786 -[CKDSystemAvailabilityMonitor _systemMayNowBeReady] + 276\n16  com.apple.cloudkit.CloudKitDaemon\t0x00007fff934d3294 -[CKDSystemAvailabilityMonitor _init] + 161\n17  com.apple.cloudkit.CloudKitDaemon\t0x00007fff934d3192 __45+[CKDSystemAvailabilityMonitor sharedMonitor]_block_invoke + 41\n18  libdispatch.dylib             \t0x00007fff9db913c3 _dispatch_client_callout + 8\n19  libdispatch.dylib             \t0x00007fff9db912bb dispatch_once_f + 67\n20  com.apple.cloudkit.CloudKitDaemon\t0x00007fff934d3167 +[CKDSystemAvailabilityMonitor sharedMonitor] + 46\n21  cloudd                        \t0x00000001074498fa 0x107448000 + 6394\n22  cloudd                        \t0x000000010744a39e 0x107448000 + 9118\n23  libdyld.dylib                 \t0x00007fff93ec15ad start + 1\n\nThread 1:\n0   libsystem_kernel.dylib        \t0x00007fff931fb78a __workq_kernreturn + 10\n1   libsystem_pthread.dylib       \t0x00007fff9286658c _pthread_wqthread + 1283\n2   libsystem_pthread.dylib       \t0x00007fff92864375 start_wqthread + 13\n\nThread 2:: Dispatch queue: com.apple.libdispatch-manager\n0   libsystem_kernel.dylib        \t0x00007fff931fc0a2 kevent_qos + 10\n1   libdispatch.dylib             \t0x00007fff9db9711d _dispatch_mgr_invoke + 216\n2   libdispatch.dylib             \t0x00007fff9db96d85 _dispatch_mgr_thread + 52\n\nThread 3:\n0   libsystem_kernel.dylib        \t0x00007fff931fb78a __workq_kernreturn + 10\n1   libsystem_pthread.dylib       \t0x00007fff9286658c _pthread_wqthread + 1283\n2   libsystem_pthread.dylib       \t0x00007fff92864375 start_wqthread + 13\n\nThread 4:\n0   libsystem_kernel.dylib        \t0x00007fff931fb78a __workq_kernreturn + 10\n1   libsystem_pthread.dylib       \t0x00007fff9286658c _pthread_wqthread + 1283\n2   libsystem_pthread.dylib       \t0x00007fff92864375 start_wqthread + 13\n\nThread 0 crashed with X86 Thread State (64-bit):\n  rax: 0x0000000000000000  rbx: 0x0000000000000006  rcx: 0x00007fff587b7248  rdx: 0x0000000000000000\n  rdi: 0x000000000000160b  rsi: 0x0000000000000006  rbp: 0x00007fff587b7270  rsp: 0x00007fff587b7248\n   r8: 0x0000000000000003   r9: 0x00007fff9c9a7a7c  r10: 0x0000000008000000  r11: 0x0000000000000206\n  r12: 0x00007fff587b73d0  r13: 0x00007ffcd8518530  r14: 0x00007fff7c640000  r15: 0x00007fff587b72b0\n  rip: 0x00007fff931fb0ae  rfl: 0x0000000000000206  cr2: 0x00007fff7d1c5038\n  \nLogical CPU:     0\nError Code:      0x02000148\nTrap Number:     133"
    email: steipete@gmail.com
    modified: "2015-10-31T12:58:31.2807Z"
    number: "23344942"
    number_intvalue: 23344942
    originated: 31-Oct-2015 01:58 PM
    parent_number: '&{NULL_VALUE}'
    product: OS X
    product_version: 10.11.1
    reproducible: Always
    resolved: ""
    status: Open
    title: CloudKitDaemon constantly crashing, unable to vaccuum CloudKitMetadata
