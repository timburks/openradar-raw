apiVersion: openapi/v1alpha1
kind: Radar
metadata:
    name: "23141714"
    labels:
        datastore_id: "4509607783301120"
data:
    classification: Crash
    created: "2015-10-16T09:31:49.22441Z"
    description: "Since iOS8 ABPeoplePickerNavigationController does not require us to ask the user's permission when picking a contact. However, when the selecting contact that is linked with another contacts it crashes.\r\n\r\nThis is a major bug. For selecting simple contact it would be overkill to ask for access to all Contacts if it is just for selecting single contact.\r\n\r\nSteps to Reproduce:\r\n1) Create linked contact in the Contacts.app\r\n\r\n2) Run attached app on iOS 9, tap [Select from Contacts] button\r\n\r\n3) Select contact that is linked with another contact\r\n\r\nExpected Results:\r\nAfter selecting contact app should NSLog contact details in the console.\r\n\r\nActual Results:\r\nTrace: (from device):\r\n2015-10-16 12:24:49.771 bug[2631:2725986] *** Terminating app due to uncaught exception 'NSInternalInconsistencyException', reason: 'A contact and its snapshot should both be non-unified.'\r\n*** First throw call stack:\r\n(0x182a78f5c 0x19757ff80 0x182a78ea4 0x18249fe64 0x18249fa8c 0x1824dbf68 0x1824a98a8 0x1819971b4 0x1825273b4 0x1825a90e8 0x1825a98c4 0x100159d70 0x100159d30 0x10015f780 0x182a30258 0x182a2e0c0 0x18295cdc0 0x18dab0088 0x188036f44 0x1000f8578 0x197daa8b8)\r\nlibc++abi.dylib: terminating with uncaught exception of type NSException\r\n\r\nTrace (from simulator):\r\n2015-10-16 12:07:55.382 bug[85436:1568705] *** Terminating app due to uncaught exception 'NSInternalInconsistencyException', reason: 'A contact and its snapshot should both be non-unified.'\r\n*** First throw call stack:\r\n(\r\n\t0   CoreFoundation                      0x00cfca94 __exceptionPreprocess + 180\r\n\t1   libobjc.A.dylib                     0x00559e02 objc_exception_throw + 50\r\n\t2   CoreFoundation                      0x00cfc9bd +[NSException raise:format:] + 141\r\n\t3   Contacts                            0x051f9deb +[CNCalculatesContactDiff addMultiValueUpdateTo:forProperty:contact1:contact2:] + 626\r\n\t4   Contacts                            0x051f99b6 +[CNCalculatesContactDiff diffContact:to:] + 669\r\n\t5   Contacts                            0x0523eb12 +[CNContactDiff diffContact:to:] + 52\r\n\t6   Contacts                            0x05204f5b -[CNContact(iOSABCompatibility) detachedPerson] + 61\r\n\t7   AddressBookUI                       0x00a0dbde -[CNContact(ABCompatibility) recordFromAddressBook:] + 137\r\n\t8   AddressBookUI                       0x00a536e7 -[ABPeoplePickerNavigationController contactPicker:didSelectContact:] + 154\r\n\t9   ContactsUI                          0x0532273b -[CNContactPickerViewController pickerDidSelectContact:property:] + 324\r\n\t10  ContactsUI                          0x053b6c73 -[CNContactPickerHostViewController pickerDidSelectContact:property:] + 102\r\n\t11  ContactsUI                          0x053b7528 __71-[CNContactPickerExtensionHostContext pickerDidSelectContact:property:]_block_invoke + 81\r\n\t12  libdispatch.dylib                   0x0326a3ff _dispatch_call_block_and_release + 15\r\n\t13  libdispatch.dylib                   0x0328d9cd _dispatch_client_callout + 14\r\n\t14  libdispatch.dylib                   0x03273018 _dispatch_main_queue_callback_4CF + 910\r\n\t15  CoreFoundation                      0x00c4e70e __CFRUNLOOP_IS_SERVICING_THE_MAIN_DISPATCH_QUEUE__ + 14\r\n\t16  CoreFoundation                      0x00c0c454 __CFRunLoopRun + 2356\r\n\t17  CoreFoundation                      0x00c0b866 CFRunLoopRunSpecific + 470\r\n\t18  CoreFoundation                      0x00c0b67b CFRunLoopRunInMode + 123\r\n\t19  GraphicsServices                    0x0429f664 GSEventRunModal + 192\r\n\t20  GraphicsServices                    0x0429f4a1 GSEventRun + 104\r\n\t21  UIKit                               0x0108bcc1 UIApplicationMain + 160\r\n\t22  bug                                 0x00084cda main + 138\r\n\t23  libdyld.dylib                       0x032b7a21 start + 1\r\n)\r\nlibc++abi.dylib: terminating with uncaught exception of type NSException\r\n\r\n\r\nVersion:\r\niOS 9.0.2 (13A452)\r\n\r\nNotes:\r\nRelated radars:\r\nrdar://23006507\r\n\r\nConfiguration:\r\niPhone 5S 64G\r\n\r\nAttachments:\r\n'bug.zip' was successfully uploaded."
    email: jkirsakmens@gmail.com
    modified: "2016-03-22T11:17:37.86155Z"
    number: "23141714"
    number_intvalue: 23141714
    originated: 16-Oct-2015
    parent_number: '&{NULL_VALUE}'
    product: iOS
    product_version: 9.0.2
    reproducible: Always
    resolved: ""
    status: Closed as duplicate
    title: ABPeoplePickerNavigationController crashes on iOS9 (on selecting linked contact)
