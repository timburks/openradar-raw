apiVersion: openapi/v1alpha1
kind: Radar
metadata:
    name: "21376523"
    labels:
        datastore_id: "4898188943163392"
data:
    classification: Serious Bug
    created: "2015-06-18T18:15:48.14873Z"
    description: "------------------\r\nSummary:\r\n------------------\r\n\r\nWhen using Swift 2 with Xcode 7 beta-1 (7A120f), with SceneKit for iOS, using SCNVector3 produces \"Abort trap: 6\" compile error. This happens whether a project is migrated from (Swift 1.2 + Xcode 6.3) to (Swift 2 + Xcode 7.0), or with a fresh Swift 2 + Xcode 7.0 project. Error text is below:\r\n\r\n[COMMAND LINE COMPILER OPTIONS OMITTED BECAUSE OF 3,000 WORD BUG REPORT LIMIT]\r\n\r\nAssertion failed: ((IGF.IGM.DataLayout.getTypeSizeInBits(coercionTy) == IGF.IGM.DataLayout.getTypeSizeInBits(paramTI.StorageType)) && \"Coerced types should not differ in size!\"), function emitDirectExternalParameter, file /Library/Caches/com.apple.xbs/Sources/swiftlang/swiftlang-700.0.38.1/src/swift/lib/IRGen/IRGenSIL.cpp, line 908.\r\n0  swift                    0x000000010c9cae0b llvm::sys::PrintStackTrace(__sFILE*) + 43\r\n1  swift                    0x000000010c9cb54b SignalHandler(int) + 379\r\n2  libsystem_platform.dylib 0x00007fff9030cf1a _sigtramp + 26\r\n3  libsystem_platform.dylib 0x0000000000000007 _sigtramp + 1875849479\r\n4  libsystem_c.dylib        0x00007fff900cab53 abort + 129\r\n5  libsystem_c.dylib        0x00007fff90092c39 basename + 0\r\n6  swift                    0x000000010ab1269d (anonymous namespace)::IRGenSILFunction::emitSILFunction() + 13693\r\n7  swift                    0x000000010ab0ed52 swift::irgen::IRGenModule::emitSILFunction(swift::SILFunction*) + 498\r\n8  swift                    0x000000010aa5f46c swift::irgen::IRGenModuleDispatcher::emitGlobalTopLevel() + 412\r\n9  swift                    0x000000010aaf5515 performIRGeneration(swift::IRGenOptions&, swift::ModuleDecl*, swift::SILModule*, llvm::StringRef, llvm::LLVMContext&, swift::SourceFile*, unsigned int) + 821\r\n10 swift                    0x000000010aaf5926 swift::performIRGeneration(swift::IRGenOptions&, swift::SourceFile&, swift::SILModule*, llvm::StringRef, llvm::LLVMContext&, unsigned int) + 70\r\n11 swift                    0x000000010a9e505f performCompile(swift::CompilerInstance&, swift::CompilerInvocation&, llvm::ArrayRef<char const*>, int&) + 11663\r\n12 swift                    0x000000010a9e20b3 frontend_main(llvm::ArrayRef<char const*>, char const*, void*) + 2515\r\n13 swift                    0x000000010a9de28f main + 1983\r\n14 libdyld.dylib            0x00007fff92d4d5c9 start + 1\r\nStack dump:\r\n\r\n[0. PROGRAM ARGUMENTS OMITTED BECAUSE OF 3,000 WORD BUG REPORT LIMIT]\r\n\r\n1.\tWhile emitting IR SIL function @_TToFC18AbortTrapTestSwift18GameViewControllers1pVSC10SCNVector3 for 'p' at /Users/bstahl/Library/Mobile Documents/com~apple~CloudDocs/Developer/Code/AbortTrapTestSwift/AbortTrapTestSwift/GameViewController.swift:14:6\r\n\r\n------------------\r\nSteps to Reproduce:\r\n------------------\r\n\r\nSetup: Install Xcode 7.0 (7A120f). Check for current SDKs and documentation in Preferences and install.\r\n\r\n1. Create a brand-new project in Xcode 7 beta-1. Type is \"iOS>Application>Game\", Language is \"Swift\", Game Technology is \"SceneKit\".\r\n \r\n2. Build and run with default settings. Project builds and runs fine in simulator (you will see the default rotating 3D spaceship model).\r\n \r\n3. Add a single SCNVector3 property to the gamecontroller in GameViewController.swift, like this:\r\n \r\nclass GameViewController: UIViewController {  \r\n  var p = SCNVector3Zero  \r\n \r\n--> Produces \"Abort trap: 6\". Project will no longer compile.\r\n \r\n4. Change the constant to an empty initializer.\r\n \r\nclass GameViewController: UIViewController {  \r\n  var p = SCNVector3()  \r\n \r\n--> Same problem, \"Abort trap: 6\"\r\n \r\n5. Remove property, restoring to the clean project state.\r\n\r\n--> \"Abort trap: 6\" is gone, project again compiles and runs.\r\n \r\n6. Change \"var\" to \"let\".\r\n \r\nclass GameViewController: UIViewController {  \r\n  let p = SCNVector4Zero\r\n  \r\n-- > Compiles and runs.\r\n\r\n7. Change property type to SCNVector4 instead of SCNVector3.\r\n \r\nclass GameViewController: UIViewController {  \r\n  var p = SCNVector4Zero\r\n  \r\n-- > Compiles and runs.\r\n\r\n------------------\r\nExpected Results:\r\n------------------\r\n\r\nProject should compile and run. Before adding SCNVector3 property, project already runs, therefore it should already be using SceneKit and its associated type.\r\n\r\n------------------\r\nActual Results:\r\n------------------\r\n\r\nProject will not compile and exits with \"Abort trap: 6\" error. There are no suggestions for fixing the problem.\r\n\r\n------------------\r\nVersion:\r\n------------------\r\n\r\nXcode: 7.0 beta (7A120f)\r\nOS X: 10.10.3 (14D136)\r\n\r\n------------------\r\nNotes:\r\n------------------\r\n\r\nBug DOES NOT occur if:\r\n- property \"var\" is changed to \"let\".\r\n- property type is changed from SCNVector3 type to SCNVector4 type (\"var\" or \"let\").\r\n- property declaration is removed from project.\r\n- project is created and compiled under Swift 1.2 in Xcode 6.3.X\r\n\r\nBug STILL occurs if:\r\n- property uses an initializer instead of SCNVector3Zero (\"var p = SCNVector3()\").\r\n\r\n------------------\r\nConfiguration:\r\n------------------\r\n\r\nMid-2011 13\" MacBook Air, 1.8 GHz Intel Core i7, 4 GB RAM, 256 GB SSD\r\nModel Identifier: MacBookAir4,2\r\nSMC Version (system): 1.73f66\r\nBoot ROM Version: MBA41.0077.B11\r\n\r\nOS X Yosemite 10.10.3 (14D136)\r\n\r\n------------------\r\nAttachments:\r\n------------------\r\n\r\n'AbortTrapTestSwift.zip' was successfully uploaded."
    email: bendstahl@gmail.com
    modified: "2015-06-19T23:39:20.2904Z"
    number: "21376523"
    number_intvalue: 21376523
    originated: "2015-06-14"
    parent_number: '&{NULL_VALUE}'
    product: Xcode
    product_version: "7.0"
    reproducible: Yes
    resolved: ""
    status: Closed (Duplicate of 21294916)
    title: 'Adding property of type SCNVector3 yields "Abort trap: 6" error'
