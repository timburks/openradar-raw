apiVersion: openapi/v1alpha1
kind: Radar
metadata:
    name: "7493918"
    labels:
        datastore_id: "5054647072980992"
data:
    classification: ""
    created: "2019-12-14T19:08:04.566263Z"
    description: "1) Create a simple iOS app that displays a WKWebView and load html that draws an input box and a button, for example.\r\n2) Create an XCUITest that attempts to type test in the text field and push the button\r\n3) Run the test in simulator against the previous iOS release (e.g., 13.2.2) - test passes\r\n4) Run the test in simulator against the latest iOS release (e.g., 13.3) - test fails\r\n\r\nIt appears by querying in the debugger via `po app` that UI elements that used to be visible to the XCTUITest are no longer visible.\r\n\r\nI’ve attached a bare-bones example Xcode project to illustrate. I first noticed my tests failing upon updating Xcode to 11.3. When I run Xcode 11.2.1 which uses a simulator with the earlier version, the tests pass.\r\n\r\nIn the `po app` output, notice that the TextField and Button are visible in iOS 13.2.2, but not 13.3.\r\n\r\nHere is `po app` output in 11.2.2:\r\n(lldb) po app\r\n    t =    16.33s Requesting snapshot of accessibility hierarchy for app with pid 52998\r\n    t =    16.70s Requesting snapshot of accessibility hierarchy for app with pid 52998\r\nAttributes: Application, pid: 52998, label: 'WebViewElementsRegression'\r\nElement subtree:\r\n →Application, 0x600000386920, pid: 52998, label: 'WebViewElementsRegression'\r\n    Window (Main), 0x600000386840, {{0.0, 0.0}, {414.0, 896.0}}\r\n      Other, 0x600000386760, {{0.0, 0.0}, {414.0, 896.0}}\r\n        Other, 0x600000386680, {{0.0, 0.0}, {414.0, 896.0}}\r\n          Other, 0x6000003865a0, {{0.0, 0.0}, {414.0, 896.0}}\r\n            WebView, 0x6000003864c0, {{0.0, 0.0}, {414.0, 896.0}}\r\n              WebView, 0x6000003863e0, {{0.0, 0.0}, {414.0, 896.0}}\r\n                WebView, 0x600000386300, {{0.0, 0.0}, {414.0, 896.0}}\r\n                  RemotePlaceholder, 0x600000386220, pid: 52998, {{0.0, 0.0}, {414.0, 896.0}}\r\n                    Other, 0x600000386140, {{0.0, 0.0}, {414.0, 896.0}}\r\n                      Other, 0x60000039c1c0, {{0.0, 44.0}, {175.0, 379.0}}\r\n                        Other, 0x6000003880e0, {{0.0, 44.0}, {415.0, 818.0}}\r\n                          Other, 0x6000003881c0, {{122.0, 44.0}, {170.0, 9.0}}\r\n                            StaticText, 0x600000394380, {{173.0, 44.0}, {68.0, 9.0}}, label: 'Web View Step Example', value: Web View Step Exam...\r\n                          Other, 0x6000003882a0, {{122.0, 52.0}, {170.0, 55.0}}\r\n                            TextField, 0x600000388380, {{122.0, 56.0}, {170.0, 19.0}}, value: ￼\r\n                            Button, 0x600000386060, {{177.0, 87.0}, {60.0, 19.0}}, label: 'Continue'\r\n                Other, 0x600000385f80, {{381.0, 34.5}, {30.0, 826.5}}, label: 'Vertical scroll bar, 1 page', value: 0%\r\n                Other, 0x600000385ea0, {{35.0, 863.0}, {344.0, 30.0}}, label: 'Horizontal scroll bar, 1 page', value: 0%\r\n    Window, 0x600000385dc0, {{0.0, 0.0}, {414.0, 896.0}}\r\n      Other, 0x600000385ce0, {{0.0, 0.0}, {414.0, 896.0}}\r\n        Other, 0x600000385c00, {{0.0, 0.0}, {414.0, 896.0}}\r\nPath to element:\r\n →Application, 0x600000386920, pid: 52998, label: 'WebViewElementsRegression'\r\nQuery chain:\r\n →Find: Target Application 'com.careevolution.WebViewElementsRegression'\r\n  Output: {\r\n    Application, pid: 52998, label: 'WebViewElementsRegression'\r\n  }\r\n\r\nHere is `po app` output in 11.3:\r\n(lldb) po app\r\n    t =     7.80s Requesting snapshot of accessibility hierarchy for app with pid 53270\r\n    t =    12.84s Requesting snapshot of accessibility hierarchy for app with pid 53270\r\nAttributes: Application, pid: 53270, label: 'WebViewElementsRegression'\r\nElement subtree:\r\n →Application, 0x6000016e87e0, pid: 53270, label: 'WebViewElementsRegression'\r\n    Window (Main), 0x6000016e8700, {{0.0, 0.0}, {414.0, 896.0}}\r\n      Other, 0x6000016e8620, {{0.0, 0.0}, {414.0, 896.0}}\r\n        Other, 0x6000016e8380, {{0.0, 0.0}, {414.0, 896.0}}\r\n          Other, 0x6000016ebd40, {{0.0, 0.0}, {414.0, 896.0}}\r\n            WebView, 0x6000016ebc60, {{0.0, 0.0}, {414.0, 896.0}}\r\n              WebView, 0x6000016ebb80, {{0.0, 0.0}, {414.0, 896.0}}\r\n                WebView, 0x6000016ebaa0, {{0.0, 0.0}, {414.0, 896.0}}\r\n                Other, 0x6000016eb9c0, {{381.0, 34.5}, {30.0, 826.5}}, label: 'Vertical scroll bar, 1 page', value: 0%\r\n                Other, 0x6000016eb8e0, {{35.0, 863.0}, {344.0, 30.0}}, label: 'Horizontal scroll bar, 1 page', value: 0%\r\n    Window, 0x6000016eb800, {{0.0, 0.0}, {414.0, 896.0}}\r\n      Other, 0x6000016eb720, {{0.0, 0.0}, {414.0, 896.0}}\r\n        Other, 0x6000016eb640, {{0.0, 0.0}, {414.0, 896.0}}\r\nPath to element:\r\n →Application, 0x6000016e87e0, pid: 53270, label: 'WebViewElementsRegression'\r\nQuery chain:\r\n →Find: Target Application 'com.careevolution.WebViewElementsRegression'\r\n  Output: {\r\n    Application, pid: 53270, label: 'WebViewElementsRegression'\r\n  }"
    email: eric.schramm@gmail.com
    modified: "2019-12-14T19:08:04.56643Z"
    number: "7493918"
    number_intvalue: 7493918
    originated: 12/14/2019
    parent_number: '&{NULL_VALUE}'
    product: WebKit, iOS
    product_version: "13.3"
    reproducible: ""
    resolved: ""
    status: Submitted
    title: iOS 13.3 XCUITest can no longer enumerate UIKit controls inside a WKWebView
