apiVersion: openapi/v1alpha1
kind: Radar
metadata:
    name: "23423423423423333"
    labels:
        datastore_id: "4979237010276352"
data:
    classification: Bug
    created: "2019-10-07T20:25:38.29569Z"
    description: "When calling `AVSpeechSynthesizer.speak(string:)` the app crashes. This is only occurring on iOS 13.2. Stack trace:\r\n\r\n2019-10-07 13:15:43.631368-0700 SpeakExample[52041:5057604] *** Terminating app due to uncaught exception 'NSRangeException', reason: 'Cannot remove an observer <AXSpeechManager 0x600003b78fc0> for the key path \"audioSessionCategory\" from <AXSpeechManager 0x600003b78fc0> because it is not registered as an observer.'\r\n*** First throw call stack:\r\n(\r\n\t0   CoreFoundation                      0x00007fff23bef05e __exceptionPreprocess + 350\r\n\t1   libobjc.A.dylib                     0x00007fff50cb6b20 objc_exception_throw + 48\r\n\t2   Foundation                          0x00007fff25707751 -[NSObject(NSKeyValueObserverRegistration) _removeObserver:forProperty:] + 601\r\n\t3   Foundation                          0x00007fff25707b5f -[NSObject(NSKeyValueObserverRegistration) removeObserver:forKeyPath:] + 74\r\n\t4   Foundation                          0x00007fff25707a8c -[NSObject(NSKeyValueObserverRegistration) removeObserver:forKeyPath:context:] + 177\r\n\t5   libAXSpeechManager.dylib            0x00007fff4e495366 -[AXSpeechManager handleAudioSessionObservers:] + 139\r\n\t6   libAXSpeechManager.dylib            0x00007fff4e494c68 -[AXSpeechManager _updateAuxiliarySession:] + 37\r\n\t7   libAXSpeechManager.dylib            0x00007fff4e494c0d -[AXSpeechManager _activeAudioRouteChanged:] + 135\r\n\t8   libAXSpeechManager.dylib            0x00007fff4e494b4d -[AXSpeechManager init] + 476\r\n\t9   AXSpeechImplementation              0x0000000104c8c7ac -[AVSpeechSynthesizer(Implementation) prepareSpeechManager] + 59\r\n\t10  AXSpeechImplementation              0x0000000104c8c740 -[AVSpeechSynthesizer(Implementation) init] + 76\r\n\t11  SpeakExample                        0x00000001026392f3 $sSo19AVSpeechSynthesizerCABycfcTO + 19\r\n\t12  SpeakExample                        0x0000000102638c3f $sSo19AVSpeechSynthesizerCABycfC + 31\r\n\t13  SpeakExample                        0x0000000102638b00 $s12SpeakExample14ViewControllerC14viewWillAppearyySbF + 160\r\n\t14  SpeakExample                        0x0000000102638d1c $s12SpeakExample14ViewControllerC14viewWillAppearyySbFTo + 60\r\n\t15  UIKitCore                           0x00007fff47333ded -[UIViewController _setViewAppearState:isAnimating:] + 661\r\n\t16  UIKitCore                           0x00007fff47334509 -[UIViewController __viewWillAppear:] + 115\r\n\t17  UIKitCore                           0x00007fff4723ed5e __56-[UIPresentationController runTransitionForCurrentState]_block_invoke.465 + 1280\r\n\t18  UIKitCore                           0x00007fff47244bf6 +[UIPresentationController _scheduleTransition:] + 79\r\n\t19  UIKitCore                           0x00007fff4723e5f6 -[UIPresentationController runTransitionForCurrentState] + 1716\r\n\t20  UIKitCore                           0x00007fff4723b72a -[UIPresentationController _presentWithAnimationController:interactionController:target:didEndSelector:] + 1060\r\n\t21  UIKitCore                           0x00007fff479ddb62 -[UIWindow addRootViewControllerViewIfPossible] + 391\r\n\t22  UIKitCore                           0x00007fff479dd128 -[UIWindow _updateLayerOrderingAndSetLayerHidden:actionBlock:] + 232\r\n\t23  UIKitCore                           0x00007fff479de1e5 -[UIWindow _setHidden:forced:] + 362\r\n\t24  UIKit                               0x0000000104896a6a -[UIWindowAccessibility _orderFrontWithoutMakingKey] + 84\r\n\t25  UIKitCore                           0x00007fff479f1591 -[UIWindow _mainQueue_makeKeyAndVisible] + 42\r\n\t26  UIKitCore                           0x00007fff47bf92b1 -[UIWindowScene _makeKeyAndVisibleIfNeeded] + 202\r\n\t27  UIKitCore                           0x00007fff46f37f47 +[UIScene _sceneForFBSScene:create:withSession:connectionOptions:] + 1405\r\n\t28  UIKitCore                           0x00007fff479a283e -[UIApplication _connectUISceneFromFBSScene:transitionContext:] + 1018\r\n\t29  UIKitCore                           0x00007fff479a2b80 -[UIApplication workspace:didCreateScene:withTransitionContext:completion:] + 304\r\n\t30  UIKitCore                           0x00007fff47512369 -[UIApplicationSceneClientAgent scene:didInitializeWithEvent:completion:] + 361\r\n\t31  FrontBoardServices                  0x00007fff3677d3c5 -[FBSSceneImpl _callOutQueue_agent_didCreateWithTransitionContext:completion:] + 442\r\n\t32  FrontBoardServices                  0x00007fff367a365c __86-[FBSWorkspaceScenesClient sceneID:createWithParameters:transitionContext:completion:]_block_invoke.154 + 102\r\n\t33  FrontBoardServices                  0x00007fff36787ea5 -[FBSWorkspace _calloutQueue_executeCalloutFromSource:withBlock:] + 220\r\n\t34  FrontBoardServices                  0x00007fff367a32ed __86-[FBSWorkspaceScenesClient sceneID:createWithParameters:transitionContext:completion:]_block_invoke + 355\r\n\t35  libdispatch.dylib                   0x0000000102960d60 _dispatch_client_callout + 8\r\n\t36  libdispatch.dylib                   0x0000000102963cd1 _dispatch_block_invoke_direct + 300\r\n\t37  FrontBoardServices                  0x00007fff367c9502 __FBSSERIALQUEUE_IS_CALLING_OUT_TO_A_BLOCK__ + 30\r\n\t38  FrontBoardServices                  0x00007fff367c91f0 -[FBSSerialQueue _queue_performNextIfPossible] + 441\r\n\t39  FrontBoardServices                  0x00007fff367c96ff -[FBSSerialQueue _performNextFromRunLoopSource] + 22\r\n\t40  CoreFoundation                      0x00007fff23b52101 __CFRUNLOOP_IS_CALLING_OUT_TO_A_SOURCE0_PERFORM_FUNCTION__ + 17\r\n\t41  CoreFoundation                      0x00007fff23b5202c __CFRunLoopDoSource0 + 76\r\n\t42  CoreFoundation                      0x00007fff23b5185c __CFRunLoopDoSources0 + 268\r\n\t43  CoreFoundation                      0x00007fff23b4c50f __CFRunLoopRun + 1263\r\n\t44  CoreFoundation                      0x00007fff23b4bcf6 CFRunLoopRunSpecific + 438\r\n\t45  GraphicsServices                    0x00007fff38655bb0 GSEventRunModal + 65\r\n\t46  UIKitCore                           0x00007fff479a646c UIApplicationMain + 1621\r\n\t47  SpeakExample                        0x0000000102639bab main + 75\r\n\t48  libdyld.dylib                       0x00007fff51b3cc39 start + 1\r\n\t49  ???                                 0x0000000000000001 0x0 + 1\r\n)\r\nlibc++abi.dylib: terminating with uncaught exception of type NSException\r\n(lldb) \r\n\r\nTo reproduce:\r\n\r\nCreate a new project with Xcode 11.2 and iOS 13.2:\r\n\r\n1. Import AVFoundation\r\n2. Run the following code:\r\n\r\nlet synth = AVSpeechSynthesizer()\r\nlet utterance = AVSpeechUtterance(string: \"hello\")\r\nsynth.speak(utterance)"
    email: bsudekum@lyft.com
    modified: "2019-10-10T18:30:30.649081Z"
    number: "23423423423423333"
    number_intvalue: 23423423423423333
    originated: Oct 2
    parent_number: '&{NULL_VALUE}'
    product: iOS
    product_version: iOS
    reproducible: Yes
    resolved: "True"
    status: Closed
    title: iOS 13.2 crashes when speaking with AVSpeechSynthesizer
