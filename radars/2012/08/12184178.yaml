apiVersion: openapi/v1alpha1
kind: Radar
metadata:
    name: "12184178"
    labels:
        datastore_id: "1894401"
data:
    classification: Serious Bug
    created: "2012-08-28T00:01:34.901027Z"
    description: "Summary:\r\n\r\nIn an Open Panel in a Sandboxed app, going to the \"Computer\" level (e.g. by\r\npressing cmd-shift-C) causes the pboxd process to throw an uncaught exception.\r\n\r\n\r\nSteps to Reproduce:\r\n\r\n1. In a Sandboxed app, create a new NSOpenPanel.\r\n2. Set a delegate on the instance, using -[NSOpenPanel setDelegate:].\r\n    * It doesn't matter if the delegate actually implements any delegate methods or not.\r\n3. Run it as a sheet, using -[NSOpenPanel\r\n   beginSheetModalForWindow:completionHandler:].\r\n4. When the sheet is visible, press cmd-shift-C to navigate to the top level\r\n   (\"Computer\").  Or use the popup menu button at the top of the panel to navigate\r\n   to that level.\r\n\r\n\r\nExpected Results:\r\n\r\nIt should navigate to that level.\r\n\r\n\r\nActual Results:\r\n\r\nThe pboxd process throws an uncaught exception, and logs it to the Console.  See\r\noutput below.\r\n\r\n\r\nRegression:\r\n\r\nThis doesn't happen if the app isn't Sandboxed.\r\n\r\n\r\nNotes:\r\n\r\nThis is especially frustrating when 'NSApplicationShowExceptions' is enabled\r\n(for the NSGlobalDomain), because then the System tries to show the Exception\r\nwindow, but since the Open Panel is running as a sheet, it gets stuck in a bad\r\nmodal state, where any click on the panel (e.g. to dismiss it) causes the alert\r\nbeep.  The only way to get out of this is to Force Quit the app.\r\n\r\nI attached a demo project that displays this behavior.\r\n\r\n\r\nConsole Output (picking Computer from the popup menu):\r\n\r\n    8/27/12 4:10:43.773 PM com.apple.security.pboxd: *** -[__NSPlaceholderArray initWithObjects:count:]: attempt to insert nil object from objects[0]\r\n    8/27/12 4:10:43.773 PM com.apple.security.pboxd: 2012-08-27 16:10:43.772 com.apple.security.pboxd[72348:1707] *** -[__NSPlaceholderArray initWithObjects:count:]: attempt to insert nil object from objects[0]\r\n    8/27/12 4:10:43.775 PM com.apple.security.pboxd: (\r\n        0   CoreFoundation                      0x00007fff88f1ef56 __exceptionPreprocess + 198\r\n        1   libobjc.A.dylib                     0x00007fff887dad5e objc_exception_throw + 43\r\n        2   CoreFoundation                      0x00007fff88ec79f1 -[__NSPlaceholderArray initWithObjects:count:] + 113\r\n        3   CoreFoundation                      0x00007fff88eee313 +[NSArray arrayWithObject:] + 51\r\n        4   com.apple.security.pboxd            0x000000010ceaf9d5 com.apple.security.pboxd + 18901\r\n        5   FinderKit                           0x00007fff8275985e -[FIFinderViewGutsController setTargetPath:withViewStyle:] + 650\r\n        6   FinderKit                           0x00007fff82758dca -[FIFinderViewGutsController setTargetNode:] + 527\r\n        7   FinderKit                           0x00007fff8275d9e9 -[FIFinderViewGutsController finderLocationPopUp:didChangeToDirectoryURL:] + 91\r\n        8   FinderKit                           0x00007fff82780b3e -[FILocationPopUp setTargetNode:] + 207\r\n        9   FinderKit                           0x00007fff82780cb3 -[FILocationPopUp retargetFromMenuItem:] + 82\r\n        10  CoreFoundation                      0x00007fff88f0e70d -[NSObject performSelector:withObject:] + 61\r\n        11  AppKit                              0x00007fff8149ff7e -[NSApplication sendAction:to:from:] + 139\r\n        12  AppKit                              0x00007fff8158cbfb -[NSMenuItem _corePerformAction] + 399\r\n        13  AppKit                              0x00007fff8158c932 -[NSCarbonMenuImpl performActionWithHighlightingForItemAtIndex:] + 125\r\n        14  AppKit                              0x00007fff8182bdd4 -[NSMenu _internalPerformActionForItemAtIndex:] + 38\r\n        15  AppKit                              0x00007fff816baa91 -[NSCarbonMenuImpl _carbonCommandProcessEvent:handlerCallRef:] + 138\r\n        16  AppKit                              0x00007fff81506e0b NSSLMMenuEventHandler + 339\r\n        17  HIToolbox                           0x00007fff83268448 _ZL23DispatchEventToHandlersP14EventTargetRecP14OpaqueEventRefP14HandlerCallRec + 1263\r\n        18  HIToolbox                           0x00007fff83267a54 _ZL30SendEventToEventTargetInternalP14OpaqueEventRefP20OpaqueEventTargetRefP14HandlerCallRec + 446\r\n        19  HIToolbox                           0x00007fff8327e8f3 SendEventToEventTarget + 76\r\n        20  HIToolbox                           0x00007fff832c499d _ZL18SendHICommandEventjPK9HICommandjjhPKvP20OpaqueEventTargetRefS5_PP14OpaqueEventRef + 398\r\n        21  HIToolbox                           0x00007fff833ac035 SendMenuCommandWithContextAndModifiers + 56\r\n        22  HIToolbox                           0x00007fff833f37a9 SendMenuItemSelectedEvent + 253\r\n        23  HIToolbox                           0x00007fff832bda6b _ZL19FinishMenuSelectionP13SelectionDataP10MenuResultS2_ + 101\r\n        24  HIToolbox                           0x00007fff833ec1e1 _ZL19PopUpMenuSelectCoreP8MenuData5PointdS1_tjPK4RecttjS4_S4_PK10__CFStringPP13OpaqueMenuRefPt + 1660\r\n        25  HIToolbox                           0x00007fff833ec4a0 _HandlePopUpMenuSelection7 + 621\r\n        26  AppKit                              0x00007fff816bd75d _NSSLMPopUpCarbonMenu3 + 3860\r\n        27  AppKit                              0x00007fff81a6b41e _NSPopUpCarbonMenu3 + 39\r\n        28  AppKit                              0x00007fff816bb8c2 -[NSCarbonMenuImpl popUpMenu:atLocation:width:forView:withSelectedItem:withFont:withFlags:withOptions:] + 322\r\n        29  AppKit                              0x00007fff8189c4bd -[NSPopUpButtonCell trackMouse:inRect:ofView:untilMouseUp:] + 564\r\n        30  AppKit                              0x00007fff8149deaa -[NSControl mouseDown:] + 786\r\n        31  AppKit                              0x00007fff81469348 -[NSWindow sendEvent:] + 6306\r\n        32  AppKit                              0x00007fff81402a55 -[NSApplication sendEvent:] + 5593\r\n        33  com.apple.security.pboxd            0x000000010ceb16a3 com.apple.security.pboxd + 26275\r\n        34  AppKit                              0x00007fff813990c6 -[NSApplication run] + 555\r\n        35  com.apple.security.pboxd            0x000000010ceada35 com.apple.security.pboxd + 10805\r\n        36  com.apple.security.pboxd            0x000000010ceac3e4 com.apple.security.pboxd + 5092\r\n    )\r\n\r\n\r\nConsole output (pressing cmd-shift-C):\r\n\r\n    8/27/12 4:12:06.016 PM com.apple.security.pboxd: *** -[__NSPlaceholderArray initWithObjects:count:]: attempt to insert nil object from objects[0]\r\n    8/27/12 4:12:06.016 PM com.apple.security.pboxd: 2012-08-27 16:12:06.015 com.apple.security.pboxd[72348:1707] *** -[__NSPlaceholderArray initWithObjects:count:]: attempt to insert nil object from objects[0]\r\n    8/27/12 4:12:06.017 PM com.apple.security.pboxd: (\r\n        0   CoreFoundation                      0x00007fff88f1ef56 __exceptionPreprocess + 198\r\n        1   libobjc.A.dylib                     0x00007fff887dad5e objc_exception_throw + 43\r\n        2   CoreFoundation                      0x00007fff88ec79f1 -[__NSPlaceholderArray initWithObjects:count:] + 113\r\n        3   CoreFoundation                      0x00007fff88eee313 +[NSArray arrayWithObject:] + 51\r\n        4   com.apple.security.pboxd            0x000000010ceaf9d5 com.apple.security.pboxd + 18901\r\n        5   FinderKit                           0x00007fff8275985e -[FIFinderViewGutsController setTargetPath:withViewStyle:] + 650\r\n        6   FinderKit                           0x00007fff82758dca -[FIFinderViewGutsController setTargetNode:] + 527\r\n        7   FinderKit                           0x00007fff8275d9e9 -[FIFinderViewGutsController finderLocationPopUp:didChangeToDirectoryURL:] + 91\r\n        8   FinderKit                           0x00007fff82780b3e -[FILocationPopUp setTargetNode:] + 207\r\n        9   FinderKit                           0x00007fff827818ba -[FILocationPopUp performKeyEquivalent:] + 643\r\n        10  FinderKit                           0x00007fff8275b07d -[FIFinderViewGutsController performKeyEquivalent:] + 49\r\n        11  FinderKit                           0x00007fff8275f78c -[FIFinderView performKeyEquivalent:] + 27\r\n        12  AppKit                              0x00007fff81bfb1f9 -[NSNavFinderViewFileBrowser performKeyEquivalent:] + 27\r\n        13  AppKit                              0x00007fff818d5cd5 -[NSSavePanel performKeyEquivalent:] + 1189\r\n        14  AppKit                              0x00007fff815091ca -[NSApplication _handleKeyEquivalent:] + 611\r\n        15  AppKit                              0x00007fff81402536 -[NSApplication sendEvent:] + 4282\r\n        16  com.apple.security.pboxd            0x000000010ceb1663 com.apple.security.pboxd + 26211\r\n        17  AppKit                              0x00007fff813990c6 -[NSApplication run] + 555\r\n        18  com.apple.security.pboxd            0x000000010ceada35 com.apple.security.pboxd + 10805\r\n        19  com.apple.security.pboxd            0x000000010ceac3e4 com.apple.security.pboxd + 5092\r\n    )"
    email: kelan@yeahrightkeller.com
    modified: "2012-08-28T00:01:34.901384Z"
    number: "12184178"
    number_intvalue: 12184178
    originated: "2012-08-27"
    parent_number: '&{NULL_VALUE}'
    product: Mac OS X SDK
    product_version: Mac OS X 10.7.4
    reproducible: Always
    resolved: ""
    status: Open
    title: Exception from pboxd when navigating to Computer" in an Open Panel
