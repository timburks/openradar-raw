apiVersion: openapi/v1alpha1
kind: Radar
metadata:
    name: "12045566"
    labels:
        datastore_id: "1866401"
data:
    classification: Other Bug
    created: "2012-08-07T09:45:19.645813Z"
    description: "SUMMARY:\r\n\r\nSetting individual row heights via [NSOutlineViewDelegate outlineView:heightOfRowByItem:] and then exposing the NSOutlineView in question to Accessibility requests results into [NSTableView preparedCellAtColumn:row:] being sent, which isn't supposed to be sent to view-based table/outline views.\r\n\r\n\r\nSTEPS TO REPRODUCE:\r\n\r\n1) Install and run the attached ModifiedTableViewPlayground project. (This is based on Apple's TableViewPlayground sample project, with an added [NSOutlineViewDelegate outlineView:heightOfRowByItem:] implementation in ATComplexOutlineController, and a deliberate division by zero crasher in [TestOutlineView preparedCellAtColumn:row:] to highlight the problem.\r\n\r\n2) Run Accessibility Inspector.\r\n\r\n3) Move the mouse around over the \"Complex OutlineView\" window's outline view hierarchy, while watching system.log in Console.app.\r\n\r\n\r\nEXPECTED RESULTS:\r\n\r\nNo ominous log messages.\r\n\r\n\r\nACTUAL RESULTS:\r\n\r\nAfter hovering the mouse over a folder cell, I eventually get this message in Console:\r\n\r\n06.08.12 01:20:59,638 TableViewPlayground[20356]: View Based NSTableView error: preparedCellAtColumn:row: was called. Please log a bug with the backtrace from this log, or stop using the method.\r\n\r\nAnd the deliberate crash I added (see above) yields the following backtrace:\r\n\r\n0   com.apple.demo.TableViewPlayground\t0x0000000100fe543b -[TestOutlineView preparedCellAtColumn:row:] + 59 (ATComplexOutlineController.m:59)\r\n1   com.apple.AppKit              \t0x00007fff85082c43 -[NSTableViewCellProxy cellForProxy] + 153\r\n2   com.apple.AppKit              \t0x00007fff85082c77 -[NSTableViewCellProxy realElement] + 41\r\n3   com.apple.AppKit              \t0x00007fff84db675c -[NSAccessibilityProxy accessibilityHitTest:] + 38\r\n4   com.apple.AppKit              \t0x00007fff851d1f60 -[NSOutlineColumnMockGroup accessibilityHitTest:] + 472\r\n5   com.apple.AppKit              \t0x00007fff84fcb51d -[NSOutlineRow accessibilityHitTest:] + 301\r\n6   com.apple.AppKit              \t0x00007fff85081db1 -[NSTableView(NSTableViewAccessibility) accessibilityHitTest:] + 317\r\n7   com.apple.AppKit              \t0x00007fff8515c96a -[NSWindow(NSWindowAccessibility) accessibilityHitTest:] + 305\r\n8   com.apple.AppKit              \t0x00007fff84dcdc3d -[NSApplication(NSApplicationAccessibility) accessibilityHitTest:] + 252\r\n9   com.apple.AppKit              \t0x00007fff84db038b CopyElementAtPosition + 127\r\n10  com.apple.HIServices          \t0x00007fff8b039625 _AXXMIGCopyElementAtPosition + 143\r\n11  com.apple.HIServices          \t0x00007fff8b03fd53 _XCopyElementAtPosition + 265\r\n12  com.apple.HIServices          \t0x00007fff8b01df9e mshMIGPerform + 443\r\n13  com.apple.CoreFoundation      \t0x00007fff84136a19 __CFRUNLOOP_IS_CALLING_OUT_TO_A_SOURCE1_PERFORM_FUNCTION__ + 41\r\n14  com.apple.CoreFoundation      \t0x00007fff84136759 __CFRunLoopDoSource1 + 153\r\n15  com.apple.CoreFoundation      \t0x00007fff841698bf __CFRunLoopRun + 1775\r\n16  com.apple.CoreFoundation      \t0x00007fff84168dd2 CFRunLoopRunSpecific + 290\r\n17  com.apple.HIToolbox           \t0x00007fff8c576774 RunCurrentEventLoopInMode + 209\r\n18  com.apple.HIToolbox           \t0x00007fff8c576512 ReceiveNextEventCommon + 356\r\n19  com.apple.HIToolbox           \t0x00007fff8c5763a3 BlockUntilNextEventMatchingListInMode + 62\r\n20  com.apple.AppKit              \t0x00007fff84b7cfa3 _DPSNextEvent + 685\r\n21  com.apple.AppKit              \t0x00007fff84b7c862 -[NSApplication nextEventMatchingMask:untilDate:inMode:dequeue:] + 128\r\n22  com.apple.AppKit              \t0x00007fff84b73c03 -[NSApplication run] + 517\r\n23  com.apple.AppKit              \t0x00007fff84b18656 NSApplicationMain + 869\r\n24  com.apple.demo.TableViewPlayground\t0x0000000100fdcbb2 main + 34 (main.m:53)\r\n25  libdyld.dylib                 \t0x00007fff82b517e1 start + 1\r\n\r\n\r\nREGRESSION:\r\n\r\n-\r\n\r\n\r\nNOTES:\r\n\r\nLooks like NSTableView's -accessibilityHitTest: implementation fails to take the difference between being view-based or cell-based into account.\r\n\r\n\r\nSAMPLE CODE:\r\n\r\nhttp://manytricks.com/sandbox/codesamples/radar/modifiedtableviewplayground.zip"
    email: peter.maurer@gmail.com
    modified: "2012-08-07T09:45:19.646989Z"
    number: "12045566"
    number_intvalue: 12045566
    originated: "2012-08-07"
    parent_number: '&{NULL_VALUE}'
    product: Mac OS X
    product_version: "10.8"
    reproducible: Always
    resolved: ""
    status: Open
    title: View-based NSOutlineView doesn't support Accessibility properly
