apiVersion: openapi/v1alpha1
kind: Radar
metadata:
    name: "12455238"
    labels:
        datastore_id: "2144402"
data:
    classification: Serious Bug
    created: "2012-10-11T20:50:58.549312Z"
    description: "09-Oct-2012 09:26 AM Michael Koziarski:\r\nSummary:\r\n\r\nWhen using custom view controller containment, unwind segues always raise internal consistency exceptions, even when overriding the relevant methods in the documentation.\r\n\r\nSteps to Reproduce:\r\n\r\n1) Create two view controllers, and connect them up with a custom segue\r\n2) Create an unwind ib action on the parent view controller\r\n3) In the segue implemntation, transition from one view controller to the next using the view controller containment apis:\r\n\r\n-(void) perform {\r\n    UIViewController *container = [self sourceViewController];\r\n    UIViewController *child = [self destinationViewController];\r\n    [container addChildViewController:child];\r\n    [container.view addSubview:child.view];\r\n    child.view.center = container.view.center;\r\n    \r\n    [UIView transitionWithView:container.view\r\n                      duration:0.35\r\n                       options:UIViewAnimationOptionCurveEaseInOut\r\n                    animations:^{\r\n                        child.view.alpha = 1;\r\n                    } completion:^(BOOL finished) {\r\n                        [child didMoveToParentViewController:container];\r\n                    }];\r\n}\r\n\r\n3) In the parent view controller override viewControllerForUnwindSegueAction:fromViewController:withSender: to ensure it's returning the right value\r\n\r\n-(UIViewController *) viewControllerForUnwindSegueAction:(SEL)action fromViewController:(UIViewController *)fromViewController withSender:(id)sender {\r\n    id default = [super viewControllerForUnwindSegueAction:action fromViewController:fromViewController withSender:sender];\r\n    NSAssert1(default == self, @\"Expected the default view controller to be self but was %@\", default);\r\n    return default;\r\n}\r\n\r\n4) override canPerformUnwindSegueAction:fromViewController:withSender to ensure the parent view controller is selected.\r\n\r\n-(BOOL) canPerformUnwindSegueAction:(SEL)action fromViewController:(UIViewController *)fromViewController withSender:(id)sender {\r\n    return YES;\r\n}\r\n\r\n5) override segueForUnwindingToViewController:fromViewController:identifier to return an unwind segue\r\n\r\n-(UIStoryboardSegue *) segueForUnwindingToViewController:(UIViewController *)toViewController\r\n                                      fromViewController:(UIViewController *)fromViewController\r\n                                              identifier:(NSString *)identifier {\r\n    NSLog(@\"calling segueForUnwindingToViewController on the container\");\r\n    return [[USCustomUnwindSegue alloc] initWithIdentifier:identifier source:fromViewController destination:toViewController];\r\n}\r\n\r\n6) Tap on the button which is bound to the unwind segue\r\n\r\nExpected Results:\r\n\r\nThe unwind segue is executed and the transition takes place back to the parent view controller\r\n\r\nActual Results:\r\n\r\nviewControllerForUnwindSegueAction: fromViewController: withSender: is called and the correct controller is returned from it, however the application then terminates with NSInternalInconsistencyException complaining that it can't find a view controller to execute unwinding to.\r\n\r\n2012-10-01 10:56:33.627 UnwindSegues[12770:c07] *** Assertion failure in -[UIStoryboardUnwindSegueTemplate _perform:], /SourceCache/UIKit_Sim/UIKit-2372/UIStoryboardUnwindSegueTemplate.m:78\r\n2012-10-01 10:56:33.628 UnwindSegues[12770:c07] *** Terminating app due to uncaught exception 'NSInternalInconsistencyException', reason: 'Could not find a view controller to execute unwinding for <USCustomContainerViewController: 0x75949a0>'\r\n*** First throw call stack:\r\n(0x1c8e012 0x10cbe7e 0x1c8de78 0xb61f35 0x581711 0x45ab54 0x10df705 0x16920 0x168b8 0xd7671 0xd7bcf 0xd6d38 0x4633f 0x46552 0x243aa 0x15cf8 0x1be9df9 0x1be9ad0 0x1c03bf5 0x1c03962 0x1c34bb6 0x1c33f44 0x1c33e1b 0x1be87e3 0x1be8668 0x1365c 0x1e7d 0x1da5)\r\nlibc++abi.dylib: terminate called throwing an exception\r\n\r\n\r\nRegression:\r\n\r\nThis is not a regression as unwind segues were not previously available, however it makes unwind segues impossible to use with view controller containment.\r\n\r\nNotes:\r\n\r\nI have a full sample project online: https://github.com/NZKoz/UnwindSegues I will also attach it here for completeness."
    email: koziarski@gmail.com
    modified: "2012-10-11T20:50:58.549797Z"
    number: "12455238"
    number_intvalue: 12455238
    originated: 09-Oct-2012 09:26 AM
    parent_number: '&{NULL_VALUE}'
    product: iPhone SDK
    product_version: "6"
    reproducible: Always
    resolved: ""
    status: Open
    title: unable to use unwind segues with custom view controller containment
