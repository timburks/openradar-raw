apiVersion: openapi/v1alpha1
kind: Radar
metadata:
    name: "11423106"
    labels:
        datastore_id: "1711404"
data:
    classification: Serious Bug
    created: "2012-05-10T10:13:55.977509Z"
    description: "Summary:\r\nNSLog, +stringWithFormat, -initWithFormat:arguments and CFStringCreateWithFormatAndArguments (at least) behave wrong with positional arguments that skip over the first argument.\r\n\r\nSteps to Reproduce:\r\n\r\nCompile the provided code.\r\n\r\nExpected Results:\r\n\r\nNo output should be generated.\r\n\r\nActual Results:\r\n\r\n012-05-10 11:33:38.029 bjc[18467:707] Problem: \"%2$@ %2$@ %2$@ %2$@\" != \"%1$@ %1$@ %1$@ %1$@\"\r\n2012-05-10 11:33:38.031 bjc[18467:707] Problem: \"%3$@ %3$@ %3$@ %3$@\" != \"%1$@ %1$@ %1$@ %1$@\"\r\n2012-05-10 11:33:38.032 bjc[18467:707] Problem: \"%4$@ %4$@ %4$@ %4$@\" != \"%1$@ %1$@ %1$@ %1$@\"\r\n2012-05-10 11:33:38.033 bjc[18467:707] Problem: \"     %2$@ %3$@ %4$@\" != \"     %1$@ %2$@ %3$@\"\r\n2012-05-10 11:33:38.034 bjc[18467:707] Problem: \"%1$@      %3$@ %4$@\" != \"%1$@      %2$@ %3$@\"\r\n2012-05-10 11:33:38.034 bjc[18467:707] Problem: \"%1$@ %2$@      %4$@\" != \"%1$@ %2$@      %3$@\"\r\n2012-05-10 11:33:38.035 bjc[18467:707] Problem: \"%4$@ %3$@ %2$@     \" != \"%3$@ %2$@ %1$@     \"\r\n2012-05-10 11:33:38.036 bjc[18467:707] Problem: \"%4$@ %3$@      %1$@\" != \"%3$@ %2$@      %1$@\"\r\n2012-05-10 11:33:38.036 bjc[18467:707] Problem: \"%4$@      %2$@ %1$@\" != \"%3$@      %2$@ %1$@\"\r\n\r\nRegression:\r\nSeems that this bug has existed since long time ago.\r\n\r\nNotes:\r\nProbably a duplicated of rdar://8045892 but at https://devforums.apple.com/message/659268 the user big3 dismissed it as “not a bug”, which I think this other radar proves wrong.\r\n\r\nI have been able to reproduce the bug in 10.7.3, but also in Mac OS X 10.6 and iOS 5.0/5.1.\r\n\r\n--- interpolations2.m ---\r\n\r\n// clang -objc -framework Foundation  -g interpolations2.m\r\n\r\n#import <Foundation/Foundation.h>\r\n\r\nint main(int argc, char **argv) {\r\n\t@autoreleasepool {\r\n\t\tNSArray *array = [NSArray arrayWithObjects:\r\n                           @\"%1$@ %2$@ %3$@ %4$@\",\r\n                           @\"%2$@ %3$@ %4$@ %1$@\",\r\n                           @\"%3$@ %4$@ %1$@ %2$@\",\r\n                           @\"%4$@ %1$@ %2$@ %3$@\",\r\n                           @\"%1$@ %1$@ %1$@ %1$@\",\r\n                           @\"%2$@ %2$@ %2$@ %2$@\",\r\n                           @\"%3$@ %3$@ %3$@ %3$@\",\r\n                           @\"%4$@ %4$@ %4$@ %4$@\",\r\n                           @\"     %2$@ %3$@ %4$@\",\r\n                           @\"%1$@      %3$@ %4$@\",\r\n                           @\"%1$@ %2$@      %4$@\",\r\n                           @\"%1$@ %2$@ %3$@     \",\r\n                           @\"%4$@ %3$@ %2$@ %1$@\",\r\n                           @\"%4$@ %3$@ %2$@     \",\r\n                           @\"%4$@ %3$@      %1$@\",\r\n                           @\"%4$@      %2$@ %1$@\",\r\n                           @\"     %3$@ %2$@ %1$@\",\r\n                           nil];\r\n\r\n     for (NSString *frmt in array) {\r\n          NSString *string = [NSString stringWithFormat:frmt, @\"%1$@\", @\"%2$@\", @\"%3$@\", @\"%4$@\"];\r\n          if (![frmt isEqualToString:string]) {\r\n               NSLog(@\"Problem: \\\"%@\\\" != \\\"%@\\\"\", frmt, string);\r\n          }\r\n     }\r\n\r\n\t char **carray = calloc(17, sizeof(char *));\r\n\tcarray[0] = \"%1$s %2$s %3$s %4$s\";\r\n    carray[1] = \"%2$s %3$s %4$s %1$s\";\r\n    carray[2] = \"%3$s %4$s %1$s %2$s\";\r\n    carray[3] = \"%4$s %1$s %2$s %3$s\";\r\n    carray[4] = \"%1$s %1$s %1$s %1$s\";\r\n    carray[5] = \"%2$s %2$s %2$s %2$s\";\r\n    carray[6] = \"%3$s %3$s %3$s %3$s\";\r\n    carray[7] = \"%4$s %4$s %4$s %4$s\";\r\n    carray[8] = \"     %2$s %3$s %4$s\";\r\n    carray[9] = \"%1$s      %3$s %4$s\";\r\n    carray[10] = \"%1$s %2$s      %4$s\";\r\n    carray[11] = \"%1$s %2$s %3$s     \";\r\n    carray[12] = \"%4$s %3$s %2$s %1$s\";\r\n    carray[13] = \"%4$s %3$s %2$s     \";\r\n    carray[14] = \"%4$s %3$s      %1$s\";\r\n    carray[15] = \"%4$s      %2$s %1$s\";\r\n    carray[16] = \"     %3$s %2$s %1$s\";\r\n\r\n\t char *cstring = calloc(20, sizeof(char));\r\n\r\n\t for (int idx = 0; idx < 17; idx++) {\r\n\t\t sprintf(cstring, carray[idx], \"%1$s\", \"%2$s\", \"%3$s\", \"%4$s\");\r\n\t\t if (strncmp(cstring, carray[idx], 20) != 0) {\r\n\t\t\t NSLog(@\"CProblem: \\\"%s\\\" != \\\"%s\\\"\", carray[idx], cstring);\r\n\t\t }\r\n\t }\r\n\r\n\t return 0;\r\n\t}\r\n}\r\n\r\n--- EOF ---"
    email: drodriguez@tuenti.com
    modified: "2012-05-10T10:13:55.977655Z"
    number: "11423106"
    number_intvalue: 11423106
    originated: 10-May-2012 12:13 PM
    parent_number: '&{NULL_VALUE}'
    product: Mac OS X
    product_version: 10.7.3
    reproducible: Always
    resolved: ""
    status: Open
    title: Wrong results using skipping positional arguments
