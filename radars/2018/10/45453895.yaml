apiVersion: openapi/v1alpha1
kind: Radar
metadata:
    name: "45453895"
    labels:
        datastore_id: "4966063972286464"
data:
    classification: Crash/Hang/Data Loss
    created: "2018-10-22T15:34:21.384599Z"
    description: "Summary:\r\nWe see a crash in state restoration, deep inside keyed archiving.\n\nCrashed: com.apple.main-thread\n0  libsystem_platform.dylib       0x1e66e2d88 _platform_memmove + 40\n1  Foundation                     0x1e7466ce4 -[NSConcreteMutableData appendBytes:length:] + 532\n2  CoreFoundation                 0x1e6a1316c writeBytes + 164\n3  CoreFoundation                 0x1e6a108b0 _appendObject + 972\n4  CoreFoundation                 0x1e6a0fea0 __CFBinaryPlistWriteOrPresize + 472\n5  Foundation                     0x1e7466a30 -[NSKeyedArchiver finishEncoding] + 588\n6  UIKitCore                      0x2131012dc -[UIApplication(StateRestoration) _saveApplicationPreservationState:viewController:sessionIdentifier:beginHandler:completionHandler:] + 3652\n7  UIKitCore                      0x2130ffdbc -[UIApplication(StateRestoration) _saveApplicationPreservationStateIfSupported] + 508\n8  UIKitCore                      0x2130e2c0c -[UIApplication _applicationDidEnterBackground] + 112\n9  UIKitCore                      0x2139023a4 -[__UICanvasLifecycleMonitor_Compatability deactivateEventsOnly:withContext:forceExit:completion:] + 1848\n10 UIKitCore                      0x2138c064c __82-[_UIApplicationCanvas _transitionLifecycleStateWithTransitionContext:completion:]_block_invoke + 852\n11 UIKitCore                      0x2138c02a8 -[_UIApplicationCanvas _transitionLifecycleStateWithTransitionContext:completion:] + 432\n12 UIKitCore                      0x213903844 __125-[_UICanvasLifecycleSettingsDiffAction performActionsForCanvas:withUpdatedScene:settingsDiff:fromSettings:transitionContext:]_block_invoke + 220\n13 UIKitCore                      0x213904334 _performActionsWithDelayForTransitionContext + 112\n14 UIKitCore                      0x2139036fc -[_UICanvasLifecycleSettingsDiffAction performActionsForCanvas:withUpdatedScene:settingsDiff:fromSettings:transitionContext:] + 248\n15 UIKitCore                      0x2138fca10 -[_UICanvas scene:didUpdateWithDiff:transitionContext:completion:] + 368\n16 UIKitCore                      0x213109940 -[UIApplicationSceneClientAgent scene:handleEvent:withCompletion:] + 468\n17 FrontBoardServices             0x1e95085a0 __80-[FBSSceneImpl updater:didUpdateSettings:withDiff:transitionContext:completion:]_block_invoke.359 + 228\n18 libdispatch.dylib              0x1e6510484 _dispatch_client_callout + 16\n19 libdispatch.dylib              0x1e64b3e58 _dispatch_block_invoke_direct$VARIANT$mp + 224\n20 FrontBoardServices             0x1e9546640 __FBSSERIALQUEUE_IS_CALLING_OUT_TO_A_BLOCK__ + 40\n21 FrontBoardServices             0x1e95462cc -[FBSSerialQueue _performNext] + 416\n22 FrontBoardServices             0x1e95468e8 -[FBSSerialQueue _performNextFromRunLoopSource] + 56\n23 CoreFoundation                 0x1e6a665b8 __CFRUNLOOP_IS_CALLING_OUT_TO_A_SOURCE0_PERFORM_FUNCTION__ + 24\n24 CoreFoundation                 0x1e6a66538 __CFRunLoopDoSource0 + 88\n25 CoreFoundation                 0x1e6a65e1c __CFRunLoopDoSources0 + 176\n26 CoreFoundation                 0x1e6a60ce8 __CFRunLoopRun + 1040\n27 CoreFoundation                 0x1e6a605b8 CFRunLoopRunSpecific + 436\n28 GraphicsServices               0x1e8cd4584 GSEventRunModal + 100\n29 UIKitCore                      0x2130db558 UIApplicationMain + 212\n30 Viewer                         0x1025cb294 main (main.swift:12)\n31 libdyld.dylib                  0x1e6520b94 start + 4\n\nI have no way to trigger this locally, but it is happening many months now, both iOS 11 and 12, and affecting many customers on PDF Viewer Pro.\r\n\r\nSteps to Reproduce:\r\nUse http://pdfviewer.io. Background app. Observe rare crashes. They are hard to notice because the app just restarts afterwards, losing state. We believe this is a corruption issue in UIKit itself - I cannot imagine how we could trigger a crash on exactly this position, over thousands of users.\r\n\r\nExpected Results:\r\nNo crash :)\r\n\r\nActual Results:\r\ncrash.\r\n\r\nVersion:\r\n12.0\r\n\r\nNotes:\r\nSorry for not being able to offer more infos - if you have ideas what would be useful to add, let me know.\n\nSpecific device here was \n\nDevice\nModel: iPad 6\nOrientation: Face Up\nRAM free: 173.38 MB\nDisk free: 3.02 GB\nOperating System\nVersion: 12.0.0 (16A366)\nOrientation: Portrait\nJailbroken: No\nCrash\nDate: Oct 22, 2018, 4:57:00 PM\nApp version: 3.1.0 (6993)"
    email: steipete@gmail.com
    modified: "2018-10-22T15:34:21.384836Z"
    number: "45453895"
    number_intvalue: 45453895
    originated: 22-Oct-2018 05:34 PM
    parent_number: '&{NULL_VALUE}'
    product: iOS + SDK
    product_version: "12.0"
    reproducible: Sometimes
    resolved: ""
    status: Open
    title: State Restoration crash after _saveApplicationPreservationStateIfSupported in keyed archiving EXC_BAD_ACCESS KERN_INVALID_ADDRESS 0x000000010bff0000
