apiVersion: openapi/v1alpha1
kind: Radar
metadata:
    name: "6179168"
    labels:
        datastore_id: "826"
data:
    classification: Severe
    created: "2008-11-17T22:49:15.727965Z"
    description: "10.5 server cannot search a volume that does not have a spotlight index, using the MDFramework.\r\n\r\nIt should fall back to a standard filename search, instead it just returns zero results. Full notes below:\r\n\r\n27-Aug-2008 07:46 AM Chris Barker:\r\n10.5.5 Server is unable to search network volumes that do not have spotlight index.\r\n\r\nSteps to reproduce: Mount network volume that does not have spotlight indexing enabled, search for file by name.\r\n\r\nExpected Result: Searching for a file in spotlight / finder will return the file if it exists. \r\n\r\nActual Result: No files are returned.\r\n\r\nRegression: Works in 10.4/10.5 client without a problem, and 10.4 server.\r\n\r\nNotes: This is for any program that uses the mdfind framework or similar to search network volumes. Instead of failing back to doing a traditional find, the mdfind just fails outright.\r\n\r\nUse mdfind from command line for easy testing.\r\n\r\nEntry in the log file:\r\n\r\nmds[58]: (Error) Server: No store registered for scope \"/Volumes/Graphics1\"\r\n\r\n\r\n28-Aug-2008 12:34 PM Chris Barker:\r\nServer hosting the share is running 10.4.11, build 8S2169. HFS+ Journaled.\r\n\r\nLogged into a 10.5.5 Server, mounting a 10.4.11 Server hosted share, over AFP. Can not search in Spotlight, finder, and mdfind from the command line returns nothing (find from the command line does work, since it does not touch any services related to metadata).\r\n\r\nCan duplicate the problem in 10.5.5 server trying to search an AFP mounted share from a 10.5.4 Server, with spotlight indexing turned off (turned ON, the search query returns the result as expected).\r\n\r\nProblem has existed in all builds of 10.5 server (submitted ticket 5881635 for 10.5.2, was closed as duplicate of 5657038, refilling this as the release notes imply that 5657038 may have been closed, since I can't tell otherwise).\r\n\r\nmdfind and spotlight under 10.5 client / 10.4 client/server still allow me to search volumes that do not have a spotlight index. Under 10.5 Server, this does not appear to be the case (I have not tested locally mounted volumes without spotlight indexes, but considering that mds is giving up when it can't find an index, I would assume it would be the same).\r\n\r\nUpgrading our fileserver to 10.5 and enabling indexing is currently not an option.\r\n\r\n28-Aug-2008 12:39 PM Chris Barker:\r\nServer hosting the share is running 10.4.11, build 8S2169. HFS+ Journaled.\r\n\r\nLogged into a 10.5.5 Server, mounting a 10.4.11 Server hosted share, over AFP. Can not search in Spotlight, finder, and mdfind from the command line returns nothing (find from the command line does work, since it does not touch any services related to metadata).\r\n\r\nCan duplicate the problem in 10.5.5 server trying to search an AFP mounted share from a 10.5.4 Server, with spotlight indexing turned off (turned ON, the search query returns the result as expected).\r\n\r\nProblem has existed in all builds of 10.5 server (submitted ticket 5881635 for 10.5.2, was closed as duplicate of 5657038, refilling this as the release notes imply that 5657038 may have been closed, since I can't tell otherwise).\r\n\r\nmdfind and spotlight under 10.5 client / 10.4 client/server still allow me to search volumes that do not have a spotlight index. Under 10.5 Server, this does not appear to be the case (I have not tested locally mounted volumes without spotlight indexes, but considering that mds is giving up when it can't find an index, I would assume it would be the same).\r\n\r\n24-Sep-2008 09:03 AM Chris Barker:\r\nStill not fixed in 10.5.5 Server, 9F33\r\n\r\nAlso, this applies to ANY volume that does not have a spotlight index.\r\n\r\nTo test, create a disk image, mount disk image, copy a file to the disk, and then search for it.\r\n\r\nmdfind -onlyin /Volumes/<disk image name> Filename\r\n\r\nReturns no results. The same goes for searching in the finder window.\r\n\r\nUnder 10.4 server, 10.5 client and 10.4 client, if mdfind could not find an mds / spotlight index, it would fail back to doing a manual find.\r\n\r\nThe error appears to be in MDS, not in mdfind or the finder, and this affects anyone who wants to use the mdframework to perform file searching (so the code will be faster searching indexed volumes, but still work searching volumes without an index).\r\n\r\nI will submit a separate bug report in a week if I do not get a response from this one."
    email: christopher.m.barker@gmail.com
    modified: "2011-08-28T05:49:46.128005Z"
    number: "6179168"
    number_intvalue: 6179168
    originated: 8/27/08
    parent_number: "6183553"
    product: OS X Server
    product_version: "10.5"
    reproducible: Yes
    resolved: ""
    status: Duplicate/6183553
    title: 'MDS: No store registered for scope (spotlight searching 10.5 server)'
