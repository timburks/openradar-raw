apiVersion: openapi/v1alpha1
kind: Radar
metadata:
    name: "8833723"
    labels:
        datastore_id: "1011401"
data:
    classification: Serious Issue
    created: "2011-01-07T15:26:44.820737Z"
    description: "Summary:\r\nAttempting to refactor the name of a class results in reproducible exceptions and (if you click Continue) hangs.\r\n\r\n\r\nSteps to Reproduce:\r\n1. Open a .h file which declares an Objective-C class’ interface.\r\n2. Select the name of the class.\r\n3. Select Edit > Refactor….\r\n4. Type a new name for the class.\r\n5. Click Preview. Wait a few seconds for it to populate the list of references to that class.\r\n6. Click one of the referencing files in the refactoring window’s list. The symptoms only appear if you select a file OTHER than the .h you have open at the time, e.g. click the .m file.\r\n\r\n\r\nExpected Results:\r\nI expected it to select the file, nothing more. I don’t use attached editors, so a single click shouldn’t really do anything here aside from select the item in the table view (AFAICS).\r\n\r\n\r\nActual Results:\r\nInternal error notification (see attached screenshot of the window and backtrace in Appendix A).\r\n\r\n\r\nRegression:\r\nN/A\r\n\r\n\r\nNotes:\r\nWhen the internal error comes up, you can (of course) quit cleanly with the Quit button, but if you hit the Continue button and then select another file in the list, it hangs, doing some heavy work (110%+ CPU time; see Appendix B). Reference project attached (see Appendix C). Note that this effectively means that I cannot use the class name refactoring feature, which is awfully sad.\r\n\r\n\r\nAppendix A: Console messages:\r\n11-01-07 9:52:55 AM\tXcode[8518]\t*** Assertion failure in -[XCEditDocument initWithContentsOfFile:ofType:], /SourceCache/AppKit/AppKit-1038.35/AppKit.subproj/NSDocument.m:4224\r\n11-01-07 9:52:55 AM\tXcode[8518]\t[MT] Uncaught Exception:\r\nInvalid parameter not satisfying: fileName\r\n\r\nBacktrace:\r\n  0  0x00007fff83d4e796 __exceptionPreprocess (in CoreFoundation)\r\n  1  0x00007fff874550f3 objc_exception_throw (in libobjc.A.dylib)\r\n  2  0x00007fff83d4e5d7 +[NSException raise:format:arguments:] (in CoreFoundation)\r\n  3  0x00007fff82ddc87a -[NSAssertionHandler handleFailureInMethod:object:file:lineNumber:description:] (in Foundation)\r\n  4  0x00007fff82436e53 -[NSDocument(NSDeprecated) initWithContentsOfFile:ofType:] (in AppKit)\r\n  5  0x000000010085bda8 -[PBXTextFileDocument initWithContentsOfFile:ofType:] (in DevToolsInterface)\r\n  6  0x00000001008cbd8c -[PBXFileDocument initWithFileReference:usingType:] (in DevToolsInterface)\r\n  7  0x0000000100b951b7 -[XCRefactoringFileChangeSet(XCRefactoringModule_HelperMethods) referencedTextFileDocument] (in DevToolsInterface)\r\n  8  0x0000000100b96091 -[XCRefactoringEditableExistingTextFileChangeSet populateComparator:] (in DevToolsInterface)\r\n  9  0x00007fff82d1ea66 _nsnote_callback (in Foundation)\r\n 10  0x00007fff83cf6000 __CFXNotificationPost (in CoreFoundation)\r\n 11  0x00007fff83ce2578 _CFXNotificationPostNotification (in CoreFoundation)\r\n 12  0x00007fff82d159ce -[NSNotificationCenter postNotificationName:object:userInfo:] (in Foundation)\r\n 13  0x00007fff821a3d68 -[NSTableView _enableSelectionPostingAndPost] (in AppKit)\r\n 14  0x00007fff82265b02 -[NSTableView mouseDown:] (in AppKit)\r\n 15  0x00007fff8230242d -[NSOutlineView mouseDown:] (in AppKit)\r\n 16  0x000000010085973b -[PBXExtendedOutlineView mouseDown:] (in DevToolsInterface)\r\n 17  0x00007fff8220734f -[NSWindow sendEvent:] (in AppKit)\r\n 18  0x0000000100857f17 -[XCWindow sendEvent:] (in DevToolsInterface)\r\n 19  0x00007fff8213ca86 -[NSApplication sendEvent:] (in AppKit)\r\n 20  0x000000010080416f -[PBXExtendedApplication sendEvent:] (in DevToolsInterface)\r\n 21  0x00007fff820d34da -[NSApplication run] (in AppKit)\r\n 22  0x00007fff820cc1a8 NSApplicationMain (in AppKit)\r\n 23  0x00000001000017a4\r\n 24  0x0000000000000002\r\n\r\n\r\nAppendix B: Sample logs:\r\nSee attached sample logs, which were taken with Activity Monitor while Xcode was hanging, before I force quit it.\r\n\r\n\r\nAppendix C: Reference project:\r\nSee attached RefactoringIssue.zip archive, containing a reference project which you can quickly use to demonstrate the issue."
    email: rix.rob@gmail.com
    modified: "2011-08-28T05:38:30.197005Z"
    number: "8833723"
    number_intvalue: 8833723
    originated: 07-Jan-2011 10:23 AM
    parent_number: "7276618"
    product: Developer Tools
    product_version: Xcode 3.2.5 (1760.0)
    reproducible: Always
    resolved: ""
    status: Duplicate/7276618
    title: Refactoring a class name causes an exception and hang
