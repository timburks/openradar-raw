apiVersion: openapi/v1alpha1
kind: Radar
metadata:
    name: "10633569"
    labels:
        datastore_id: "1478405"
data:
    classification: Serious Bug
    created: "2011-12-31T21:52:15.732233Z"
    description: "In an app using a view based NSTableView with an NSArrayController set to entity mode, and a sort descriptors binding, the following assertion failure message is logged and an exception is thrown upon loading a previously-saved Core Data persistent store file:\r\n\r\nSortDescriptorsBug[59053:407] *** Assertion failure in -[NSTableRowData _addRowViewForVisibleRow:withPriorView:], /SourceCache/AppKit/AppKit-1138.23/TableView.subproj/NSTableRowData.m:2479\r\nSortDescriptorsBug[59053:407] Row 1 should be in the valid visible section\r\n\r\nSteps to Reproduce:\r\n\r\n1. Create a new non-document-based, Core Data application via Xcode's project templates (using ARC).\r\n2. In the core data model define a single entity with a single string attribute.\r\n3. In the App Delegate, define a read-only property \"sortDescriptors\" which simply returns an array with a single ascending sort descriptor with a key matching the name of one of the string property of the entity.\r\n4. In MainMenu.xib, add an NSArrayController set to entity name mode with an entity name matching the entity defined in the model. Enable \"Avoid Empty Selection\", \"Preserve Selection\", \"Select Inserted Objects\", \"Clear Filter Predicate On Insert\", \"Auto Rearrange Content, \"Prepares Content\", and \"Editable. Notably, do *not* enable \"Uses Lazy Fetching\".\r\n5. Add a view-based NSTableView with a single column and two text fields, one for each string property to the main window.\r\n6. Bind the array controller's managedObjectContext binding to the app delegate's managedObjectContext property, and its sortDescriptors binding to the app delegates sortDescriptors property.\r\n7. Add Add and Remove buttons to the menu, connected to the array controller's add: and remove: methods.\r\n8. Open the app, click Add three or four times to create some entries in the table.\r\n9. Quit the app, which will save the managedObjectContext.\r\n10. Reopen the app.\r\n\r\nExpected Results:\r\n\r\nThe app reopens, redisplaying the entries added in step 7 with no errors.\r\n\r\nActual Results:\r\n\r\nThe following two messages are logged, and an an exception is thrown:\r\n\r\nSortDescriptorsBug[59171:407] *** Assertion failure in -[NSTableRowData _addRowViewForVisibleRow:withPriorView:], /SourceCache/AppKit/AppKit-1138.23/TableView.subproj/NSTableRowData.m:2479\r\nSortDescriptorsBug[59171:407] Row 1 should be in the valid visible section\r\n\r\n        0   CoreFoundation                      0x00007fff8f73b286 __exceptionPreprocess + 198\r\n\t1   libobjc.A.dylib                     0x00007fff84928d5e objc_exception_throw + 43\r\n\t2   CoreFoundation                      0x00007fff8f73b0ba +[NSException raise:format:arguments:] + 106\r\n\t3   Foundation                          0x00007fff8ce597d3 -[NSAssertionHandler handleFailureInMethod:object:file:lineNumber:description:] + 169\r\n\t4   AppKit                              0x00007fff8a4f7af3 -[NSTableRowData _addRowViewForVisibleRow:withPriorView:] + 164\r\n\t5   AppKit                              0x00007fff8a4f79e2 -[NSTableRowData _addRowViewForVisibleRow:withPriorRowIndex:inDictionary:withRowAnimation:] + 184\r\n\t6   AppKit                              0x00007fff8a4f7928 -[NSTableRowData _addRowViewForVisibleRow:] + 38\r\n\t7   AppKit                              0x00007fff8a4f706c -[NSTableRowData _unsafeUpdateVisibleRowEntries] + 448\r\n\t8   AppKit                              0x00007fff8a4f6e87 -[NSTableRowData updateVisibleRowViews] + 95\r\n\t9   AppKit                              0x00007fff8a48ec56 -[NSTableView viewWillDraw] + 156\r\n\t10  AppKit                              0x00007fff8a3f1c11 -[NSView viewWillDraw] + 666\r\n\t11  AppKit                              0x00007fff8a3f1c11 -[NSView viewWillDraw] + 666\r\n\t12  AppKit                              0x00007fff8a3f24a2 -[NSScrollView viewWillDraw] + 43\r\n\t13  AppKit                              0x00007fff8a3f1c11 -[NSView viewWillDraw] + 666\r\n\t14  AppKit                              0x00007fff8a3f1c11 -[NSView viewWillDraw] + 666\r\n\t15  AppKit                              0x00007fff8a3f0952 -[NSView _sendViewWillDrawInRect:clipRootView:suppressRecursion:] + 1358\r\n\t16  AppKit                              0x00007fff8a3ef6c1 -[NSView displayIfNeeded] + 1039\r\n\t17  AppKit                              0x00007fff8a3ef07d _handleWindowNeedsDisplayOrLayoutOrUpdateConstraints + 648\r\n\t18  Foundation                          0x00007fff8cde6014 __NSFireTimer + 102\r\n\t19  CoreFoundation                      0x00007fff8f6eff84 __CFRUNLOOP_IS_CALLING_OUT_TO_A_TIMER_CALLBACK_FUNCTION__ + 20\r\n\t20  CoreFoundation                      0x00007fff8f6efad6 __CFRunLoopDoTimer + 534\r\n\t21  CoreFoundation                      0x00007fff8f6d0471 __CFRunLoopRun + 1617\r\n\t22  CoreFoundation                      0x00007fff8f6cfae6 CFRunLoopRunSpecific + 230\r\n\t23  HIToolbox                           0x00007fff85cb23d3 RunCurrentEventLoopInMode + 277\r\n\t24  HIToolbox                           0x00007fff85cb963d ReceiveNextEventCommon + 355\r\n\t25  HIToolbox                           0x00007fff85cb94ca BlockUntilNextEventMatchingListInMode + 62\r\n\t26  AppKit                              0x00007fff8a3b33f1 _DPSNextEvent + 659\r\n\t27  AppKit                              0x00007fff8a3b2cf5 -[NSApplication nextEventMatchingMask:untilDate:inMode:dequeue:] + 135\r\n\t28  AppKit                              0x00007fff8a3af62d -[NSApplication run] + 470\r\n\t29  AppKit                              0x00007fff8a62e80c NSApplicationMain + 867\r\n\t30  SortDescriptorsBug                  0x0000000100001802 main + 34\r\n\t31  SortDescriptorsBug                  0x00000001000017d4 start + 52\r\n\t32  ???                                 0x0000000000000003 0x0 + 3"
    email: armadsen@gmail.com
    modified: "2011-12-31T21:52:15.73246Z"
    number: "10633569"
    number_intvalue: 10633569
    originated: 12/31/2011
    parent_number: '&{NULL_VALUE}'
    product: Mac OS X SDK
    product_version: 10.7.2 (11C74)
    reproducible: Always
    resolved: ""
    status: Open
    title: NSAssertionFailure upon launch with view based table, core data and bindings
