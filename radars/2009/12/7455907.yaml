apiVersion: openapi/v1alpha1
kind: Radar
metadata:
    name: "7455907"
    labels:
        datastore_id: "129402"
data:
    classification: Crash/Hang/Data Loss
    created: "2009-12-10T02:14:57.773288Z"
    description: "Summary:\r\n--------------\r\nSeveral of my macs at home and at work fairly often get kernel panics whenever I use Bittorrent.\r\nThe crash is always in rtunref() in bsd/net/route.c, line 984.\r\n\r\npanic(cpu 4 caller 0xffffff8000330eec): \"rtunref(0xffffff801a524400) bad refcnt\\n\"@/SourceCache/xnu/xnu-1486.2.11/bsd/net/route.c:984\r\n\r\nThe rtunref() issue with a negative ref count has also been an issues in previous releases of Mac OS X Leopard.\r\n\r\n\r\nSteps to Reproduce:\r\n--------------\r\n* Mac OS X 10.6.2\r\n* Being connected directly to the Internet with a routable IP address\r\n* 6to4 network interface active and enabled\r\n* Ad-Hoc wifi network where the Internet connection on the wired interface is shared with the wireless network\r\n* Download a large file (i.e, ISO/DVD image) with many peers (i.e, free movies, Linux ISOs, ..) with Transmission BT 1.76 or 1.80 beta \r\n\r\nAfter a while the computer will crash.\r\n\r\nI've found it easier to reproduce with large files such as DVD or ISO files from here:\r\nhttp://www.nastyoldpeople.org/ (.torrent of DVD is in the right column)\r\nhttp://releases.ubuntu.com/9.10/\r\n\r\n\r\nExpected Results:\r\n--------------\r\nThe computer should not crash.\r\n\r\n\r\nActual Results:\r\n--------------\r\nHere's one crash from a brand new iMac 27\" 2.8GHz i7/8GB.\r\n(I've reported several other crashes that have happened on my iMac 2.8GHz/4GB Extreme (Late 2007) via that dialog box that pops up after a kernel panic, also detailing my setup.)\r\n\r\nInterval Since Last Panic Report:  815392 sec\r\nPanics Since Last Report:          1\r\nAnonymous UUID:                    8B54FB2D-D0A0-4B88-A77D-5F5ECE4E260F\r\n\r\nSun Dec  6 14:25:08 2009\r\npanic(cpu 4 caller 0xffffff8000330eec): \"rtunref(0xffffff801a524400) bad refcnt\\n\"@/SourceCache/xnu/xnu-1486.2.11/bsd/net/route.c:984\r\nBacktrace (CPU 4), Frame : Return Address\r\n0xffffff80af6032e0 : 0xffffff8000204ae6 \r\n0xffffff80af6033e0 : 0xffffff8000330eec \r\n0xffffff80af603400 : 0xffffff80003314d7 \r\n0xffffff80af603430 : 0xffffff80003563eb \r\n0xffffff80af603660 : 0xffffff8000337909 \r\n0xffffff80af6036e0 : 0xffffff800032229d \r\n0xffffff80af6037b0 : 0xffffff8000394c30 \r\n0xffffff80af603860 : 0xffffff800038ad05 \r\n0xffffff80af603a20 : 0xffffff8000360426 \r\n0xffffff80af603b80 : 0xffffff800035e494 \r\n0xffffff80af603d90 : 0xffffff800035e7d3 \r\n0xffffff80af603db0 : 0xffffff800038702a \r\n0xffffff80af603e40 : 0xffffff80003399ec \r\n0xffffff80af603e70 : 0xffffff80003373e9 \r\n0xffffff80af603e80 : 0xffffff80003214b8 \r\n0xffffff80af603eb0 : 0xffffff8000323e0b \r\n0xffffff80af603f50 : 0xffffff8000324079 \r\n0xffffff80af603fa0 : 0xffffff80002c4597 \r\n\r\nBSD process name corresponding to current thread: kernel_task\r\n\r\nMac OS version:\r\n10C2234\r\n\r\nKernel version:\r\nDarwin Kernel Version 10.2.0: Tue Nov  3 23:07:25 PST 2009; root:xnu-1486.2.11~3/RELEASE_X86_64\r\nSystem model name: iMac11,1 (Mac-F2268DAE)\r\n\r\nSystem uptime in nanoseconds: 87036231189943\r\nunloaded kexts:\r\ncom.apple.driver.AppleFileSystemDriver\t2.0 (addr 0xffffff7f80784000, size 0x8192) - last unloaded 257162201508\r\nloaded kexts:\r\ncom.vmware.kext.vmnet\t3.0.0 - last loaded 51555199497\r\ncom.vmware.kext.vmioplug\t3.0.0\r\ncom.vmware.kext.vmci\t3.0.0\r\ncom.vmware.kext.vmx86\t3.0.0\r\ncom.apple.driver.AGPM\t100.9.4\r\ncom.apple.driver.AppleHWSensor\t1.9.2d0\r\ncom.apple.driver.AudioAUUC\t1.2\r\ncom.apple.driver.AppleUpstreamUserClient\t3.2\r\ncom.apple.driver.AppleMikeyHIDDriver\t1.2.0\r\ncom.apple.kext.ATIFramebuffer\t6.0.6\r\ncom.apple.Dont_Steal_Mac_OS_X\t7.0.0\r\ncom.apple.driver.AppleMikeyDriver\t1.8.1a5\r\ncom.apple.ATIRadeonX2000\t6.0.6\r\ncom.apple.driver.AudioIPCDriver\t1.1.2\r\ncom.apple.driver.AppleHDA\t1.8.1a5\r\ncom.apple.iokit.AppleBCM5701Ethernet\t2.3.2b8\r\ncom.apple.driver.AirPort.Atheros21\t421.8.11\r\ncom.apple.driver.ACPI_SMC_PlatformPlugin\t4.0.1d1\r\ncom.apple.driver.AppleLPC\t1.4.9\r\ncom.apple.driver.AppleBacklight\t170.0.14\r\ncom.apple.filesystems.autofs\t2.1.0\r\ncom.apple.driver.AppleIRController\t251.1.4\r\ncom.apple.driver.AppleUSBCardReader\t2.5.2\r\ncom.apple.iokit.SCSITaskUserClient\t2.6.1\r\ncom.apple.iokit.IOAHCIBlockStorage\t1.6.0\r\ncom.apple.driver.AppleUSBHub\t3.9.0\r\ncom.apple.BootCache\t31\r\ncom.apple.AppleFSCompression.AppleFSCompressionTypeZlib\t1.0.0d1\r\ncom.apple.driver.AppleUSBEHCI\t3.9.0\r\ncom.apple.driver.AppleEFINVRAM\t1.3.0\r\ncom.apple.driver.AppleUSBUHCI\t3.9.0\r\ncom.apple.driver.AppleAHCIPort\t2.1.0\r\ncom.apple.driver.AppleACPIButtons\t1.3\r\ncom.apple.driver.AppleRTC\t1.3\r\ncom.apple.driver.AppleHPET\t1.5\r\ncom.apple.driver.AppleSMBIOS\t1.4\r\ncom.apple.driver.AppleACPIEC\t1.3\r\ncom.apple.driver.AppleAPIC\t1.4\r\ncom.apple.security.sandbox\t0\r\ncom.apple.security.quarantine\t0\r\ncom.apple.nke.applicationfirewall\t2.1.11\r\ncom.apple.driver.AppleIntelCPUPowerManagementClient\t96.0.0\r\ncom.apple.driver.AppleIntelCPUPowerManagement\t96.0.0\r\ncom.apple.driver.AppleProfileReadCounterAction\t17\r\ncom.apple.driver.AppleProfileTimestampAction\t10\r\ncom.apple.driver.AppleProfileThreadInfoAction\t14\r\ncom.apple.driver.AppleProfileRegisterStateAction\t10\r\ncom.apple.driver.AppleProfileKEventAction\t10\r\ncom.apple.driver.AppleProfileCallstackAction\t20\r\ncom.apple.iokit.IOSurface\t74.0\r\ncom.apple.iokit.IOBluetoothSerialManager\t2.2.5f6\r\ncom.apple.iokit.IOSerialFamily\t10.0.3\r\ncom.apple.driver.DspFuncLib\t1.8.1a5\r\ncom.apple.iokit.IOAudioFamily\t1.7.2fc2\r\ncom.apple.kext.OSvKernDSPLib\t1.3\r\ncom.apple.driver.AppleSMBusController\t1.0.4d0\r\ncom.apple.kext.ATI4800Controller\t6.0.6\r\ncom.apple.kext.ATISupport\t6.0.6\r\ncom.apple.iokit.IO80211Family\t310.6\r\ncom.apple.iokit.IONetworkingFamily\t1.9\r\ncom.apple.iokit.AppleProfileFamily\t41\r\ncom.apple.driver.AppleHDAController\t1.8.1a5\r\ncom.apple.iokit.IOHDAFamily\t1.8.1a5\r\ncom.apple.driver.AppleSMC\t3.0.1d2\r\ncom.apple.driver.IOPlatformPluginFamily\t4.0.1d1\r\ncom.apple.driver.AppleSMBusPCI\t1.0.4d0\r\ncom.apple.iokit.IONDRVSupport\t2.0\r\ncom.apple.iokit.IOGraphicsFamily\t2.0\r\ncom.apple.driver.AppleUSBHIDKeyboard\t1.2.0a3\r\ncom.apple.driver.AppleHIDKeyboard\t1.2.0a3\r\ncom.apple.driver.BroadcomUSBBluetoothHCIController\t2.2.5f6\r\ncom.apple.driver.AppleUSBBluetoothHCIController\t2.2.5f6\r\ncom.apple.iokit.IOBluetoothFamily\t2.2.5f6\r\ncom.apple.iokit.IOUSBHIDDriver\t3.9.0\r\ncom.apple.iokit.IOUSBMassStorageClass\t2.5.2\r\ncom.apple.iokit.IOSCSIBlockCommandsDevice\t2.6.1\r\ncom.apple.driver.AppleUSBMergeNub\t3.9.0\r\ncom.apple.driver.AppleUSBComposite\t3.9.0\r\ncom.apple.iokit.IOSCSIMultimediaCommandsDevice\t2.6.1\r\ncom.apple.iokit.IOBDStorageFamily\t1.6\r\ncom.apple.iokit.IODVDStorageFamily\t1.6\r\ncom.apple.iokit.IOCDStorageFamily\t1.6\r\ncom.apple.driver.XsanFilter\t402.1\r\ncom.apple.iokit.IOAHCISerialATAPI\t1.2.2\r\ncom.apple.iokit.IOSCSIArchitectureModelFamily\t2.6.1\r\ncom.apple.iokit.IOUSBUserClient\t3.9.0\r\ncom.apple.iokit.IOUSBFamily\t3.9.0\r\ncom.apple.iokit.IOAHCIFamily\t2.0.2\r\ncom.apple.driver.AppleEFIRuntime\t1.3.0\r\ncom.apple.iokit.IOHIDFamily\t1.6.1\r\ncom.apple.iokit.IOSMBusFamily\t1.1\r\ncom.apple.security.TMSafetyNet\t6\r\ncom.apple.kext.AppleMatch\t1.0.0d1\r\ncom.apple.driver.DiskImages\t281\r\ncom.apple.iokit.IOStorageFamily\t1.6\r\ncom.apple.driver.AppleACPIPlatform\t1.3\r\ncom.apple.iokit.IOPCIFamily\t2.6\r\ncom.apple.iokit.IOACPIFamily\t1.3.0\r\nSystem Profile:\r\nModel: iMac11,1, BootROM IM111.0034.B00, 4 processors, Intel Core i7, 2.8 GHz, 8 GB, SMC 1.54f33\r\nGraphics: ATI Radeon HD 4850, ATI Radeon HD 4850, PCIe, 512 MB\r\nMemory Module: global_name\r\nAirPort: spairport_wireless_card_type_airport_extreme (0x168C, 0x8F), Atheros 9280: 2.1.8.11\r\nBluetooth: Version 2.2.5f6, 2 service, 1 devices, 1 incoming serial ports\r\nNetwork Service: Ethernet, Ethernet, en0\r\nNetwork Service: AirPort, AirPort, en1\r\nSerial ATA Device: WDC WD1001FALS-40U9B0, 931,51 GB\r\nSerial ATA Device: OPTIARC DVD RW AD-5680H\r\nUSB Device: Hub, 0x0424  (SMSC), 0x2514, 0xfa100000\r\nUSB Device: Keyboard Hub, 0x05ac  (Apple Inc.), 0x1006, 0xfa140000\r\nUSB Device: Apple Keyboard, 0x05ac  (Apple Inc.), 0x0221, 0xfa142000\r\nUSB Device: BRCM2046 Hub, 0x0a5c  (Broadcom Corp.), 0x4500, 0xfa110000\r\nUSB Device: Bluetooth USB Host Controller, 0x05ac  (Apple Inc.), 0x8215, 0xfa111000\r\nUSB Device: Internal Memory Card Reader, 0x05ac  (Apple Inc.), 0x8403, 0xfa120000\r\nUSB Device: Hub, 0x0424  (SMSC), 0x2514, 0xfd100000\r\nUSB Device: Microsoft 5-Button Mouse with IntelliEye(TM), 0x045e  (Microsoft Corporation), 0x0047, 0xfd140000\r\nUSB Device: Built-in iSight, 0x05ac  (Apple Inc.), 0x8502, 0xfd110000\r\nUSB Device: IR Receiver, 0x05ac  (Apple Inc.), 0x8242, 0xfd120000\r\n\r\n\r\nRegression:\r\n--------------\r\nI believe this is a regression.\r\nIt didn't happen when I was using 10.5.8 nor did it happen when I was using Mac OS X 10.6.0.\r\n\r\nIn 10.6.1 I noticed there were several updates to bsd/net/route.c that are also present in 10.6.2.\r\nI never experienced a crash in 10.6.1 but I didn't use Bittorrent while running that particular release of Mac OS X.\r\n\r\nNotes:\r\n--------------\r\nIf you google \"kernel panic route.c\" several reports show up for a similar issue, however all of them are for Mac OS X 10.5.\r\nhttp://discussions.apple.com/thread.jspa?threadID=1812607\r\nhttp://openradar.appspot.com/6444043\r\nhttp://forums.macrumors.com/showthread.php?t=615335\r\n\r\nFrom those threads and other posts I've found on Google regarding the route.c crashes, the consensus seems to be to not run a bittorrent client (or the bundled Apache 2 in Leopard) and that this is a \"feature\" of Mac OS X. :/\r\n\r\n\r\nFor the record, my setup is as follows:\r\n* I'm running Mac OS X 10.6.2 (build 10C2234)\r\n* I'm directly connected to the Internet on the wired interface (ADSL, 24MBps down, 3MBps up)\r\n* I've also turned on 6to4 and is actively using it\r\n* I have an Ad-Hoc Wifi network and shares the Internet connection over it to an iPhone and a MBP\r\n\r\nOn this computer I've got VMware installed.\r\nI can confirm that this problem happens even when VMware is not installed."
    email: noah.williamsson@gmail.com
    modified: "2011-08-28T05:43:16.602481Z"
    number: "7455907"
    number_intvalue: 7455907
    originated: 09-Dec-2009 08:22 AM
    parent_number: '&{NULL_VALUE}'
    product: Mac OS X
    product_version: 10.6.2
    reproducible: Yes
    resolved: ""
    status: Open
    title: Kernel panic, ref counting regression in bsd/net/route.c
