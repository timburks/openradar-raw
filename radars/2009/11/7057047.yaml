apiVersion: openapi/v1alpha1
kind: Radar
metadata:
    name: "7057047"
    labels:
        datastore_id: "110413"
data:
    classification: Crash/Hang/Data Loss
    created: "2009-11-07T18:24:34.804228Z"
    description: "14-Jul-2009 04:50 PM:\r\nSummary:\r\n\r\nCurrently, time machine stores the local machine's archive directly on a HFS+ disk.\r\nIf the disk is then shared to other computers for time machine use, their archives are stored in sparse bundles.\r\n\r\nMy plea is that Time Machine should consistently use sparse bundle disk images regardless of the host's relationship to the volume being used!\r\n\r\nSteps to Reproduce:\r\n\r\nAssume two macs: mac1 and mac2\r\n\r\nmac1 has an external firewire disk, called \"TM\", to be used for all time machine archives.\r\nmac2 is on the local network with mac1, but does not have any external storage.\r\n\r\nsetup time machine on mac1 to use the attached firewire disk (\"TM\" volume).\r\nlet mac1's time machine perform its first backup\r\nshare the \"TM\" volume from mac1 and mount it on mac2\r\nsetup time machine on mac2 to use the shared \"TM\" volume\r\nlet mac2's time machine perform its first backup\r\n\r\nExpected Results:\r\n\r\nmac1's firewire disk should have two sparse disk images: one for mac1 and one for mac2\r\n\r\nActual Results:\r\n\r\nmac1's archive is stored natively in a directory called: /Volumes/TM/Backups.backupdb/mac1/\r\nmac2's archive is stored in a sparse disk image calle: /Volumes/TM/mac1_<MAC address>.sparsebundle\r\n\r\nRegression:\r\n\r\nI have observed this behaviour for as long as time machine has been available.\r\n\r\nNotes:\r\n\r\nAfter using TIme Machine for several years now, I have witnessed several total failures, either because the physical disk failed or because the time machine archive itself became corrupted to the point that it could no longer be repaired or mounted.\r\n\r\nTo recover from these problems, I have been successfully copying the sparse bundles to a second firewire disk which is only attached once a week or so, just for this purpose. The rest of the time it sits in the cupboard, with all cables disconnected.\r\n\r\nThe remaining hole in this safety-net is that the native time machine archive cannot be backed up in this way - drag and drop and even rsync get confused by the hard-links and try to copy each time-stamped version of each file as a separate copy, which is of course non-sense. (ie: a single 100GB archive appears to be many TB in size after time machine has been running for a year or so).\r\n\r\nToday, my hardware actually hit this hole in my archival system. My 'mac1' has become completely unresponsive (not even firewire target mode works) and at the same time the attached time machine volume has also become corrupted beyond repair (disk utility was unable to repair or mount it, even when attached to a working mac).\r\nAll of my other mac's time machine archives are safely available on the second disk in the cupboard, mac1's data, however, is unfortunately lost.\r\n\r\nIf disk space recovery of sparse bundle volumes is an issue, then is also needs to be addressed anyway, as the current use of sparse bundles will also lead to a not-easy-to-recover-from disk-full condition.\r\n\r\n-------\r\nResponse from Apple: (changed status to closed)\r\n\r\nHi Stephen,\r\n\r\nThis is a follow-up to Bug ID# 7057047.   \r\n\r\nEngineering has provided the following feedback regarding this issue:\r\n\r\nAfter using TIme Machine for several years now, we have witnessed several total failures, either because the physical disk failed or because the time machine archive itself became corrupted to the point that it could no longer be repaired or mounted.\"\r\n\r\nPhysical disk failure is inevitable. If it's a concern, dragging your Backups.backupdb folder to a second disk periodically and storing that disk somewhere else is a good idea.\r\n\r\nKnown disk image corruption issues have been addressed by Mac OS X 10.5.6 and Time Capsule 7.4.1. A disk image created by 10.5.6+ and hosted either by a Mac running 10.5.6+ or a Time Capsule running 7.4.1+ should be fine. If you are having a problem with the scenario I describe, we urge you to file a bug with as much information as possible, including all system, fsck_hfs, and kernel logs. (These are located in /var/log.)\r\n\r\nthe native time machine archive cannot be backed up in this way - drag and drop and even rsync get confused by the hard-links\"\r\n\r\nDrag-and-drop of the Backups.backupdb folder in Finder should work normally. I can't vouch for rsync, as it's not something we test against."
    email: mgprot@opensauce.de
    modified: "2011-08-28T05:45:51.963695Z"
    number: "7057047"
    number_intvalue: 7057047
    originated: 14-Jul-2009
    parent_number: '&{NULL_VALUE}'
    product: Mac OS X
    product_version: 10.5.8
    reproducible: always
    resolved: ""
    status: Closed
    title: Local time machine storage is difficult to backup
