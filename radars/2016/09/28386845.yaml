apiVersion: openapi/v1alpha1
kind: Radar
metadata:
    name: "28386845"
    labels:
        datastore_id: "6710143387435008"
data:
    classification: Bug
    created: "2016-09-20T15:33:04.10492Z"
    description: "Summary:\r\n\r\nOn iOS 10, the remote notification payload it is not delivered to the app as stated in the documentation, when the notification banner is tapped in contrast with the behaviour on previous iOS releases.\r\n\r\nDetailed description: \r\n\r\nThe UIApplicationDelegate API reference states that the remote notification payload, when tapping the associated banner, will be delivered to the application via \r\n\r\nA)\r\n- (void)application:(UIApplication *)application \r\ndidReceiveRemoteNotification:(NSDictionary *)userInfo \r\nfetchCompletionHandler:(void (^)(UIBackgroundFetchResult result))completionHandler;\r\n\r\ninstead of \r\n\r\nB) \r\n- (void)application:(UIApplication *)application \r\ndidReceiveRemoteNotification:(NSDictionary *)userInfo;\r\n\r\nwhen both are implemented.\r\n\r\nHowever on iOS 10 the later is used instead when bringing the app from background to foreground by tapping on the notification banner. If the later is not implemented the notification banner is not delivered to the app when banner is tapped.\r\n\r\nExamples:\r\n1) Notification payload does NOT contain \"content-available\" key\r\na) iOS 8.4/iOS 9.2.1, app in foreground, notification arrives and it is delivered via A) -> OK\r\nb) iOS 8.4/iOS 9.2.1, app in background, tap on banner, notification delivered via A) -> OK\r\nc) iOS 10.0.1(14A403), app in foreground, notification arrives and it is delivered via A) -> OK\r\nd) iOS 10.0.1(14A403), app in background, tap on banner, notification delivered via B) -> NOT OK\r\n\r\n2) Notification payload does contain \"content-available\" key\r\na) iOS 8.4/iOS 9.2.1, app in background, notification arrives and it is delivered via A), tap on banner, notification delivered via A) -> OK\r\nb) iOS 10.0.1(14A403), app in background, notification arrives and it is delivered via A) (OK), tap on banner, notification delivered via B) -> NOT OK\r\n\r\nThis iOS 10 inconsistency has the potential of breaking the remote notification handling for many applications which only implemented the newer API, i.e. - (void)application:(UIApplication *)application \r\ndidReceiveRemoteNotification:(NSDictionary *)userInfo \r\nfetchCompletionHandler:(void (^)(UIBackgroundFetchResult result))completionHandler; according to documentation.\r\n\r\nSteps to Reproduce:\r\n- using Xcode 7.3 (or Xcode 8 GM)\r\n- using iPhone devices running iOS 8.4, iOS 9.2.1 and iOS 10.0.1(14A403) respectively\r\n- using Knuff (https://github.com/KnuffApp/Knuff/releases) or a similar tool to send push notifications\r\n\r\n1) Open the \"PushNotificationsTest.xcodeproj\" in the attached directory\r\n2) Configure signing for push notifications for your specific configuration\r\n3) Run the PushNotificationsTest target on your device\r\n4) Search in Xcode Console for a log \"Device token: *********\" and extract your device token\r\n5) With app in foreground, send a push notification. Confirm breakpoint in - [AppDelegate application:didReceiveRemoteNotification:fetchCompletionHandler:] is hit.\r\n6) With app in background, send a push notification. Open the app via notification banner. Confirm breakpoint in - [AppDelegate application:didReceiveRemoteNotification:fetchCompletionHandler:] is hit.\r\n\r\nExpected Results:\r\nThe breakpoint in - [AppDelegate application:didReceiveRemoteNotification:fetchCompletionHandler:] will be hit at both steps 5) and 6)\r\n\r\nActual Results:\r\nThe breakpoint in - [AppDelegate application:didReceiveRemoteNotification:fetchCompletionHandler:] is hit only at step 5) \r\n\r\nThe breakpoint in - [AppDelegate application:didReceiveRemoteNotification] is hit instead at step 6) \r\n\r\nVersion:\r\n iOS 8.4 (12H143), iOS 9.2.1 (13D15) and iOS 10.0.1(14A403)\r\n\r\nNotes:\r\nSample push payload:\r\n\r\n{\r\n\t\"aps\": {\r\n\t\t\"alert\": \"Sample push message\",\r\n\t\t\"badge\": 1,\r\n\t\t\"sound\": \"default\"\r\n\t}\r\n}\r\n\r\nSimilar to this one: http://www.openradar.me/27822963\r\n\r\nConfiguration:\r\n2 x iPhone 5c, iPhone 6 Plus"
    email: stefanprutianu@gmail.com
    modified: "2016-10-11T07:57:42.1717Z"
    number: "28386845"
    number_intvalue: 28386845
    originated: 20-Sep-2016
    parent_number: '&{NULL_VALUE}'
    product: iOS SDK
    product_version: iOS 10
    reproducible: Always
    resolved: 10-Oct-2016
    status: Closed (Duplicate of rdar://27940438)
    title: Inconsistent remote notification delivery behaviour between iOS 10 and previous iOS releases
